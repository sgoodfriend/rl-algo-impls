LuxAI_S2-v0: &lux-defaults
  n_timesteps: !!float 40e6
  additional_keys_to_log: ["stats", "results"]
  env_id: LuxAI_S2-v0
  env_hyperparams: &lux-env-defaults
    env_type: lux
    vec_env_class: sync
    n_envs: 24
    self_play_kwargs: &lux-env-self-play
      num_old_policies: 12
      save_steps: 300000
      swap_steps: 3000
      swap_window_size: 4
      window: 33
    make_kwargs: &lux-env-make-defaults
      bid_std_dev: 0
      reward_weights:
        ice_generation: 0.0025 # 0.5/day of water for factory, 0.05/heavy dig
        ore_generation: 0.008 # 4/heavy robot build, 0.16/heavy dig
        water_generation: 0.01 # 0.5/day of water for factory
        metal_generation: 0.04 # 4/heavy robot build
        power_generation: 0
        ice_rubble_cleared: 0.002 # 80% of ice_generation
        ore_rubble_cleared: 0.0064 # 80% of ore_generation
        built_light: 0.1
        built_heavy: 1
        lost_factory: -1
        factories_alive: 0.01
        heavies_alive: 0.005 # 0.25/day of heavy alive
        lights_alive: 0.0005 # 0.025/day of light alive
    additional_win_loss_reward: true
    score_reward_kwargs:
      episode_end: true
  checkpoints_kwargs:
    history_size: 32
  eval_hyperparams: &lux-eval-defaults
    deterministic: false
    step_freq: !!float 5e6
    score_function: mean
    only_record_video_on_best: true
    score_threshold: 0.37
    env_overrides: &lux-eval-env-overrides
      n_envs: 64
      self_play_kwargs: null
      make_kwargs: &lux-eval-env-override-make-kwargs
        <<: *lux-env-make-defaults
        reward_weights:
          win_loss: 1
      additional_win_loss_reward: false
      score_reward_kwargs: null
      play_checkpoints_kwargs:
        n_envs_against_checkpoints: null
  policy_hyperparams: &lux-policy-defaults
    activation_fn: relu
    actor_head_style: unet
    v_hidden_sizes: [256, 128]
    embed_layer: false
    additional_critic_activation_functions: [tanh, identity]
    subaction_mask:
      1:
        2: 0
        3: 1
        4: 1
        5: 2
  hyperparam_transitions_kwargs: &lux-transitions-defaults
    phases:
      - multi_reward_weights: [0.98, 0.01, 0.01] # Initial shaped rewards (mostly)
        vf_coef: [0.5, 0.1, 0.1]
        ent_coef: 0.01
        learning_rate: !!float 1e-4
      - multi_reward_weights: [0.34, 0.33, 0.33] # Equal contributions
        vf_coef: [0.25, 0.25, 0.25]
        ent_coef: 0.01
        learning_rate: !!float 1e-4
      - multi_reward_weights: [0, 0.9, 0.1] # Win-loss sparse rewards
        vf_coef: [0, 0.4, 0.2]
        ent_coef: 0.001
        learning_rate: !!float 5e-5
    durations:
      - 0.3
      - 0.2
      - 0.2
      - 0.2
      - 0.1
  rollout_hyperparams: &lux-rollout-defaults
    n_steps: 384
    full_batch_off_accelerator: true
  algo_hyperparams: &lux-algo-defaults
    batch_size: 2304
    n_epochs: 4
    ent_coef: 0.01
    max_grad_norm: 0.5
    clip_range: 0.1
    clip_range_vf: 0.1
    ppo2_vf_coef_halving: true
    multi_reward_weights: [0.99, 0.01]
    gamma: [0.99, 0.999, 0.999]
    gae_lambda: [0.95, 0.99, 0.99]
    vf_coef: [0.5, 0.1, 0.1]

LuxAI_S2-v0-double-cone: &lux-dc-defaults
  <<: *lux-defaults
  policy_hyperparams: &lux-dc-policy
    actor_head_style: double_cone
    pooled_channels: 128
    additional_critic_activation_functions: [tanh, identity]
    subaction_mask:
      1:
        2: 0
        3: 1
        4: 1
        5: 2
  rollout_hyperparams: &lux-dc-rollout-defaults
    <<: *lux-rollout-defaults
    n_steps: 128
  algo_hyperparams: &lux-dc-algo-defaults
    <<: *lux-algo-defaults
    batch_size: 768
    n_epochs: 2

LuxAI_S2-v0-eval:
  <<: *lux-defaults
  device: cpu
  eval_hyperparams:
    <<: *lux-eval-defaults
    env_overrides:
      n_envs: 1
      self_play_kwargs:
        save_steps: .inf
        swap_steps: .inf
      make_kwargs:
        <<: *lux-env-make-defaults
        reward_weights:
          win_loss: 1

LuxAI_S2-v0-A10: &lux-a10-defaults
  <<: *lux-defaults
  rollout_hyperparams:
    n_steps: 192
  algo_hyperparams:
    <<: *lux-algo-defaults
    batch_size: 1152

LuxAI_S2-v0-A10-100M:
  <<: *lux-a10-defaults
  n_timesteps: !!float 100e6

LuxAI_S2-v0-dc-A10: &lux-dc-a10-defaults
  <<: *lux-dc-defaults
  rollout_hyperparams:
    <<: *lux-dc-rollout-defaults
    n_steps: 64
  algo_hyperparams:
    <<: *lux-dc-algo-defaults
    batch_size: 256
    gradient_accumulation: true

LuxAI_S2-v0-medium-transfer: &lux-medium-transfer-defaults
  <<: *lux-a10-defaults
  policy_hyperparams:
    <<: *lux-policy-defaults
    load_run_path: sgoodfriend/rl-algo-impls-benchmarks/qpm5k6n1
    load_run_path_best: false

LuxAI_S2-v0-medium-transfer-debug:
  <<: *lux-medium-transfer-defaults
  device: cpu
  env_hyperparams:
    <<: *lux-env-defaults
    vec_env_class: sync
    make_kwargs:
      <<: *lux-env-make-defaults
      verbose: 2
  hyperparam_transitions_kwargs:
    <<: *lux-transitions-defaults
    durations:
      - 0 # Should already know water generation, so transition to sparse rewards
      - 0.3
      - 0.2
      - 0.2
      - 0.3

LuxAI_S2-v0-medium-transfer-A100:
  <<: *lux-medium-transfer-defaults
  algo_hyperparams:
    <<: *lux-algo-defaults

LuxAI_S2-v0-small: &small-lux-defaults
  <<: *lux-defaults
  env_hyperparams: &small-lux-env-defaults
    <<: *lux-env-defaults
    make_kwargs:
      <<: *lux-env-make-defaults
      map_size: 16
      MIN_FACTORIES: 1
      MAX_FACTORIES: 1
  eval_hyperparams:
    <<: *lux-eval-defaults
    env_overrides:
      <<: *lux-eval-env-overrides
      make_kwargs:
        <<: *lux-eval-env-override-make-kwargs
        map_size: 16
        MIN_FACTORIES: 1
        MAX_FACTORIES: 1

LuxAI_S2-v0-small-debug:
  <<: *small-lux-defaults
  device: cpu
  env_hyperparams:
    <<: *small-lux-env-defaults
    vec_env_class: sync

LuxAI_S2-v0-medium: &medium-lux-defaults
  <<: *lux-defaults
  n_timesteps: !!float 30e6
  env_hyperparams: &medium-lux-env-defaults
    <<: *lux-env-defaults
    make_kwargs:
      <<: *lux-env-make-defaults
      map_size: 32
      MIN_FACTORIES: 1
      MAX_FACTORIES: 1
  eval_hyperparams:
    <<: *lux-eval-defaults
    env_overrides:
      <<: *lux-eval-env-overrides
      make_kwargs:
        <<: *lux-eval-env-override-make-kwargs
        map_size: 32
        MIN_FACTORIES: 1
        MAX_FACTORIES: 1

LuxAI_S2-v0-medium-debug:
  <<: *medium-lux-defaults
  device: cpu
  env_hyperparams:
    <<: *medium-lux-env-defaults
    vec_env_class: sync

LuxAI_S2-v0-squnet: &lux-squnet
  <<: *lux-defaults
  policy_hyperparams: &lux-squnet-policy
    actor_head_style: squeeze_unet
    subaction_mask:
      1:
        2: 0
        3: 1
        4: 1
        5: 2
    channels_per_level: [128, 128, 128]
    strides_per_level: [4, 4]
    deconv_strides_per_level: [[2, 2], [2, 2]]
    encoder_residual_blocks_per_level: [3, 2, 4]
    decoder_residual_blocks_per_level: [2, 3]
    additional_critic_activation_functions: [tanh, identity]
  rollout_hyperparams: &lux-squnet-rollout
    <<: *lux-rollout-defaults
    n_steps: 64
    full_batch_off_accelerator: true
  algo_hyperparams: &lux-squnet-algo
    <<: *lux-algo-defaults
    batch_size: 384
    n_epochs: 2
    gradient_accumulation: true

LuxAI_S2-v0-squnet-iDeimos: &lux-squnet-ideimos
  <<: *lux-squnet
  n_timesteps: !!float 50e6
  env_hyperparams: &lux-squnet-ideimos-env
    <<: *lux-env-defaults
    make_kwargs: &lux-squnet-ideimos-env-make-kwargs
      <<: *lux-env-make-defaults
      reward_weights:
        score_vs_opponent: 1
      factory_ice_distance_buffer: null
    additional_win_loss_reward: true
    score_reward_kwargs: null
    self_play_kwargs: &lux-squnet-ideimos-env-self-play
      <<: *lux-env-self-play
      save_steps: !!float 1e6
      window: 50
  eval_hyperparams: &lux-squnet-ideimos-eval
    <<: *lux-eval-defaults
    env_overrides: &lux-squnet-ideimos-eval-env-overrides
      <<: *lux-eval-env-overrides
      make_kwargs: &lux-squnet-ideimos-eval-env-make-kwargs
        <<: *lux-eval-env-override-make-kwargs
        factory_ice_distance_buffer: null
  policy_hyperparams: &lux-squnet-ideimos-policy
    <<: *lux-squnet-policy
    additional_critic_activation_functions: [tanh]
    output_activation_fn: tanh
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/qil1np82
  algo_hyperparams: &lux-squnet-ideimos-algo
    <<: *lux-squnet-algo
    multi_reward_weights: [0.1, 0.9]
    gamma: [0.9997, 0.9997]
    gae_lambda: [0.99, 0.99]
    vf_coef: [0.1, 0.4]
    learning_rate: !!float 1e-4
    ent_coef: 0.01
  hyperparam_transitions_kwargs: &lux-squnet-ideimos-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - ent_coef: 0
        learning_rate: !!float 1e-5
        freeze_policy_head: true
        freeze_backbone: true
      - ent_coef: 0
        learning_rate: !!float 5e-5
        freeze_policy_head: true
        freeze_backbone: true
      - ent_coef: 0.001
        learning_rate: !!float 1e-5
        freeze_policy_head: false
        freeze_backbone: false
      - ent_coef: 0.001
        learning_rate: !!float 5e-5
        freeze_policy_head: false
        freeze_backbone: false
      - ent_coef: 0.0001
        learning_rate: !!float 1e-5
        freeze_policy_head: false
        freeze_backbone: false
    durations:
      - 0
      - 0.1
      - 0
      - 0
      - 0
      - 0.1
      - 0.4
      - 0.3
      - 0.1

LuxAI_S2-v0-squnet-Deimos-jumpstart: &lux-squnet-deimos-jumpstart
  <<: *lux-squnet-ideimos
  rollout_type: guided
  rollout_hyperparams:
    <<: *lux-squnet-rollout
    switch_range: 1
  checkpoints_kwargs:
    history_size: 1
  eval_hyperparams: &lux-squnet-deimos-jumpstart-eval
    <<: *lux-squnet-ideimos-eval
    score_threshold: null
    only_checkpoint_initial_policy: true
    env_overrides: &lux-squnet-deimos-jumpstart-eval-env-overrides
      <<: *lux-squnet-ideimos-eval-env-overrides
      play_checkpoints_kwargs:
        n_envs_against_checkpoints: null
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 3e-5
        ent_coef: 0
        freeze_policy_head: true
        freeze_backbone: true
        switch_range: 1
      - learning_rate: !!float 1e-6
        ent_coef: 0.001
        freeze_policy_head: false
        freeze_backbone: false
        switch_range: 1000
      - learning_rate: !!float 3e-5
        ent_coef: 0.001
        freeze_policy_head: false
        freeze_backbone: false
        switch_range: 1000
      - learning_rate: !!float 3e-5
        ent_coef: 0.001
        freeze_policy_head: false
        freeze_backbone: false
        switch_range: 1
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
        freeze_policy_head: false
        freeze_backbone: false
        switch_range: 1
    durations:
      - 0.02
      - 0
      - 0
      - 0.23
      - 0
      - 0.4
      - 0.1
      - 0.23
      - 0.02

LuxAI_S2-v0-squnet-Deimos-guided-random: &lux-squnet-guided-random
  <<: *lux-squnet-ideimos
  rollout_type: guided_random
  rollout_hyperparams: &lux-squnet-guided-random-rollout
    <<: *lux-squnet-rollout
    guide_probability: 0
  eval_hyperparams:
    <<: *lux-squnet-deimos-jumpstart-eval
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 3e-5
        ent_coef: 0
        freeze_policy_head: true
        freeze_backbone: true
        guide_probability: 0
      - learning_rate: !!float 1e-6
        ent_coef: 0.001
        freeze_policy_head: false
        freeze_backbone: false
        guide_probability: 0.9
      - learning_rate: !!float 3e-5
        ent_coef: 0.001
        freeze_policy_head: false
        freeze_backbone: false
        guide_probability: 0.6
      - learning_rate: !!float 3e-5
        ent_coef: 0.001
        freeze_policy_head: false
        freeze_backbone: false
        guide_probability: 0
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
        freeze_policy_head: false
        freeze_backbone: false
        guide_probability: 0
    durations:
      - 0.02
      - 0
      - 0
      - 0.23
      - 0
      - 0.3
      - 0.2
      - 0.23
      - 0.02

LuxAI_S2-v0-squnet-Deimos-guided-random-fast: &lux-squnet-guided-random-fast
  <<: *lux-squnet-guided-random
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 3e-5
        ent_coef: 0
        freeze_policy_head: true
        freeze_backbone: true
        guide_probability: 0
      - learning_rate: !!float 1e-6
        ent_coef: 0.001
        freeze_policy_head: false
        freeze_backbone: false
        guide_probability: 0.9
      - learning_rate: !!float 3e-5
        ent_coef: 0.001
        freeze_policy_head: false
        freeze_backbone: false
        guide_probability: 0
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
        freeze_policy_head: false
        freeze_backbone: false
        guide_probability: 0
    durations:
      - 0.02
      - 0
      - 0
      - 0.1
      - 0.63
      - 0.23
      - 0.02

LuxAI_S2-v0-squnet-Deimos-adv-norm-gfast: &lux-squnet-adv-norm-gfast
  <<: *lux-squnet-guided-random-fast
  algo_hyperparams: &lux-squnet-adv-norm-gfast-algo
    <<: *lux-squnet-ideimos-algo
    normalize_advantages_after_scaling: true

LuxAI_S2-v0-split-squnet-Deimos: &lux-split-squnet-deimos
  <<: *lux-squnet-adv-norm-gfast
  policy_hyperparams: &lux-split-squnet-deimos-policy
    <<: *lux-squnet-ideimos-policy
    critic_shares_backbone: false
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/66vbe7z3

LuxAI_S2-v0-split-squnet-multi: &lux-split-squnet-multi
  <<: *lux-split-squnet-deimos
  policy_hyperparams:
    <<: *lux-split-squnet-deimos-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/ntwvs6bc

LuxAI_S2-v0-split-short-squnet-multi: &lux-split-short-squnet-multi
  <<: *lux-split-squnet-multi
  policy_hyperparams: &lux-split-short-squnet-multi-policy
    <<: *lux-split-squnet-deimos-policy
    encoder_residual_blocks_per_level: [2, 2, 4]
    decoder_residual_blocks_per_level: [2, 2]
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/ze7acdpc

LuxAI_S2-v0-split-short-squnet-acbc-robot: &lux-split-short-squnet-acbc-robot
  <<: *lux-squnet-adv-norm-gfast
  env_hyperparams: &lux-split-short-squnet-acbc-robot-env
    <<: *lux-squnet-ideimos-env
    make_kwargs: &lux-split-short-squnet-acbc-robot-env-make-kwargs
      <<: *lux-squnet-ideimos-env-make-kwargs
      reward_weights:
        built_light_by_time_remaining: 0.008
        built_heavy_by_time_remaining: 0.12
    score_reward_kwargs:
      episode_end: true
  policy_hyperparams: &lux-split-short-squnet-acbc-robot-policy
    <<: *lux-split-short-squnet-multi-policy
    additional_critic_activation_functions: [tanh, tanh]
    output_activation_fn: identity
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/oupuah7y
    save_critic_separate: true
  algo_hyperparams: &lux-split-short-squnet-acbc-robot-algo
    <<: *lux-squnet-adv-norm-gfast-algo
    multi_reward_weights: [0.1, 0.8, 0.1]
    gamma: [0.9997, 0.9997, 0.9997]
    gae_lambda: [0.95, 0.95, 0.95]
    vf_coef: [0.33, 0.33, 0.33]

LuxAI_S2-v0-ss-squnet-acbc-robot-rollout-reset:
  &lux-ss-squnet-acbc-robot-rollout-reset
  <<: *lux-split-short-squnet-acbc-robot
  env_hyperparams: &lux-ss-squnet-acbc-robot-rollout-reset-env
    <<: *lux-split-short-squnet-acbc-robot-env
    n_envs: 24
  rollout_hyperparams: &lux-ss-squnet-acbc-robot-rollout-reset-rollout
    <<: *lux-squnet-guided-random-rollout
    num_envs_reset_every_rollout: 2

LuxAI_S2-v0-ss-squnet-rl-robot-no-guidance: &lux-ss-squnet-rl-robot-no-guidance
  <<: *lux-ss-squnet-acbc-robot-rollout-reset
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-6
        ent_coef: 0.001
      - learning_rate: !!float 3e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.1
      - 0.7
      - 0.18
      - 0.02

LuxAI_S2-v0-ss-squnet-rl-robot-half-guidance:
  &lux-ss-squnet-rl-robot-half-guidance
  <<: *lux-ss-squnet-rl-robot-no-guidance
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-6
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 3e-5
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 3e-5
        ent_coef: 0.001
        guide_probability: 0
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
        guide_probability: 0
    durations:
      - 0
      - 0.1
      - 0
      - 0.1
      - 0.6
      - 0.18
      - 0.02

LuxAI_S2-v0-ss-squnet-ray: &lux-ss-squnet-ray
  <<: *lux-ss-squnet-rl-robot-half-guidance
  env_hyperparams: &lux-ss-squnet-ray-env
    <<: *lux-ss-squnet-acbc-robot-rollout-reset-env
    vec_env_class: ray

LuxAI_S2-v0-short-squnet-rl-robot: &lux-short-squnet-rl-robot
  <<: *lux-ss-squnet-ray
  policy_hyperparams: &lux-short-squnet-rl-robot-policy
    <<: *lux-split-short-squnet-acbc-robot-policy
    save_critic_separate: false
    critic_shares_backbone: true
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/gtt6hr2c
  algo_hyperparams: &lux-short-squnet-rl-robot-algo
    <<: *lux-split-short-squnet-acbc-robot-algo
    vf_coef: [0.2, 0.2, 0.2]

LuxAI_S2-v0-short-squnet-cuda-opt: &lux-short-squnet-cuda-opt
  <<: *lux-short-squnet-rl-robot
  device_hyperparams: &lux-short-squnet-cuda-opt-device
    set_float32_matmul_precision: high
  algo_hyperparams: &lux-short-squnet-cuda-opt-algo
    <<: *lux-short-squnet-rl-robot-algo
    autocast_loss: true
    batch_size: 768
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-6
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 1.5e-5
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 1.5e-5
        ent_coef: 0.001
        guide_probability: 0
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
        guide_probability: 0
    durations:
      - 0
      - 0.1
      - 0
      - 0.1
      - 0.6
      - 0.18
      - 0.02

LuxAI_S2-v0-short-squnet-48-envs: &lux-short-squnet-48-envs
  <<: *lux-short-squnet-cuda-opt
  env_hyperparams: &lux-short-squnet-48-envs-env
    <<: *lux-ss-squnet-ray-env
    n_envs: 48
    self_play_kwargs: &lux-short-squnet-48-envs-env-self-play
      <<: *lux-squnet-ideimos-env-self-play
      num_old_policies: 16
      first_window_orig_policy: true
  rollout_hyperparams: &lux-short-squnet-48-envs-rollout
    <<: *lux-ss-squnet-acbc-robot-rollout-reset-rollout
    num_envs_reset_every_rollout: 8

LuxAI_S2-v0-short-squnet-78-envs: &lux-short-squnet-78-envs
  <<: *lux-short-squnet-48-envs
  env_hyperparams: &lux-short-squnet-78-envs-env
    <<: *lux-short-squnet-48-envs-env
    n_envs: 78
    self_play_kwargs: &lux-short-squnet-78-envs-env-self-play
      <<: *lux-short-squnet-48-envs-env-self-play
      num_old_policies: 24
      first_window_orig_policy: true
      swap_window_size: 6
  rollout_hyperparams: &lux-short-squnet-78-envs-rollout
    <<: *lux-short-squnet-48-envs-rollout
    num_envs_reset_every_rollout: 12
  algo_hyperparams: &lux-short-squnet-78-envs-algo
    <<: *lux-short-squnet-cuda-opt-algo
    batch_size: 832
    vf_coef: [0.16, 0.17, 0.16]
  hyperparam_transitions_kwargs:
    &lux-short-squnet-78-envs-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-6
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 1e-5
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 1e-5
        ent_coef: 0.001
        guide_probability: 0
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
        guide_probability: 0
    durations:
      - 0
      - 0.1
      - 0
      - 0.2
      - 0.5
      - 0.18
      - 0.02

LuxAI_S2-v0-short-squnet-78-envs-deimos: &lux-short-squnet-78-envs-deimos
  <<: *lux-short-squnet-78-envs
  policy_hyperparams: &lux-short-squnet-78-envs-deimos-policy
    <<: *lux-short-squnet-rl-robot-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/act6rrp0

LuxAI_S2-v0-short-squnet-78-envs-multi: &lux-short-squnet-78-envs-multi
  <<: *lux-short-squnet-78-envs
  policy_hyperparams:
    <<: *lux-short-squnet-rl-robot-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/i0s75uqy

LuxAI_S2-v0-short-squnet-78-envs-deimos-robots:
  &lux-short-squnet-78-envs-deimos-robots
  <<: *lux-short-squnet-78-envs-deimos
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-6
        multi_reward_weights: [0.45, 0.45, 0.1]
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 1e-5
        multi_reward_weights: [0.45, 0.45, 0.1]
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 1e-5
        multi_reward_weights: [0.45, 0.45, 0.1]
        ent_coef: 0.001
        guide_probability: 0
      - learning_rate: !!float 1e-5
        multi_reward_weights: [0.1, 0.8, 0.1]
        ent_coef: 0.001
        guide_probability: 0
      - learning_rate: !!float 1e-6
        multi_reward_weights: [0.1, 0.8, 0.1]
        ent_coef: 0.0001
        guide_probability: 0
    durations:
      - 0
      - 0.1
      - 0
      - 0.2
      - 0
      - 0.5
      - 0
      - 0.18
      - 0.02

LuxAI_S2-v0-short-squnet-78-envs-deimos-lighter-robots:
  &lux-short-squnet-78-envs-deimos-lighter-robots
  <<: *lux-short-squnet-78-envs-deimos-robots
  env_hyperparams: &lux-short-squnet-78-envs-deimos-lighter-robots-env
    <<: *lux-short-squnet-78-envs-env
    make_kwargs: &lux-short-squnet-78-envs-deimos-lighter-robots-env-make-kwargs
      <<: *lux-split-short-squnet-acbc-robot-env-make-kwargs
      reward_weights:
        built_light_by_time_remaining: 0.009
        built_heavy_by_time_remaining: 0.11

LuxAI_S2-v0-short-squnet-78-envs-deimos-old-adv-scale:
  &lux-short-squnet-78-envs-deimos-old-adv-scale
  <<: *lux-short-squnet-78-envs-deimos-lighter-robots
  algo_hyperparams: &lux-short-squnet-78-envs-deimos-old-adv-scale-algo
    <<: *lux-short-squnet-78-envs-algo
    normalize_advantages_after_scaling: false

LuxAI_S2-v0-sSqunet-78env-deimos-win-loss-smoothing:
  &lux-ssqunet-78envs-deimos-win-loss-smoothing
  <<: *lux-short-squnet-78-envs-deimos-old-adv-scale
  env_hyperparams: &lux-ssqunet-78envs-deimos-win-loss-smoothing-env
    <<: *lux-short-squnet-78-envs-deimos-lighter-robots-env
    additional_win_loss_smoothing_factor: 0.9

LuxAI_S2-v0-sSqunet-78env-deimos-lower-vf: &lux-ssqunet-78envs-deimos-lower-vf
  <<: *lux-ssqunet-78envs-deimos-win-loss-smoothing
  algo_hyperparams: &lux-ssqunet-78envs-deimos-lower-vf-algo
    <<: *lux-short-squnet-78-envs-deimos-old-adv-scale-algo
    vf_coef: [0.1, 0.1, 0.1]

LuxAI_S2-v0-sSqunet-78env-deimos-constant-robots-2:
  &lux-ssqunet-78envs-deimos-constant-robots-2
  <<: *lux-ssqunet-78envs-deimos-lower-vf
  algo_hyperparams: &lux-ssqunet-78envs-deimos-constant-robots-2-algo
    <<: *lux-ssqunet-78envs-deimos-lower-vf-algo
    multi_reward_weights: [0.2, 0.7, 0.1]
  hyperparam_transitions_kwargs:
    <<: *lux-short-squnet-78-envs-hyperparam-transitions

LuxAI_S2-v0-sSqunet-78env-deimos-constant-robots-3:
  &lux-ssqunet-78envs-deimos-constant-robots-3
  <<: *lux-ssqunet-78envs-deimos-constant-robots-2
  algo_hyperparams: &lux-ssqunet-78envs-deimos-constant-robots-3-algo
    <<: *lux-ssqunet-78envs-deimos-constant-robots-2-algo
    multi_reward_weights: [0.3, 0.6, 0.1]

LuxAI_S2-v0-sSqunet-78env-deimos-gamma-1: &lux-ssqunet-78envs-deimos-gamma-1
  <<: *lux-ssqunet-78envs-deimos-constant-robots-3
  algo_hyperparams: &lux-ssqunet-78envs-deimos-gamma-1-algo
    <<: *lux-ssqunet-78envs-deimos-constant-robots-3-algo
    gamma: [1, 1, 1]

LuxAI_S2-v0-sSqunet-78env-deimos-constant-robots-25:
  &lux-ssqunet-78envs-deimos-constant-robots-25
  <<: *lux-ssqunet-78envs-deimos-gamma-1
  algo_hyperparams: &lux-ssqunet-78envs-deimos-constant-robots-25-algo
    <<: *lux-ssqunet-78envs-deimos-gamma-1-algo
    multi_reward_weights: [0.25, 0.65, 0.1]

LuxAI_S2-v0-sSqunet-78env-deimos-lr2: &lux-ssqunet-78envs-deimos-high-lr2
  <<: *lux-ssqunet-78envs-deimos-constant-robots-25
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-6
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 2e-5
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 2e-5
        ent_coef: 0.001
        guide_probability: 0
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
        guide_probability: 0
    durations:
      - 0
      - 0.1
      - 0
      - 0.2
      - 0.5
      - 0.18
      - 0.02

LuxAI_S2-v0-sSqunet-78env-deimos-lr4: &lux-ssqunet-78envs-deimos-high-lr4
  <<: *lux-ssqunet-78envs-deimos-constant-robots-25
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-6
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 4e-5
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 4e-5
        ent_coef: 0.001
        guide_probability: 0
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
        guide_probability: 0
    durations:
      - 0
      - 0.1
      - 0
      - 0.2
      - 0.5
      - 0.18
      - 0.02

LuxAI_S2-v0-sSqunet-78env-deimos-lr8: &lux-ssqunet-78envs-deimos-high-lr8
  <<: *lux-ssqunet-78envs-deimos-constant-robots-25
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-6
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 8e-5
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 8e-5
        ent_coef: 0.001
        guide_probability: 0
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
        guide_probability: 0
    durations:
      - 0
      - 0.1
      - 0
      - 0.2
      - 0.5
      - 0.18
      - 0.02

LuxAI_S2-v0-sSqunet-78env-deimos-lr16: &lux-ssqunet-78envs-deimos-high-lr16
  <<: *lux-ssqunet-78envs-deimos-constant-robots-25
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-6
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 1.6e-4
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 1.6e-4
        ent_coef: 0.001
        guide_probability: 0
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
        guide_probability: 0
    durations:
      - 0
      - 0.1
      - 0
      - 0.2
      - 0.5
      - 0.18
      - 0.02

LuxAI_S2-v0-sSqunet-78env-deimos-lrH: &lux-ssqunet-78envs-deimos-high-lrh
  <<: *lux-ssqunet-78envs-deimos-constant-robots-25
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-6
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 6e-6
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 6e-6
        ent_coef: 0.001
        guide_probability: 0
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
        guide_probability: 0
    durations:
      - 0
      - 0.1
      - 0
      - 0.2
      - 0.5
      - 0.18
      - 0.02

LuxAI_S2-v0-sSqunet-78env-deimos-lrQ: &lux-ssqunet-78envs-deimos-high-lrq
  <<: *lux-ssqunet-78envs-deimos-constant-robots-25
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-6
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 3e-6
        ent_coef: 0.001
        guide_probability: 0.5
      - learning_rate: !!float 3e-6
        ent_coef: 0.001
        guide_probability: 0
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
        guide_probability: 0
    durations:
      - 0
      - 0.1
      - 0
      - 0.2
      - 0.5
      - 0.18
      - 0.02

LuxAI_S2-v0-sSqunet-78env-deimos-lr2-no-guide:
  &lux-ssqunet-78envs-deimos-lr2-no-guide
  <<: *lux-ssqunet-78envs-deimos-high-lr2
  rollout_type: sync
  rollout_hyperparams: &lux-ssqunet-78envs-deimos-lr2-no-guide-rollout
    <<: *lux-squnet-rollout
    num_envs_reset_every_rollout: 12
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-6
        ent_coef: 0.001
      - learning_rate: !!float 2e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.1
      - 0.55
      - 0.3
      - 0.05

LuxAI_S2-v0-sSqunet-78env-deimos-lr16-no-guide:
  &lux-ssqunet-78envs-deimos-lr16-no-guide
  <<: *lux-ssqunet-78envs-deimos-lr2-no-guide
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-6
        ent_coef: 0.001
      - learning_rate: !!float 1.6e-4
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.1
      - 0.55
      - 0.3
      - 0.05

LuxAI_S2-v0-sSqunet-78env-multi-fine-tune: &lux-ssqunet-78envs-multi-fine-tune
  <<: *lux-ssqunet-78envs-deimos-gamma-1
  rollout_type: sync
  rollout_hyperparams:
    <<: *lux-squnet-rollout
    num_envs_reset_every_rollout: 12
  policy_hyperparams:
    <<: *lux-short-squnet-78-envs-deimos-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/bwc9aold
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-6
        ent_coef: 0.001
      - learning_rate: !!float 1e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.1
      - 0.55
      - 0.3
      - 0.05

LuxAI_S2-v0-sSqunet-78env-deimos-lr2-hbots-100m:
  &lux-ssqunet-78envs-deimos-lr2-hbots-100m
  <<: *lux-ssqunet-78envs-deimos-lr2-no-guide
  n_timesteps: !!float 100e6
  algo_hyperparams: &lux-ssqunet-78envs-deimos-lr2-hbots-100m-algo
    <<: *lux-ssqunet-78envs-deimos-constant-robots-25-algo
    multi_reward_weights: [0.45, 0.45, 0.1]
  hyperparam_transitions_kwargs:
    &lux-ssqunet-78envs-deimos-lr2-hbots-100m-hparam-transitions
    durations:
      - 0
      - 0.1
      - 0.55
      - 0.3
      - 0.05
    interpolate_method: cosine
    phases:
      - ent_coef: 0.001
        learning_rate: 1.0e-06
      - ent_coef: 0.001
        learning_rate: 2.0e-05
      - ent_coef: 0.0001
        learning_rate: 1.0e-06

LuxAI_S2-v0-sSqunet-78env-deimos-lr4-hbots-100m:
  &lux-ssqunet-78envs-deimos-lr4-hbots-100m
  <<: *lux-ssqunet-78envs-deimos-lr2-hbots-100m
  hyperparam_transitions_kwargs:
    &lux-ssqunet-78envs-deimos-lr4-hbots-100m-hparam-transitions
    durations:
      - 0
      - 0.1
      - 0.55
      - 0.3
      - 0.05
    interpolate_method: cosine
    phases:
      - ent_coef: 0.001
        learning_rate: 1.0e-06
      - ent_coef: 0.001
        learning_rate: 4.0e-05
      - ent_coef: 0.0001
        learning_rate: 1.0e-06

LuxAI_S2-v0-sSqunet-78env-deimos-lr4d-hbots-100m:
  &lux-ssqunet-78envs-deimos-lr4d-hbots-100m
  <<: *lux-ssqunet-78envs-deimos-lr4-hbots-100m
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-6
        ent_coef: 0.001
      - learning_rate: !!float 4e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.2
      - 0.25
      - 0.5
      - 0.05

LuxAI_S2-v0-sSqnet-78env32-deimos-lr4d-hbots-50m:
  &lux-ssqnet-78env32-deimos-lr4d-hbots-50m
  <<: *lux-ssqunet-78envs-deimos-lr4d-hbots-100m
  n_timesteps: !!float 50e6
  env_hyperparams: &lux-ssqnet-78env32-env
    <<: *lux-ssqunet-78envs-deimos-win-loss-smoothing-env
    make_kwargs: &lux-ssqnet-78env32-env-make-kwargs
      <<: *lux-short-squnet-78-envs-deimos-lighter-robots-env-make-kwargs
      map_size: 32
      MIN_FACTORIES: 2
      MAX_FACTORIES: 3
  eval_hyperparams: &lux-ssqnet-78env32-eval
    <<: *lux-squnet-deimos-jumpstart-eval
    env_overrides: &lux-ssqnet-78env32-eval-env-overrides
      <<: *lux-squnet-deimos-jumpstart-eval-env-overrides
      make_kwargs: &lux-ssqnet-78env32-eval-env-override-make-kwargs
        <<: *lux-squnet-ideimos-eval-env-make-kwargs
        map_size: 32
        MIN_FACTORIES: 2
        MAX_FACTORIES: 3
    only_record_video_on_best: false
  algo_hyperparams: &lux-ssqnet-78env32-deimos-lr4d-hbots-50m-algo
    <<: *lux-ssqunet-78envs-deimos-lr2-hbots-100m-algo
    batch_size: 1664

LuxAI_S2-v0-sSqnet-78env16-deimos-lr4d-hbots-50m:
  &lux-ssqnet-78env16-deimos-lr4d-hbots-50m
  <<: *lux-ssqunet-78envs-deimos-lr4d-hbots-100m
  n_timesteps: !!float 50e6
  env_hyperparams: &lux-ssqnet-78env16-env
    <<: *lux-ssqnet-78env32-env
    make_kwargs: &lux-ssqnet-78env16-env-make-kwargs
      <<: *lux-ssqnet-78env32-env-make-kwargs
      map_size: 16
      MIN_FACTORIES: 1
      MAX_FACTORIES: 2
  eval_hyperparams: &lux-ssqnet-78env16-eval
    <<: *lux-ssqnet-78env32-eval
    env_overrides: &lux-ssqnet-78env16-eval-env-overrides
      <<: *lux-ssqnet-78env32-eval-env-overrides
      make_kwargs: &lux-ssqnet-78env16-eval-env-override-make-kwargs
        <<: *lux-ssqnet-78env32-eval-env-override-make-kwargs
        map_size: 16
        MIN_FACTORIES: 1
        MAX_FACTORIES: 2
  rollout_hyperparams: &lux-ssqnet-78env16-deimos-lr4d-hbots-50m-rollout
    <<: *lux-ssqunet-78envs-deimos-lr2-no-guide-rollout
    n_steps: 96
  algo_hyperparams: &lux-ssqnet-78env16-deimos-lr4d-hbots-50m-algo
    <<: *lux-ssqnet-78env32-deimos-lr4d-hbots-50m-algo
    batch_size: 7488

LuxAI_S2-v0-sSqunet-j256env16-80m: &lux-ssqnet-j256env16-80m
  <<: *lux-ssqnet-78env16-deimos-lr4d-hbots-50m
  n_timesteps: !!float 80e6
  additional_keys_to_log: ["results", "stats", "relative_stats"]
  env_hyperparams: &lux-ssqnet-j256env16-env
    <<: *lux-ssqnet-78env16-env
    vec_env_class: jux
    n_envs: 256
    make_kwargs: &lux-ssqnet-j256env16-env-make-kwargs
      <<: *lux-ssqnet-78env16-env-make-kwargs
      use_simplified_spaces: true
      USES_COMPACT_SPAWNS_MASK: true
      MAX_N_UNITS: 128
      MAX_GLOBAL_ID: 256
      reward_weights:
        win_loss: 1
      relative_stats_eps:
        &lux-ssqnet-j256env16-env-make-kwargs-relative-stats-eps
        generation:
          ice: 44
          ore: 44
          water: 22
          metal: 22
          light_bots: 0.22
          heavy_bots: 0.22
          opponent_kills: 0.22
        resources:
          lichen: 0.22
          light_bots: 0.22
          heavy_bots: 0.22
          water_in_factories: 0.22
    self_play_kwargs: &lux-ssqnet-j256env16-env-self-play
      <<: *lux-short-squnet-78-envs-env-self-play
      num_old_policies: 64
      swap_window_size: 16
      first_window_orig_policy: false
    additional_win_loss_reward: false
    additional_win_loss_smoothing_factor: none
    info_rewards:
      info_paths:
        - [relative_stats, generation, ice] # 2
        - [relative_stats, generation, ore] # 3
        - [relative_stats, generation, water] # 4
        - [relative_stats, generation, metal] # 5
        - [relative_stats, generation, power] # 6
        - [relative_stats, generation, light_bots] # 7
        - [relative_stats, generation, heavy_bots] # 8
        - [relative_stats, generation, opponent_kills] # 9
        - [relative_stats, resources, lichen] # 10
        - [relative_stats, resources, factories] # 11
        - [relative_stats, resources, water_in_factories] # 12
  checkpoints_kwargs:
    history_size: 4
  eval_hyperparams: &lux-ssqnet-j256env16-eval
    <<: *lux-ssqnet-78env16-eval
    env_overrides: &lux-ssqnet-j256env16-eval-env-overrides
      <<: *lux-ssqnet-78env16-eval-env-overrides
      n_envs: 128
      make_kwargs: &lux-ssqnet-j256env16-eval-env-override-make-kwargs
        <<: *lux-ssqnet-78env16-eval-env-override-make-kwargs
        use_simplified_spaces: true
        USES_COMPACT_SPAWNS_MASK: true
        MAX_N_UNITS: 128
        MAX_GLOBAL_ID: 256
      play_checkpoints_kwargs:
        n_envs_against_checkpoints: null
      info_rewards: null
    only_checkpoint_initial_policy: false
    only_checkpoint_best_policies: true
    score_threshold: 0.14
  policy_hyperparams: &lux-ssqnet-j256env16-policy
    <<: *lux-short-squnet-78-envs-deimos-policy
    load_run_path: null
    additional_critic_activation_functions:
      - tanh # score reward
      - tanh # generation ice
      - tanh # generation ore
      - tanh # generation water
      - tanh # generation metal
      - tanh # generation power
      - tanh # generation light bots
      - tanh # generation heavy bots
      - tanh # generation opponent kills
      - tanh # resources lichen
      - tanh # resources factory
      - tanh # resources water in factories
    output_activation_fn: tanh
    shared_critic_head: true
    critic_channels: 128
  rollout_hyperparams: &lux-ssqnet-j256env16-80m-rollout
    <<: *lux-ssqnet-78env16-deimos-lr4d-hbots-50m-rollout
    n_steps: 32
    num_envs_reset_every_rollout: 32
  algo_hyperparams: &lux-ssqnet-j256env16-80m-algo
    <<: *lux-ssqnet-78env16-deimos-lr4d-hbots-50m-algo
    batch_size: 8192
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # score reward
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0.1 # generation power
      - 0.1 # generation light bots
      - 0.1 # generation heavy bots
      - 0 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0 # resources water in factories
    gamma:
      - 1 # WinLoss
      - 1 # score reward
      - 1 # generation ice
      - 1 # generation ore
      - 1 # generation water
      - 1 # generation metal
      - 1 # generation power
      - 1 # generation light bots
      - 1 # generation heavy bots
      - 1 # generation opponent kills
      - 1 # resources lichen
      - 1 # resources factory
      - 1 # resources water in factories
    gae_lambda:
      - 0.95 # WinLoss
      - 0.95 # score reward
      - 0.95 # generation ice
      - 0.95 # generation ore
      - 0.95 # generation water
      - 0.95 # generation metal
      - 0.95 # generation power
      - 0.95 # generation light bots
      - 0.95 # generation heavy bots
      - 0.95 # generation opponent kills
      - 0.95 # resources lichen
      - 0.95 # resources factory
      - 0.95 # resources water in factories
    vf_coef:
      - 0.2 # WinLoss
      - 0.1 # score reward
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0.1 # generation power
      - 0.1 # generation light bots
      - 0.1 # generation heavy bots
      - 0 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0 # resources water in factories
    gradient_accumulation: false
  hyperparam_transitions_kwargs:
    &lux-ssqnet-j256env16-80m-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-6
        ent_coef: 0.01
      - learning_rate: !!float 1e-4
        ent_coef: 0.01
      - learning_rate: !!float 1e-6
        ent_coef: 0.001
    durations:
      - 0
      - 0.1
      - 0.55
      - 0.3
      - 0.05

LuxAI_S2-v0-sSqunet-j1024env16-80m: &lux-ssqnet-j1024env16-80m
  <<: *lux-ssqnet-j256env16-80m
  env_hyperparams: &lux-ssqnet-j1024env16-env
    <<: *lux-ssqnet-j256env16-env
    n_envs: 1024
    self_play_kwargs: &lux-ssqnet-j1024env16-env-self-play
      <<: *lux-ssqnet-j256env16-env-self-play
      num_old_policies: 256
      swap_window_size: 64
  rollout_hyperparams: &lux-ssqnet-j1024env16-80m-rollout
    <<: *lux-ssqnet-j256env16-80m-rollout
    n_steps: 8
    num_envs_reset_every_rollout: 128
  algo_hyperparams: &lux-ssqnet-j1024env16-80m-algo
    <<: *lux-ssqnet-j256env16-80m-algo
    batch_size: 8192

LuxAI_S2-v0-sSqunet-j1024env16-r32-80m: &lux-ssqnet-j1024env16-r32-80m
  <<: *lux-ssqnet-j1024env16-80m
  rollout_hyperparams: &lux-ssqnet-j1024env16-r32-80m-rollout
    <<: *lux-ssqnet-j1024env16-80m-rollout
    n_steps: 32
  algo_hyperparams: &lux-ssqnet-j1024env16-r32-80m-algo
    <<: *lux-ssqnet-j1024env16-80m-algo
    gradient_accumulation: true

LuxAI_S2-v0-sSqunet-j1024env16-r32-dr-80m: &lux-ssqnet-j1024env16-r32-dr-80m
  <<: *lux-ssqnet-j1024env16-r32-80m
  env_hyperparams: &lux-ssqnet-j1024env16-r32-dr-80m-env
    <<: *lux-ssqnet-j1024env16-env
    info_rewards: &lux-ssqnet-j1024env16-r32-dr-80m-env-info-rewards
      info_paths:
        - [delta_relative_stats, generation, ice] # 2
        - [delta_relative_stats, generation, ore] # 3
        - [delta_relative_stats, generation, water] # 4
        - [delta_relative_stats, generation, metal] # 5
        - [delta_relative_stats, generation, power] # 6
        - [delta_relative_stats, generation, light_bots] # 7
        - [delta_relative_stats, generation, heavy_bots] # 8
        - [delta_relative_stats, generation, opponent_kills] # 9
        - [delta_relative_stats, resources, lichen] # 10
        - [delta_relative_stats, resources, factories] # 11
        - [delta_relative_stats, resources, water_in_factories] # 12
      episode_end: false
  policy_hyperparams: &lux-ssqnet-j1024env16-r32-dr-80m-policy
    <<: *lux-ssqnet-j256env16-policy
    additional_critic_activation_functions:
      - tanh # score reward
      - identity # generation ice
      - identity # generation ore
      - identity # generation water
      - identity # generation metal
      - identity # generation power
      - identity # generation light bots
      - identity # generation heavy bots
      - identity # generation opponent kills
      - identity # resources lichen
      - identity # resources factory
      - identity # resources water in factories

LuxAI_S2-v0-sSqunet-j1024env16-80m-faststart:
  &lux-ssqnet-j1024env16-80m-faststart
  <<: *lux-ssqnet-j1024env16-r32-dr-80m
  hyperparam_transitions_kwargs:
    &lux-ssqnet-j1024env16-80m-faststart-hyperparam-transitions
    <<: *lux-ssqnet-j256env16-80m-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 5e-5
        ent_coef: 0.01
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.7
      - 0
      - 0.3
      - 0

LuxAI_S2-v0-sSqunet-j1024env16-100m-fstart: &lux-ssqnet-j1024env16-100m-fstart
  <<: *lux-ssqnet-j1024env16-80m-faststart
  n_timesteps: !!float 100e6

LuxAI_S2-v0-sSqunet-j1024env16-80m-lr10: &lux-ssqnet-j1024env16-80m-lr10
  <<: *lux-ssqnet-j1024env16-80m-faststart
  hyperparam_transitions_kwargs:
    &lux-ssqnet-j1024env16-80m-lr10-hyperparam-transitions
    <<: *lux-ssqnet-j1024env16-80m-faststart-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-4
        ent_coef: 0.01
      - learning_rate: !!float 1e-4
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.7
      - 0
      - 0.3
      - 0

LuxAI_S2-v0-sSqunet-j1024env16-80m-2i2o: &lux-ssqnet-j1024env16-80m-2i2o
  <<: *lux-ssqnet-j1024env16-80m-faststart
  env_hyperparams: &lux-j1024env16-2i2o-env
    <<: *lux-ssqnet-j1024env16-r32-dr-80m-env
    make_kwargs: &lux-j1024env16-2i2o-env-make-kwargs
      <<: *lux-ssqnet-j256env16-env-make-kwargs
      min_ice: 2
      min_ore: 2
      relative_stats_eps:
        &lux-j1024env16-2i2o-env-make-kwargs-relative-stats-eps
        generation:
          ice: 44
          ore: 44
          water: 22
          metal: 22
          light_bots: 0.44
          heavy_bots: 0.44
          opponent_kills: 0.44
        resources:
          lichen: 0.44
          light_bots: 0.44
          heavy_bots: 0.44
          water_in_factories: 0.44
  eval_hyperparams: &lux-j1024env16-2i2o-eval
    <<: *lux-ssqnet-j256env16-eval
    env_overrides: &lux-j1024env16-2i2o-eval-env-overrides
      <<: *lux-ssqnet-j256env16-eval-env-overrides
      make_kwargs: &lux-j1024env16-2i2o-eval-env-override-make-kwargs
        <<: *lux-ssqnet-j256env16-eval-env-override-make-kwargs
        min_ice: 2
        min_ore: 2

LuxAI_S2-v0-sSqunet-j1024env16-2i2o-80m-old-reward:
  &lux-ssqnet-j1024env16-2i2o-80m-old-reward
  <<: *lux-ssqnet-j1024env16-80m-2i2o
  env_hyperparams: &lux-j1024env16-2i2o-old-reward-env
    <<: *lux-j1024env16-2i2o-env
    make_kwargs: &lux-j1024env16-2i2o-old-reward-env-make-kwargs
      <<: *lux-j1024env16-2i2o-env-make-kwargs
      use_difference_ratio: true
      relative_stats_eps:
        &lux-j1024env16-2i2o-old-reward-env-make-kwargs-relative-stats-eps
        generation:
          ice: 22
          ore: 22
          water: 11
          metal: 11
          light_bots: 0.22
          heavy_bots: 0.22
          opponent_kills: 0.22
        resources:
          lichen: 0.22
          light_bots: 0.22
          heavy_bots: 0.22
          water_in_factories: 0.22
  eval_hyperparams: &lux-j1024env16-2i2o-old-reward-eval
    <<: *lux-j1024env16-2i2o-eval
    env_overrides: &lux-j1024env16-2i2o-old-reward-eval-env-overrides
      <<: *lux-j1024env16-2i2o-eval-env-overrides
      make_kwargs: &lux-j1024env16-2i2o-old-reward-eval-env-override-make-kwargs
        <<: *lux-j1024env16-2i2o-eval-env-override-make-kwargs
        use_difference_ratio: true

LuxAI_S2-v0-sSqunet-j1024env16-2i2o-80m-no-power:
  &lux-ssqnet-j1024env16-2i2o-80m-no-power
  <<: *lux-ssqnet-j1024env16-2i2o-80m-old-reward
  algo_hyperparams: &lux-ssqnet-j1024env16-2i2o-80m-no-power-algo
    <<: *lux-ssqnet-j1024env16-r32-80m-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # score reward
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0 # generation power
      - 0.1 # generation light bots
      - 0.1 # generation heavy bots
      - 0 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0 # resources water in factories
    vf_coef:
      - 0.2 # WinLoss
      - 0.1 # score reward
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0 # generation power
      - 0.1 # generation light bots
      - 0.1 # generation heavy bots
      - 0 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0 # resources water in factories

LuxAI_S2-v0-sSqunet-j1024env16-2i2o-80m-low-secondary:
  &lux-ssqnet-j1024env16-2i2o-80m-low-secondary
  <<: *lux-ssqnet-j1024env16-80m-2i2o
  algo_hyperparams: &lux-ssqnet-j1024env16-2i2o-80m-low-secondary-algo
    <<: *lux-ssqnet-j1024env16-r32-80m-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.05 # score reward
      - 0.05 # generation ice
      - 0.05 # generation ore
      - 0.05 # generation water
      - 0.05 # generation metal
      - 0.05 # generation power
      - 0.05 # generation light bots
      - 0.05 # generation heavy bots
      - 0 # generation opponent kills
      - 0.05 # resources lichen
      - 0.05 # resources factory
      - 0 # resources water in factories
    vf_coef:
      - 0.2 # WinLoss
      - 0.05 # score reward
      - 0.05 # generation ice
      - 0.05 # generation ore
      - 0.05 # generation water
      - 0.05 # generation metal
      - 0.05 # generation power
      - 0.05 # generation light bots
      - 0.05 # generation heavy bots
      - 0 # generation opponent kills
      - 0.05 # resources lichen
      - 0.05 # resources factory
      - 0 # resources water in factories

LuxAI_S2-v0-sSqunet-j1024env16-r32-240m: &lux-ssqnet-j1024env16-r32-240m
  <<: *lux-ssqnet-j1024env16-r32-80m
  n_timesteps: !!float 240e6
  hyperparam_transitions_kwargs:
    &lux-ssqnet-j1024env16-r32-240m-hyperparam-transitions
    <<: *lux-ssqnet-j256env16-80m-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-6
        ent_coef: 0.01
      - learning_rate: !!float 5e-5
        ent_coef: 0.01
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.2
      - 0
      - 0.6
      - 0
      - 0.2
      - 0

LuxAI_S2-v0-sSqunet-j2048env16-r32-240m: &lux-ssqnet-j2048env16-r32-240m
  <<: *lux-ssqnet-j1024env16-r32-240m
  env_hyperparams: &lux-ssqnet-j2048env16-env
    <<: *lux-ssqnet-j1024env16-env
    n_envs: 2048
    self_play_kwargs:
      <<: *lux-ssqnet-j1024env16-env-self-play
      num_old_policies: 512
      swap_window_size: 128
  rollout_hyperparams: &lux-ssqnet-j2048env16-r32-240m-rollout
    <<: *lux-ssqnet-j1024env16-r32-80m-rollout
    num_envs_reset_every_rollout: 256
  algo_hyperparams: &lux-ssqnet-j1024env16-r32-240m-algo
    <<: *lux-ssqnet-j1024env16-r32-80m-algo
    batch_size: 4096

LuxAI_S2-v0-sSqunet-j2048env16-r8-240m: &lux-ssqnet-j2048env16-r8-240m
  <<: *lux-ssqnet-j2048env16-r32-240m
  rollout_hyperparams: &lux-ssqnet-j2048env16-r8-240m-rollout
    <<: *lux-ssqnet-j2048env16-r32-240m-rollout
    n_steps: 8

LuxAI_S2-v0-sSqnet-78env16-deimos-lr4d-hbots-200m:
  &lux-ssqnet-78env16-deimos-lr4d-hbots-200m
  <<: *lux-ssqnet-78env16-deimos-lr4d-hbots-50m
  n_timesteps: !!float 200e6

LuxAI_S2-v0-sSqnet-78env32-deimos-lr4d-hbots-200m:
  &lux-ssqnet-78env32-deimos-lr4d-hbots-200m
  <<: *lux-ssqnet-78env32-deimos-lr4d-hbots-50m
  n_timesteps: !!float 200e6

LuxAI_S2-v0-sSqnet-78env48-deimos-lr4d-hbots-50m:
  &lux-ssqnet-78env48-deimos-lr4d-hbots-50m
  <<: *lux-ssqunet-78envs-deimos-lr4d-hbots-100m
  n_timesteps: !!float 50e6
  env_hyperparams: &lux-ssqnet-78env48-env
    <<: *lux-ssqnet-78env32-env
    make_kwargs: &lux-ssqnet-78env48-env-make-kwargs
      <<: *lux-ssqnet-78env32-env-make-kwargs
      map_size: 48
      MIN_FACTORIES: 2
      MAX_FACTORIES: 5
  eval_hyperparams: &lux-ssqnet-78env48-eval
    <<: *lux-ssqnet-78env32-eval
    env_overrides: &lux-ssqnet-78env48-eval-env-overrides
      <<: *lux-ssqnet-78env32-eval-env-overrides
      make_kwargs: &lux-ssqnet-78env48-eval-env-override-make-kwargs
        <<: *lux-ssqnet-78env32-eval-env-override-make-kwargs
        map_size: 48
        MIN_FACTORIES: 2
        MAX_FACTORIES: 5
  rollout_hyperparams:
    <<: *lux-ssqunet-78envs-deimos-lr2-no-guide-rollout
    n_steps: 64
  algo_hyperparams: &lux-ssqnet-78env48-deimos-lr4d-hbots-50m-algo
    <<: *lux-ssqnet-78env32-deimos-lr4d-hbots-50m-algo
    batch_size: 832

LuxAI_S2-v0-sSqnet-78env64-deimos-lr4d-hbots-50m:
  &lux-ssqnet-78env64-deimos-lr4d-hbots-50m
  <<: *lux-ssqunet-78envs-deimos-lr4d-hbots-100m
  n_timesteps: !!float 50e6
  env_hyperparams: &lux-ssqnet-78env64-env
    <<: *lux-ssqnet-78env32-env
    make_kwargs: &lux-ssqnet-78env64-env-make-kwargs
      <<: *lux-ssqnet-78env32-env-make-kwargs
      map_size: 64
      MIN_FACTORIES: 4
      MAX_FACTORIES: 10
  eval_hyperparams: &lux-ssqnet-78env64-eval
    <<: *lux-ssqnet-78env32-eval
    env_overrides: &lux-ssqnet-78env64-eval-env-overrides
      <<: *lux-ssqnet-78env32-eval-env-overrides
      make_kwargs: &lux-ssqnet-78env64-eval-env-override-make-kwargs
        <<: *lux-ssqnet-78env32-eval-env-override-make-kwargs
        map_size: 64
        MIN_FACTORIES: 4
        MAX_FACTORIES: 10
  rollout_hyperparams:
    <<: *lux-ssqunet-78envs-deimos-lr2-no-guide-rollout
    n_steps: 64
  algo_hyperparams: &lux-ssqnet-78env64-deimos-lr4d-hbots-50m-algo
    <<: *lux-ssqnet-78env32-deimos-lr4d-hbots-50m-algo
    batch_size: 416

LuxAI_S2-v0-sSqnet-j1024env16-80m-checkpoints:
  &lux-ssqnet-j1024env16-80m-checkpoints
  <<: *lux-ssqnet-j1024env16-80m-2i2o
  env_hyperparams: &lux-j1024env16-checkpoints-env
    <<: *lux-j1024env16-2i2o-env
    self_play_kwargs: null
    play_checkpoints_kwargs:
      n_envs_against_checkpoints: 256
  checkpoints_kwargs:
    history_size: 4
  eval_hyperparams: &lux-j1024env16-checkpoints-eval
    <<: *lux-j1024env16-2i2o-eval
    env_overrides:
      <<: *lux-j1024env16-2i2o-eval-env-overrides
      n_envs: 128
      play_checkpoints_kwargs:
        n_envs_against_checkpoints: null
    only_checkpoint_initial_policy: false
    only_checkpoint_best_policies: true
    score_threshold: 0.14
    step_freq: !!float 2.5e6

LuxAI_S2-v0-sSqnet-j1024env16-80m-checkpoints-old-reward:
  &lux-ssqnet-j1024env16-80m-checkpoints-old-reward
  <<: *lux-ssqnet-j1024env16-2i2o-80m-no-power
  env_hyperparams: &lux-j1024env16-checkpoints-old-reward-env
    <<: *lux-j1024env16-2i2o-old-reward-env
    self_play_kwargs: null
    play_checkpoints_kwargs:
      n_envs_against_checkpoints: 256
  checkpoints_kwargs:
    history_size: 4
  eval_hyperparams: &lux-j1024env16-checkpoints-old-reward-eval
    <<: *lux-j1024env16-2i2o-old-reward-eval
    env_overrides: &lux-j1024env16-checkpoints-old-reward-eval-env-overrides
      <<: *lux-j1024env16-2i2o-old-reward-eval-env-overrides
      n_envs: 128
      play_checkpoints_kwargs:
        n_envs_against_checkpoints: null
    only_checkpoint_initial_policy: false
    only_checkpoint_best_policies: true
    score_threshold: 0.14
    step_freq: !!float 2.5e6

LuxAI_S2-v0-sSqnet-j1024env16-80m-opponent-kills:
  &lux-ssqnet-j1024env16-80m-opponent-kills
  <<: *lux-ssqnet-j1024env16-80m-checkpoints
  algo_hyperparams: &lux-ssqnet-j1024env16-80m-opponent-kills-algo
    <<: *lux-ssqnet-j1024env16-r32-80m-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # score reward
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0.1 # generation power
      - 0.1 # generation light bots
      - 0.1 # generation heavy bots
      - 0.1 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0 # resources water in factories
    vf_coef:
      - 0.2 # WinLoss
      - 0.1 # score reward
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0.1 # generation power
      - 0.1 # generation light bots
      - 0.1 # generation heavy bots
      - 0.1 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0 # resources water in factories

LuxAI_S2-v0-sSqnet-j1024env16-80m-okills-low-vf:
  &lux-ssqnet-j1024env16-80m-okills-low-vf
  <<: *lux-ssqnet-j1024env16-80m-opponent-kills
  algo_hyperparams: &lux-ssqnet-j1024env16-80m-okills-low-vf-algo
    <<: *lux-ssqnet-j1024env16-80m-opponent-kills-algo
    vf_coef:
      - 0.2 # WinLoss
      - 0.05 # score reward
      - 0.05 # generation ice
      - 0.05 # generation ore
      - 0.05 # generation water
      - 0.05 # generation metal
      - 0.05 # generation power
      - 0.05 # generation light bots
      - 0.05 # generation heavy bots
      - 0.05 # generation opponent kills
      - 0.05 # resources lichen
      - 0.05 # resources factory
      - 0 # resources water in factories

LuxAI_S2-v0-sSqnet-j1024env16-80m-okills-old-reward:
  &lux-ssqnet-j1024env16-80m-okills-old-reward
  <<: *lux-ssqnet-j1024env16-80m-checkpoints-old-reward
  algo_hyperparams: &lux-ssqnet-j1024env16-80m-okills-old-reward-algo
    <<: *lux-ssqnet-j1024env16-2i2o-80m-no-power-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # score reward
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0 # generation power
      - 0.1 # generation light bots
      - 0.1 # generation heavy bots
      - 0.1 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0 # resources water in factories
    vf_coef:
      - 0.2 # WinLoss
      - 0.1 # score reward
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0 # generation power
      - 0.1 # generation light bots
      - 0.1 # generation heavy bots
      - 0.1 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0 # resources water in factories

LuxAI_S2-v0-sSqnet-j1024env16-80m-no-score-reward:
  &lux-ssqnet-j1024env16-80m-no-score-reward
  <<: *lux-ssqnet-j1024env16-80m-okills-old-reward
  env_hyperparams: &lux-j1024env16-no-score-reward-env
    <<: *lux-j1024env16-checkpoints-old-reward-env
    score_reward_kwargs: null
  policy_hyperparams: &lux-ssqnet-j1024env16-80m-no-score-reward-policy
    <<: *lux-ssqnet-j1024env16-r32-dr-80m-policy
    additional_critic_activation_functions:
      - identity # generation ice
      - identity # generation ore
      - identity # generation water
      - identity # generation metal
      - identity # generation power
      - identity # generation light bots
      - identity # generation heavy bots
      - identity # generation opponent kills
      - identity # resources lichen
      - identity # resources factory
      - identity # resources water in factories
  algo_hyperparams: &lux-ssqnet-j1024env16-80m-no-score-reward-algo
    <<: *lux-ssqnet-j1024env16-80m-okills-old-reward-algo
    gamma:
      - 1 # WinLoss
      - 1 # generation ice
      - 1 # generation ore
      - 1 # generation water
      - 1 # generation metal
      - 1 # generation power
      - 1 # generation light bots
      - 1 # generation heavy bots
      - 1 # generation opponent kills
      - 1 # resources lichen
      - 1 # resources factory
      - 1 # resources water in factories
    gae_lambda:
      - 0.95 # WinLoss
      - 0.95 # generation ice
      - 0.95 # generation ore
      - 0.95 # generation water
      - 0.95 # generation metal
      - 0.95 # generation power
      - 0.95 # generation light bots
      - 0.95 # generation heavy bots
      - 0.95 # generation opponent kills
      - 0.95 # resources lichen
      - 0.95 # resources factory
      - 0.95 # resources water in factories
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0 # generation power
      - 0.1 # generation light bots
      - 0.1 # generation heavy bots
      - 0.1 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0 # resources water in factories
    vf_coef:
      - 0.2 # WinLoss
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0 # generation power
      - 0.1 # generation light bots
      - 0.1 # generation heavy bots
      - 0.1 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0 # resources water in factories

LuxAI_S2-v0-sSqnet-j1024env16-80m-factory-water:
  &lux-ssqnet-j1024env16-80m-factory-water
  <<: *lux-ssqnet-j1024env16-80m-no-score-reward
  algo_hyperparams: &lux-ssqnet-j1024env16-80m-factory-water-algo
    <<: *lux-ssqnet-j1024env16-80m-no-score-reward-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0 # generation power
      - 0.1 # generation light bots
      - 0.1 # generation heavy bots
      - 0.1 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0.1 # resources water in factories
    vf_coef:
      - 0.2 # WinLoss
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0 # generation power
      - 0.1 # generation light bots
      - 0.1 # generation heavy bots
      - 0.1 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0.1 # resources water in factories

LuxAI_S2-v0-sSqnet-j1024env16-80m-no-clip-vf:
  &lux-ssqnet-j1024env16-80m-no-clip-vf
  <<: *lux-ssqnet-j1024env16-80m-factory-water
  algo_hyperparams: &lux-ssqnet-j1024env16-80m-no-clip-vf-algo
    <<: *lux-ssqnet-j1024env16-80m-factory-water-algo
    clip_range_vf: null

LuxAI_S2-v0-sSqnet-j1024env16-80m-322res: &lux-ssqnet-j1024env16-80m-322res
  <<: *lux-ssqnet-j1024env16-80m-no-clip-vf
  policy_hyperparams: &lux-ssqnet-j1024env16-80m-322res-policy
    <<: *lux-ssqnet-j1024env16-80m-no-score-reward-policy
    encoder_residual_blocks_per_level: [3, 2, 2]
    decoder_residual_blocks_per_level: [2, 3]
  algo_hyperparams: &lux-ssqnet-j1024env16-80m-322res-algo
    <<: *lux-ssqnet-j1024env16-80m-no-clip-vf-algo
    batch_size: 4096

LuxAI_S2-v0-sSqnet-j1024env16-80m-no-unit-transfers:
  &lux-ssqnet-j1024env16-80m-no-unit-transfers
  <<: *lux-ssqnet-j1024env16-80m-322res
  env_hyperparams: &lux-j1024env16-no-unit-transfers-env
    <<: *lux-j1024env16-no-score-reward-env
    make_kwargs: &lux-j1024env16-no-unit-transfers-env-make-kwargs
      <<: *lux-j1024env16-2i2o-old-reward-env-make-kwargs
      disable_unit_to_unit_transfers: true
  eval_hyperparams: &lux-j1024env16-no-unit-transfers-eval
    <<: *lux-j1024env16-checkpoints-old-reward-eval
    env_overrides: &lux-j1024env16-no-unit-transfers-eval-env-overrides
      <<: *lux-j1024env16-checkpoints-old-reward-eval-env-overrides
      make_kwargs:
        &lux-j1024env16-no-unit-transfers-eval-env-overrides-make-kwargs
        <<: *lux-j1024env16-2i2o-old-reward-eval-env-override-make-kwargs
        disable_unit_to_unit_transfers: true

LuxAI_S2-v0-sSqnet-j1024env16-80m-simple-actions:
  &lux-ssqnet-j1024env16-80m-simple-actions
  <<: *lux-ssqnet-j1024env16-80m-no-unit-transfers
  env_hyperparams: &lux-j1024env16-simple-actions-env
    <<: *lux-j1024env16-no-unit-transfers-env
    make_kwargs: &lux-j1024env16-simple-actions-env-make-kwargs
      <<: *lux-j1024env16-no-unit-transfers-env-make-kwargs
      disable_cargo_pickup: true
  eval_hyperparams: &lux-j1024env16-simple-actions-eval
    <<: *lux-j1024env16-no-unit-transfers-eval
    env_overrides: &lux-j1024env16-simple-actions-eval-env-overrides
      <<: *lux-j1024env16-no-unit-transfers-eval-env-overrides
      make_kwargs: &lux-j1024env16-simple-actions-eval-env-overrides-make-kwargs
        <<: *lux-j1024env16-no-unit-transfers-eval-env-overrides-make-kwargs
        disable_cargo_pickup: true

LuxAI_S2-v0-sSqnet-j1024env16-80m-next-ice: &lux-ssqnet-j1024env16-80m-next-ice
  <<: *lux-ssqnet-j1024env16-80m-simple-actions
  env_hyperparams: &lux-j1024env16-next-ice-env
    <<: *lux-j1024env16-simple-actions-env
    make_kwargs: &lux-j1024env16-next-ice-env-make-kwargs
      <<: *lux-j1024env16-simple-actions-env-make-kwargs
      factory_ice_distance_buffer: 0
  eval_hyperparams: &lux-j1024env16-next-ice-eval
    <<: *lux-j1024env16-simple-actions-eval
    env_overrides: &lux-j1024env16-next-ice-eval-env-overrides
      <<: *lux-j1024env16-simple-actions-eval-env-overrides
      make_kwargs: &lux-j1024env16-next-ice-eval-env-overrides-make-kwargs
        <<: *lux-j1024env16-simple-actions-eval-env-overrides-make-kwargs
        factory_ice_distance_buffer: 0

LuxAI_S2-v0-sSqnet-j1024env16-80m-power-water-vf:
  &lux-ssqnet-j1024env16-80m-power-water-vf
  <<: *lux-ssqnet-j1024env16-80m-next-ice
  algo_hyperparams: &lux-ssqnet-j1024env16-80m-power-water-vf-algo
    <<: *lux-ssqnet-j1024env16-80m-322res-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0 # generation power
      - 0.1 # generation light bots
      - 0.1 # generation heavy bots
      - 0.1 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0 # resources water in factories
    vf_coef:
      - 0.2 # WinLoss
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0.1 # generation power
      - 0.1 # generation light bots
      - 0.1 # generation heavy bots
      - 0.1 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0.1 # resources water in factories

LuxAI_S2-v0-sSqnet-j1024env16-80m-game-length:
  &lux-ssqnet-j1024env16-80m-game-length
  <<: *lux-ssqnet-j1024env16-80m-next-ice
  env_hyperparams: &lux-j1024env16-game-length-env
    <<: *lux-j1024env16-next-ice-env
    info_rewards: &lux-j1024env16-game-length-env-info-rewards
      info_paths:
        - [delta_relative_stats, generation, ice] # 1
        - [delta_relative_stats, generation, ore] # 2
        - [delta_relative_stats, generation, water] # 3
        - [delta_relative_stats, generation, metal] # 4
        - [delta_relative_stats, generation, power] # 5
        - [delta_relative_stats, generation, light_bots] # 6
        - [delta_relative_stats, generation, heavy_bots] # 7
        - [delta_relative_stats, generation, opponent_kills] # 8
        - [delta_relative_stats, resources, lichen] # 9
        - [delta_relative_stats, resources, factories] # 10
        - [delta_relative_stats, resources, water_in_factories] # 11
        - [stats, real_env_steps] # 12
      episode_end:
        - false # generation ice
        - false # generation ore
        - false # generation water
        - false # generation metal
        - false # generation power
        - false # generation light bots
        - false # generation heavy bots
        - false # generation opponent kills
        - false # resources lichen
        - false # resources factory
        - false # resources water in factories
        - true # game length
      multiplier:
        - 1 # generation ice
        - 1 # generation ore
        - 1 # generation water
        - 1 # generation metal
        - 1 # generation power
        - 1 # generation light bots
        - 1 # generation heavy bots
        - 1 # generation opponent kills
        - 1 # resources lichen
        - 1 # resources factory
        - 1 # resources water in factories
        - 0.001 # game length
  policy_hyperparams: &lux-ssqnet-j1024env16-80m-game-length-policy
    <<: *lux-ssqnet-j1024env16-80m-322res-policy
    additional_critic_activation_functions:
      - identity # generation ice
      - identity # generation ore
      - identity # generation water
      - identity # generation metal
      - identity # generation power
      - identity # generation light bots
      - identity # generation heavy bots
      - identity # generation opponent kills
      - identity # resources lichen
      - identity # resources factory
      - identity # resources water in factories
      - identity # game length
  algo_hyperparams: &lux-ssqnet-j1024env16-80m-game-length-algo
    <<: *lux-ssqnet-j1024env16-80m-322res-algo
    gamma:
      - 1 # WinLoss
      - 1 # generation ice
      - 1 # generation ore
      - 1 # generation water
      - 1 # generation metal
      - 1 # generation power
      - 1 # generation light bots
      - 1 # generation heavy bots
      - 1 # generation opponent kills
      - 1 # resources lichen
      - 1 # resources factory
      - 1 # resources water in factories
      - 1 # game length
    gae_lambda:
      - 0.95 # WinLoss
      - 0.95 # generation ice
      - 0.95 # generation ore
      - 0.95 # generation water
      - 0.95 # generation metal
      - 0.95 # generation power
      - 0.95 # generation light bots
      - 0.95 # generation heavy bots
      - 0.95 # generation opponent kills
      - 0.95 # resources lichen
      - 0.95 # resources factory
      - 0.95 # resources water in factories
      - 0.95 # game length
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0 # generation power
      - 0.1 # generation light bots
      - 0.1 # generation heavy bots
      - 0.1 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0 # resources water in factories
      - 0 # game length
    vf_coef:
      - 0.2 # WinLoss
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0.1 # generation power
      - 0.1 # generation light bots
      - 0.1 # generation heavy bots
      - 0.1 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0.1 # resources water in factories
      - 0.1 # game length

LuxAI_S2-v0-sSqnet-j1024env16-80m-next-ore: &lux-ssqnet-j1024env16-80m-next-ore
  <<: *lux-ssqnet-j1024env16-80m-game-length
  env_hyperparams: &lux-j1024env16-next-ore-env
    <<: *lux-j1024env16-game-length-env
    make_kwargs: &lux-j1024env16-next-ore-env-make-kwargs
      <<: *lux-j1024env16-next-ice-env-make-kwargs
      factory_ore_distance_buffer: 0
      factory_ice_distance_buffer: null
  eval_hyperparams: &lux-j1024env16-next-ore-eval
    <<: *lux-j1024env16-next-ice-eval
    env_overrides: &lux-j1024env16-next-ore-eval-env-overrides
      <<: *lux-j1024env16-next-ice-eval-env-overrides
      make_kwargs: &lux-j1024env16-next-ore-eval-env-overrides-make-kwargs
        <<: *lux-j1024env16-next-ice-eval-env-overrides-make-kwargs
        factory_ore_distance_buffer: 0
        factory_ice_distance_buffer: null

LuxAI_S2-v0-sSqnet-j1024env16-80m-iwater150:
  &lux-ssqnet-j1024env16-80m-iwater150
  <<: *lux-ssqnet-j1024env16-80m-next-ore
  env_hyperparams: &lux-j1024env16-iwater150-env
    <<: *lux-j1024env16-next-ore-env
    make_kwargs: &lux-j1024env16-iwater150-env-make-kwargs
      <<: *lux-j1024env16-next-ore-env-make-kwargs
      factory_ore_distance_buffer: 0
      factory_ice_distance_buffer: null
      init_water_constant: true
  eval_hyperparams: &lux-j1024env16-iwater150-eval
    <<: *lux-j1024env16-next-ore-eval
    env_overrides: &lux-j1024env16-iwater150-eval-env-overrides
      <<: *lux-j1024env16-next-ore-eval-env-overrides
      make_kwargs: &lux-j1024env16-iwater150-eval-env-overrides-make-kwargs
        <<: *lux-j1024env16-next-ore-eval-env-overrides-make-kwargs
        factory_ore_distance_buffer: 0
        factory_ice_distance_buffer: null
        init_water_constant: true

LuxAI_S2-v0-sSqnet-j1024env16-80m-a100-iwater150:
  &lux-ssqnet-j1024env16-80m-a100-iwater150
  <<: *lux-ssqnet-j1024env16-80m-iwater150
  algo_hyperparams: &lux-ssqnet-j1024env16-80m-a100-iwater150-algo
    <<: *lux-ssqnet-j1024env16-80m-game-length-algo
    batch_size: 8192

LuxAI_S2-v0-sSqnet-j1024env16-80m-a100-close-ice-ore:
  &lux-ssqnet-j1024env16-80m-a100-close-ice-ore
  <<: *lux-ssqnet-j1024env16-80m-a100-iwater150
  env_hyperparams: &lux-j1024env16-close-ice-ore-env
    <<: *lux-j1024env16-iwater150-env
    make_kwargs: &lux-j1024env16-close-ice-ore-env-make-kwargs
      <<: *lux-j1024env16-iwater150-env-make-kwargs
      factory_ore_distance_buffer: 0
      factory_ice_distance_buffer: 0
      init_water_constant: true
  eval_hyperparams: &lux-j1024env16-close-ice-ore-eval
    <<: *lux-j1024env16-iwater150-eval
    env_overrides: &lux-j1024env16-close-ice-ore-eval-env-overrides
      <<: *lux-j1024env16-iwater150-eval-env-overrides
      make_kwargs: &lux-j1024env16-close-ice-ore-eval-env-overrides-make-kwargs
        <<: *lux-j1024env16-iwater150-eval-env-overrides-make-kwargs
        factory_ore_distance_buffer: 0
        factory_ice_distance_buffer: 0
        init_water_constant: true

LuxAI_S2-v0-sSqnet-j1024env16-80m-a100-close-ore-ice2:
  &lux-ssqnet-j1024env16-80m-a100-close-ore-ice2
  <<: *lux-ssqnet-j1024env16-80m-a100-close-ice-ore
  env_hyperparams: &lux-j1024env16-close-ore-ice2-env
    <<: *lux-j1024env16-close-ice-ore-env
    make_kwargs: &lux-j1024env16-close-ore-ice2-env-make-kwargs
      <<: *lux-j1024env16-close-ice-ore-env-make-kwargs
      factory_ore_distance_buffer: 0
      factory_ice_distance_buffer: 2
      init_water_constant: true
  eval_hyperparams: &lux-j1024env16-close-ore-ice2-eval
    <<: *lux-j1024env16-close-ice-ore-eval
    env_overrides: &lux-j1024env16-close-ore-ice2-eval-env-overrides
      <<: *lux-j1024env16-close-ice-ore-eval-env-overrides
      make_kwargs: &lux-j1024env16-close-ore-ice2-eval-env-overrides-make-kwargs
        <<: *lux-j1024env16-close-ice-ore-eval-env-overrides-make-kwargs
        factory_ore_distance_buffer: 0
        factory_ice_distance_buffer: 2
        init_water_constant: true

LuxAI_S2-v0-sSqnet-j1024env16-80m-close-ore-ice2:
  &lux-ssqnet-j1024env16-80m-close-ore-ice2
  <<: *lux-ssqnet-j1024env16-80m-a100-close-ore-ice2
  algo_hyperparams: &lux-ssqnet-j1024env16-80m-close-ore-ice2-algo
    <<: *lux-ssqnet-j1024env16-80m-a100-iwater150-algo
    batch_size: 4096

LuxAI_S2-v0-sSqnet-j1024env16-80m-coi2-heavy:
  &lux-ssqnet-j1024env16-80m-coi2-heavy
  <<: *lux-ssqnet-j1024env16-80m-close-ore-ice2
  algo_hyperparams: &lux-ssqnet-j1024env16-80m-coi2-heavy-algo
    <<: *lux-ssqnet-j1024env16-80m-close-ore-ice2-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0 # generation power
      - 0.1 # generation light bots
      - 0.2 # generation heavy bots
      - 0.1 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0 # resources water in factories
      - 0 # game length
    vf_coef:
      - 0.2 # WinLoss
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0.1 # generation power
      - 0.1 # generation light bots
      - 0.1 # generation heavy bots
      - 0.1 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0.1 # resources water in factories
      - 0.1 # game length

LuxAI_S2-v0-sSqnet-j1024env16-80m-coi2-2h-0lichen:
  &lux-ssqnet-j1024env16-80m-coi2-2h-0lichen
  <<: *lux-ssqnet-j1024env16-80m-coi2-heavy
  algo_hyperparams: &lux-ssqnet-j1024env16-80m-coi2-2h-0lichen-algo
    <<: *lux-ssqnet-j1024env16-80m-coi2-heavy-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0 # generation power
      - 0.1 # generation light bots
      - 0.2 # generation heavy bots
      - 0.1 # generation opponent kills
      - 0 # resources lichen
      - 0.1 # resources factory
      - 0 # resources water in factories
      - 0 # game length
    vf_coef:
      - 0.2 # WinLoss
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0.1 # generation power
      - 0.1 # generation light bots
      - 0.1 # generation heavy bots
      - 0.1 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0.1 # resources water in factories
      - 0.1 # game length

LuxAI_S2-v0-sSqnet-j1024env16-80m-coi2-2h-0l-hpt-tweak:
  &lux-ssqnet-j1024env16-80m-coi2-2h-0l-hpt-tweak
  <<: *lux-ssqnet-j1024env16-80m-coi2-2h-0lichen
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 5e-5
        ent_coef: 0.01
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.5
      - 0.4
      - 0.1
      - 0

LuxAI_S2-v0-sSqnet-j1024env16-80m-heavy-reward:
  &lux-ssqnet-j1024env16-80m-heavy-reward
  <<: *lux-ssqnet-j1024env16-80m-power-water-vf
  algo_hyperparams: &lux-ssqnet-j1024env16-80m-heavy-reward-algo
    <<: *lux-ssqnet-j1024env16-80m-power-water-vf-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0 # generation power
      - 0.08 # generation light bots
      - 0.12 # generation heavy bots
      - 0.1 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0 # resources water in factories
    vf_coef:
      - 0.2 # WinLoss
      - 0.1 # generation ice
      - 0.1 # generation ore
      - 0.1 # generation water
      - 0.1 # generation metal
      - 0.1 # generation power
      - 0.1 # generation light bots
      - 0.1 # generation heavy bots
      - 0.1 # generation opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0.1 # resources water in factories

LuxAI_S2-v0-sSqnet-j1024env16-80m-lr4: &lux-ssqnet-j1024env16-80m-lr4
  <<: *lux-ssqnet-j1024env16-80m-next-ice
  hyperparam_transitions_kwargs:
    <<: *lux-ssqnet-j1024env16-80m-faststart-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 4e-5
        ent_coef: 0.01
      - learning_rate: !!float 4e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.7
      - 0
      - 0.3
      - 0

LuxAI_S2-v0-sSqnet-j1024env16-120m: &lux-ssqnet-j1024env16-120m
  <<: *lux-ssqnet-j1024env16-80m-next-ice
  n_timesteps: !!float 120e6
  hyperparam_transitions_kwargs:
    &lux-ssqnet-j1024env16-120m-hyperparam-transitions
    <<: *lux-ssqnet-j1024env16-80m-faststart-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 5e-5
        ent_coef: 0.01
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.42
      - 0.33
      - 0.25
      - 0

LuxAI_S2-v0-sSqnet-j1024env16-240m: &lux-ssqnet-j1024env16-240m
  <<: *lux-ssqnet-j1024env16-120m
  n_timesteps: !!float 240e6

LuxAI_S2-v0-sSqnet-j1024env16-240m-a100-close-ore-ice2:
  &lux-ssqnet-j1024env16-240m-a100-close-ore-ice2
  <<: *lux-ssqnet-j1024env16-80m-a100-close-ore-ice2
  n_timesteps: !!float 240e6
  hyperparam_transitions_kwargs:
    <<: *lux-ssqnet-j1024env16-120m-hyperparam-transitions

LuxAI_S2-v0-sSqnet-j1024env32-80m: &lux-ssqnet-j1024env32-80m
  <<: *lux-ssqnet-j1024env16-80m-next-ice
  env_hyperparams: &lux-j1024env32-env
    <<: *lux-j1024env16-next-ice-env
    make_kwargs: &lux-j1024env32-env-make-kwargs
      <<: *lux-j1024env16-next-ice-env-make-kwargs
      map_size: 32
      MIN_FACTORIES: 2
      MAX_FACTORIES: 3
      USES_COMPACT_SPAWNS_MASK: true
  eval_hyperparams: &lux-j1024env32-eval
    <<: *lux-j1024env16-next-ice-eval
    env_overrides: &lux-j1024env32-eval-env-overrides
      <<: *lux-j1024env16-next-ice-eval-env-overrides
      make_kwargs: &lux-j1024env32-eval-env-overrides-make-kwargs
        <<: *lux-j1024env16-next-ice-eval-env-overrides-make-kwargs
        map_size: 32
        MIN_FACTORIES: 2
        MAX_FACTORIES: 3
        USES_COMPACT_SPAWNS_MASK: true
  algo_hyperparams: &lux-ssqnet-j1024env32-80m-algo
    <<: *lux-ssqnet-j1024env16-80m-322res-algo
    batch_size: 1024

LuxAI_S2-v0-sSqnet-j1024env32-80m-close-ore-ice2:
  &lux-ssqnet-j1024env32-80m-close-ore-ice2
  <<: *lux-ssqnet-j1024env16-80m-a100-close-ore-ice2
  env_hyperparams: &lux-j1024env32-close-ore-ice2-env
    <<: *lux-j1024env16-close-ore-ice2-env
    make_kwargs: &lux-j1024env32-close-ore-ice2-env-make-kwargs
      <<: *lux-j1024env16-close-ore-ice2-env-make-kwargs
      map_size: 32
      MIN_FACTORIES: 2
      MAX_FACTORIES: 3
      USES_COMPACT_SPAWNS_MASK: true
  eval_hyperparams: &lux-j1024env32-close-ore-ice2-eval
    <<: *lux-j1024env16-close-ore-ice2-eval
    env_overrides: &lux-j1024env32-close-ore-ice2-eval-env-overrides
      <<: *lux-j1024env16-close-ore-ice2-eval-env-overrides
      make_kwargs: &lux-j1024env32-close-ore-ice2-eval-env-overrides-make-kwargs
        <<: *lux-j1024env16-close-ore-ice2-eval-env-overrides-make-kwargs
        map_size: 32
        MIN_FACTORIES: 2
        MAX_FACTORIES: 3
        USES_COMPACT_SPAWNS_MASK: true
  hyperparam_transitions_kwargs:
    &lux-j1024env32-close-ore-ice2-hyperparam-transitions
    <<: *lux-ssqnet-j1024env16-120m-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 5e-5
        ent_coef: 0.01
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.5
      - 0.4
      - 0.1
      - 0
  algo_hyperparams: &lux-ssqnet-j1024env32-80m-close-ore-ice2-algo
    <<: *lux-ssqnet-j1024env16-80m-a100-iwater150-algo
    batch_size: 1024

LuxAI_S2-v0-sSqnet-j1024env48-80m-close-ore-ice2:
  &lux-ssqnet-j1024env48-80m-close-ore-ice2
  <<: *lux-ssqnet-j1024env32-80m-close-ore-ice2
  env_hyperparams: &lux-j1024env48-close-ore-ice2-env
    <<: *lux-j1024env32-close-ore-ice2-env
    make_kwargs: &lux-j1024env48-close-ore-ice2-env-make-kwargs
      <<: *lux-j1024env32-close-ore-ice2-env-make-kwargs
      map_size: 48
      MIN_FACTORIES: 2
      MAX_FACTORIES: 5
      USES_COMPACT_SPAWNS_MASK: true
  eval_hyperparams: &lux-j1024env48-close-ore-ice2-eval
    <<: *lux-j1024env32-close-ore-ice2-eval
    env_overrides: &lux-j1024env48-close-ore-ice2-eval-env-overrides
      <<: *lux-j1024env32-close-ore-ice2-eval-env-overrides
      make_kwargs: &lux-j1024env48-close-ore-ice2-eval-env-overrides-make-kwargs
        <<: *lux-j1024env32-close-ore-ice2-eval-env-overrides-make-kwargs
        map_size: 48
        MIN_FACTORIES: 2
        MAX_FACTORIES: 5
        USES_COMPACT_SPAWNS_MASK: true
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 5e-5
        ent_coef: 0.01
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.5
      - 0.4
      - 0.1
      - 0
  algo_hyperparams: &lux-ssqnet-j1024env48-80m-close-ore-ice2-algo
    <<: *lux-ssqnet-j1024env32-80m-close-ore-ice2-algo
    batch_size: 512

LuxAI_S2-v0-sSqnet-j512env64-80m-close-ore-ice2:
  &lux-ssqnet-j512env64-80m-close-ore-ice2
  <<: *lux-ssqnet-j1024env48-80m-close-ore-ice2
  env_hyperparams: &lux-j512env64-close-ore-ice2-env
    <<: *lux-j1024env48-close-ore-ice2-env
    n_envs: 512
    make_kwargs: &lux-j512env64-close-ore-ice2-env-make-kwargs
      <<: *lux-j1024env48-close-ore-ice2-env-make-kwargs
      map_size: 64
      MIN_FACTORIES: 4
      MAX_FACTORIES: 10
      USES_COMPACT_SPAWNS_MASK: true
      MAX_N_UNITS: 256
      MAX_GLOBAL_ID: 512
    play_checkpoints_kwargs:
      n_envs_against_checkpoints: 128
  eval_hyperparams: &lux-j512env64-close-ore-ice2-eval
    <<: *lux-j1024env48-close-ore-ice2-eval
    env_overrides: &lux-j512env64-close-ore-ice2-eval-env-overrides
      <<: *lux-j1024env48-close-ore-ice2-eval-env-overrides
      make_kwargs: &lux-j512env64-close-ore-ice2-eval-env-overrides-make-kwargs
        <<: *lux-j1024env48-close-ore-ice2-eval-env-overrides-make-kwargs
        map_size: 64
        MIN_FACTORIES: 4
        MAX_FACTORIES: 10
        USES_COMPACT_SPAWNS_MASK: true
        MAX_N_UNITS: 256
        MAX_GLOBAL_ID: 512
  rollout_hyperparams: &lux-j512env64-close-ore-ice2-rollout
    <<: *lux-ssqnet-j1024env16-r32-80m-rollout
    n_steps: 64
    num_envs_reset_every_rollout: 64
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 5e-5
        ent_coef: 0.01
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.5
      - 0.4
      - 0.1
      - 0
  algo_hyperparams: &lux-ssqnet-j512env64-80m-close-ore-ice2-algo
    <<: *lux-ssqnet-j1024env48-80m-close-ore-ice2-algo
    batch_size: 128

LuxAI_S2-v0-sSqnet-j1024env16-80m-a100-coi2-2h-0lichen:
  &lux-ssqnet-j1024env16-80m-a100-coi2-2h-0lichen
  <<: *lux-ssqnet-j1024env16-80m-coi2-2h-0lichen
  algo_hyperparams: &lux-ssqnet-j1024env16-80m-a100-coi2-2h-0lichen-algo
    <<: *lux-ssqnet-j1024env16-80m-coi2-2h-0lichen-algo
    batch_size: 8192

LuxAI_S2-v0-sSqnet-j1024env16-80m-coi2-2h-0l-retrain:
  &lux-ssqnet-j1024env16-80m-coi2-2h-0l-retrain
  <<: *lux-ssqnet-j1024env16-80m-coi2-2h-0lichen
  policy_hyperparams: &lux-ssqnet-j1024env16-80m-coi2-2h-0l-retrain-policy
    <<: *lux-ssqnet-j1024env16-80m-game-length-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/46euybin
    load_run_path_best: true

LuxAI_S2-v0-sSqnet-j1024env16-80m-a100-coi2-2h-0l-retrain:
  &lux-ssqnet-j1024env16-80m-a100-coi2-2h-0l-retrain
  <<: *lux-ssqnet-j1024env16-80m-coi2-2h-0l-retrain
  algo_hyperparams: &lux-ssqnet-j1024env16-80m-a100-coi2-2h-0l-retrain-algo
    <<: *lux-ssqnet-j1024env16-80m-a100-coi2-2h-0lichen-algo

LuxAI_S2-v0-sSqnet-j1024env32-80m-a100-coi2-2h0l-finetune:
  &lux-ssqnet-j1024env32-80m-a100-coi2-2h0l-finetune
  <<: *lux-ssqnet-j1024env16-80m-coi2-2h-0l-retrain
  env_hyperparams: &lux-j1024env32-coi2-2h0l-finetune-env
    <<: *lux-j1024env32-close-ore-ice2-env
  eval_hyperparams: &lux-j1024env32-coi2-2h0l-finetune-eval
    <<: *lux-j1024env32-close-ore-ice2-eval
  hyperparam_transitions_kwargs:
    <<: *lux-j1024env32-close-ore-ice2-hyperparam-transitions
  algo_hyperparams: &lux-ssqnet-j1024env32-80m-a100-coi2-2h0l-finetune-algo
    <<: *lux-ssqnet-j1024env16-80m-coi2-2h-0lichen-algo
    batch_size: 2048

LuxAI_S2-v0-sSqnet-j1024env16-80m-lwpickup: &lux-ssqnet-j1024env16-80m-lwpickup
  <<: *lux-ssqnet-j1024env16-80m-coi2-2h-0lichen
  env_hyperparams: &lux-j1024env16-lwpickup-env
    <<: *lux-j1024env16-close-ore-ice2-env
    make_kwargs: &lux-j1024env16-lwpickup-env-make-kwargs
      <<: *lux-j1024env16-close-ore-ice2-env-make-kwargs
      enable_light_water_pickup: true
  eval_hyperparams: &lux-j1024env16-lwpickup-eval
    <<: *lux-j1024env16-close-ore-ice2-eval
    env_overrides: &lux-j1024env16-lwpickup-eval-env-overrides
      <<: *lux-j1024env16-close-ore-ice2-eval-env-overrides
      make_kwargs: &lux-j1024env16-lwpickup-eval-env-overrides-make-kwargs
        <<: *lux-j1024env16-close-ore-ice2-eval-env-overrides-make-kwargs
        enable_light_water_pickup: true

LuxAI_S2-v0-sSqnet-j1024env16-80m-next-ice-ore:
  &lux-ssqnet-j1024env16-80m-next-ice-ore
  <<: *lux-ssqnet-j1024env16-80m-lwpickup
  env_hyperparams: &lux-j1024env16-next-ice-ore-env
    <<: *lux-j1024env16-lwpickup-env
    make_kwargs: &lux-j1024env16-next-ice-ore-env-make-kwargs
      <<: *lux-j1024env16-lwpickup-env-make-kwargs
      factory_ore_distance_buffer: 0
      factory_ice_distance_buffer: 0
      valid_spawns_mask_ore_ice_union: true
  eval_hyperparams: &lux-j1024env16-next-ice-ore-eval
    <<: *lux-j1024env16-lwpickup-eval
    env_overrides: &lux-j1024env16-next-ice-ore-eval-env-overrides
      <<: *lux-j1024env16-lwpickup-eval-env-overrides
      make_kwargs: &lux-j1024env16-next-ice-ore-eval-env-overrides-make-kwargs
        <<: *lux-j1024env16-lwpickup-eval-env-overrides-make-kwargs
        factory_ore_distance_buffer: 0
        factory_ice_distance_buffer: 0
        valid_spawns_mask_ore_ice_union: true

LuxAI_S2-v0-sSqnet-j1024env16-80m-power-diggers:
  &lux-ssqnet-j1024env16-80m-power-diggers
  <<: *lux-ssqnet-j1024env16-80m-next-ice-ore
  env_hyperparams: &lux-j1024env16-power-diggers-env
    <<: *lux-j1024env16-next-ice-ore-env
    make_kwargs: &lux-j1024env16-power-diggers-env-make-kwargs
      <<: *lux-j1024env16-next-ice-ore-env-make-kwargs
      enable_factory_to_digger_power_transfers: true
  eval_hyperparams: &lux-j1024env16-power-diggers-eval
    <<: *lux-j1024env16-next-ice-ore-eval
    env_overrides: &lux-j1024env16-power-diggers-eval-env-overrides
      <<: *lux-j1024env16-next-ice-ore-eval-env-overrides
      make_kwargs: &lux-j1024env16-power-diggers-eval-env-overrides-make-kwargs
        <<: *lux-j1024env16-next-ice-ore-eval-env-overrides-make-kwargs
        enable_factory_to_digger_power_transfers: true

LuxAI_S2-v0-j1024env16-80m-std-norm: &lux-j1024env16-80m-std-norm
  <<: *lux-ssqnet-j1024env16-80m-power-diggers
  algo_hyperparams: &lux-j1024env16-80m-std-norm-algo
    <<: *lux-ssqnet-j1024env16-80m-coi2-2h-0lichen-algo
    normalize_advantage: false
    standardize_advantage: true

LuxAI_S2-v0-j1024env16-80m-a100-std-norm: &lux-j1024env16-80m-a100-std-norm
  <<: *lux-j1024env16-80m-std-norm
  algo_hyperparams: &lux-j1024env16-80m-a100-std-norm-algo
    <<: *lux-j1024env16-80m-std-norm-algo
    batch_size: 8192

LuxAI_S2-v0-j1024env16-80m-std-norm-retrain:
  &lux-j1024env16-80m-std-norm-retrain
  <<: *lux-j1024env16-80m-std-norm
  policy_hyperparams: &lux-j1024env16-80m-std-norm-retrain-policy
    <<: *lux-ssqnet-j1024env16-80m-game-length-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/9e15d1ft
    load_run_path_best: false

LuxAI_S2-v0-j1024env16-80m-a100-retrain-only-winloss:
  &lux-j1024env16-80m-a100-std-norm-retrain-only-winloss
  <<: *lux-j1024env16-80m-std-norm-retrain
  algo_hyperparams: &lux-j1024env16-80m-a100-std-norm-retrain-only-winloss-algo
    <<: *lux-j1024env16-80m-a100-std-norm-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0 # generation ice
      - 0 # generation ore
      - 0 # generation water
      - 0 # generation metal
      - 0 # generation power
      - 0 # generation light bots
      - 0 # generation heavy bots
      - 0 # generation opponent kills
      - 0 # resources lichen
      - 0 # resources factory
      - 0 # resources water in factories
      - 0 # game length

LuxAI_S2-v0-j1024env32-80m-a100-std-norm-retrain:
  &lux-j1024env32-80m-a100-std-norm-retrain
  <<: *lux-j1024env16-80m-std-norm-retrain
  env_hyperparams: &lux-j1024env32-80m-a100-std-norm-retrain-env
    <<: *lux-j1024env16-power-diggers-env
    make_kwargs: &lux-j1024env32-80m-a100-std-norm-retrain-env-make-kwargs
      <<: *lux-j1024env16-power-diggers-env-make-kwargs
      map_size: 32
      MIN_FACTORIES: 2
      MAX_FACTORIES: 3
      USES_COMPACT_SPAWNS_MASK: false
  eval_hyperparams: &lux-j1024env32-80m-a100-std-norm-retrain-eval
    <<: *lux-j1024env16-power-diggers-eval
    env_overrides: &lux-j1024env32-80m-a100-std-norm-retrain-env-overrides
      <<: *lux-j1024env16-power-diggers-eval-env-overrides
      make_kwargs:
        &lux-j1024env32-80m-a100-std-norm-retrain-env-overrides-make-kwargs
        <<: *lux-j1024env16-power-diggers-eval-env-overrides-make-kwargs
        map_size: 32
        MIN_FACTORIES: 2
        MAX_FACTORIES: 3
        USES_COMPACT_SPAWNS_MASK: false
  hyperparam_transitions_kwargs:
    <<: *lux-j1024env32-close-ore-ice2-hyperparam-transitions
  algo_hyperparams: &lux-j1024env32-80m-a100-std-norm-retrain-algo
    <<: *lux-j1024env16-80m-a100-std-norm-algo
    batch_size: 2048

LuxAI_S2-v0-j1024env16-80m-stats-rewards: &lux-j1024env16-80m-stats-rewards
  <<: *lux-j1024env16-80m-std-norm
  env_hyperparams: &lux-j1024env16-80m-stats-rewards-env
    <<: *lux-j1024env16-power-diggers-env
    info_rewards: &lux-j1024env16-80m-stats-rewards-env-info-rewards
      info_paths:
        - [delta_stats, generation, ice] # 1
        - [delta_stats, generation, ore] # 2
        - [delta_stats, generation, water] # 3
        - [delta_stats, generation, metal] # 4
        - [delta_stats, generation, power] # 5
        - [delta_stats, generation, light_bots] # 6
        - [delta_stats, generation, heavy_bots] # 7
        - [delta_stats, generation, opponent_kills] # 8
        - [delta_stats, resources, lichen] # 9
        - [delta_stats, resources, factories] # 10
        - [delta_stats, real_env_steps] # 11
      episode_end: false
    normalize: true
    normalize_kwargs:
      norm_obs: false
      norm_reward: true
      gamma_reward: 1
      clip_reward: 10
  policy_hyperparams: &lux-j1024env16-80m-stats-rewards-policy
    <<: *lux-ssqnet-j1024env16-80m-game-length-policy
    output_activation_fn: identity
    additional_critic_activation_functions:
      - identity # generation ice
      - identity # generation ore
      - identity # generation water
      - identity # generation metal
      - identity # generation power
      - identity # generation light bots
      - identity # generation heavy bots
      - identity # generation opponent kills
      - identity # resources lichen
      - identity # resources factory
      - identity # game length
  algo_hyperparams: &lux-j1024env16-80m-stats-rewards-algo
    <<: *lux-j1024env16-80m-std-norm-algo
    normalize_advantage: true
    standardize_advantage: false
    gamma: 1.0
    gae_lambda: 0.95
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # ice
      - 0.1 # ore
      - 0.1 # water
      - 0.1 # metal
      - 0 # power
      - 0.1 # light bots
      - 0.1 # heavy bots
      - 0.1 # opponent kills
      - 0 # resources lichen
      - 0.1 # resources factory
      - 0 # game length
    vf_coef:
      - 0.2 # WinLoss
      - 0.1 # ice
      - 0.1 # ore
      - 0.1 # water
      - 0.1 # metal
      - 0.1 # power
      - 0.1 # light bots
      - 0.1 # heavy bots
      - 0.1 # opponent kills
      - 0.1 # end lichen
      - 0.1 # resources factory
      - 0.1 # game length

LuxAI_S2-v0-j1024env16-80m-warmup-norm: &lux-j1024env16-80m-warmup-norm
  <<: *lux-j1024env16-80m-stats-rewards
  hyperparam_transitions_kwargs:
    &lux-j1024env16-80m-warmup-norm-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
      - learning_rate: !!float 5e-5
        ent_coef: 0.01
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.002 # 160_000 steps
      - 0
      - 0.498
      - 0.4
      - 0.1
      - 0

LuxAI_S2-v0-j1024env16-80m-lr10start: &lux-j1024env16-80m-lr10start
  <<: *lux-j1024env16-80m-warmup-norm
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
      - learning_rate: !!float 1e-4
        ent_coef: 0.01
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.02 # 1_600_000 steps
      - 0
      - 0.48
      - 0.4
      - 0.1
      - 0

LuxAI_S2-v0-j1024env16-80m-a100-lr10start: &lux-j1024env16-80m-a100-lr10start
  <<: *lux-j1024env16-80m-lr10start
  algo_hyperparams: &lux-j1024env16-80m-a100-lr10start-algo
    <<: *lux-j1024env16-80m-stats-rewards-algo
    batch_size: 8192

LuxAI_S2-v0-j1024env16-80m-lr20start: &lux-j1024env16-80m-lr20start
  <<: *lux-j1024env16-80m-lr10start
  hyperparam_transitions_kwargs:
    &lux-j1024env16-80m-lr20start-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
      - learning_rate: !!float 2e-4
        ent_coef: 0.01
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.02 # 1_600_000 steps
      - 0
      - 0.48
      - 0.4
      - 0.1
      - 0

LuxAI_S2-v0-j1024env16-80m-a100-lr20start: &lux-j1024env16-80m-a100-lr20start
  <<: *lux-j1024env16-80m-lr20start
  algo_hyperparams: &lux-j1024env16-80m-a100-lr20start-algo
    <<: *lux-j1024env16-80m-stats-rewards-algo
    batch_size: 8192

LuxAI_S2-v0-j1024env16-80m-lr30start: &lux-j1024env16-80m-lr30start
  <<: *lux-j1024env16-80m-lr20start
  hyperparam_transitions_kwargs:
    <<: *lux-j1024env16-80m-lr20start-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
      - learning_rate: !!float 3e-4
        ent_coef: 0.01
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001

LuxAI_S2-v0-j1024env16-80m-lr40start: &lux-j1024env16-80m-lr40start
  <<: *lux-j1024env16-80m-a100-lr20start
  hyperparam_transitions_kwargs:
    <<: *lux-j1024env16-80m-lr20start-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
      - learning_rate: !!float 4e-4
        ent_coef: 0.01
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001

LuxAI_S2-v0-j1024env16-80m-a100-lr20-emv: &lux-j1024env16-80m-a100-lr20-emv
  <<: *lux-j1024env16-80m-a100-lr20start
  env_hyperparams: &lux-j1024env16-emv-env
    <<: *lux-j1024env16-80m-stats-rewards-env
    normalize_kwargs: &lux-j1024env16-emv-env-normalize-kwargs
      norm_obs: false
      norm_reward: true
      gamma_reward: 1
      clip_reward: 10
      exponential_moving_mean_var_reward: true
      emv_window_size: !!float 5e6
  hyperparam_transitions_kwargs:
    &lux-j1024env16-80m-a100-lr20-emv-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
      - learning_rate: !!float 2e-4
        ent_coef: 0.01
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.1 # 8M steps
      - 0
      - 0.4
      - 0.4
      - 0.1
      - 0

LuxAI_S2-v0-j1024env16-80m-lr20-emv: &lux-j1024env16-80m-lr20-emv
  <<: *lux-j1024env16-80m-a100-lr20-emv
  algo_hyperparams: &lux-j1024env16-80m-lr20-emv-algo
    <<: *lux-j1024env16-80m-stats-rewards-algo

LuxAI_S2-v0-j1024env16-80m-lr30-emv: &lux-j1024env16-80m-lr30-emv
  <<: *lux-j1024env16-80m-lr20-emv
  hyperparam_transitions_kwargs:
    &lux-j1024env16-80m-lr30-emv-hyperparam-transitions
    <<: *lux-j1024env16-80m-a100-lr20-emv-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
      - learning_rate: !!float 3e-4
        ent_coef: 0.01
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.05 # 4M steps
      - 0
      - 0.45
      - 0.4
      - 0.1
      - 0

LuxAI_S2-v0-j1024env16-80m-lr20-opp-resources:
  &lux-j1024env16-80m-lr20-opp-resources
  <<: *lux-j1024env16-80m-lr20-emv
  env_hyperparams: &lux-j1024env16-80m-lr20-opp-resources-env
    <<: *lux-j1024env16-emv-env
    info_rewards: &lux-j1024env16-80m-lr20-opp-resources-env-info-rewards
      info_paths:
        - [delta_stats, generation, ice] # 1
        - [delta_stats, generation, ore] # 2
        - [delta_stats, generation, water] # 3
        - [delta_stats, generation, metal] # 4
        - [delta_stats, generation, power] # 5
        - [delta_stats, generation, light_bots] # 6
        - [delta_stats, generation, heavy_bots] # 7
        - [delta_stats, generation, opponent_kills] # 8
        - [delta_stats, resources, lichen] # 9
        - [delta_stats, resources, factories] # 10
        - [delta_stats, real_env_steps] # 11
        - [delta_stats, resources, opponent_lichen] # 12
        - [delta_stats, resources, opponent_factories] # 13
      episode_end: false
  policy_hyperparams: &lux-j1024env16-80m-lr20-opp-resources-policy
    <<: *lux-j1024env16-80m-stats-rewards-policy
    additional_critic_activation_functions:
      - identity # generation ice
      - identity # generation ore
      - identity # generation water
      - identity # generation metal
      - identity # generation power
      - identity # generation light bots
      - identity # generation heavy bots
      - identity # generation opponent kills
      - identity # resources lichen
      - identity # resources factory
      - identity # game length
      - identity # opponent resources lichen
      - identity # opponent resources factory
  algo_hyperparams: &lux-j1024env16-80m-lr20-opp-resources-algo
    <<: *lux-j1024env16-80m-lr20-emv-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # ice
      - 0.1 # ore
      - 0.1 # water
      - 0.1 # metal
      - 0 # power
      - 0.1 # light bots
      - 0.1 # heavy bots
      - 0.1 # opponent kills
      - 0 # resources lichen
      - 0.1 # resources factory
      - 0 # game length
      - 0 # opponent resources lichen
      - 0 # opponent resources factory
    vf_coef:
      - 0.2 # WinLoss
      - 0.1 # ice
      - 0.1 # ore
      - 0.1 # water
      - 0.1 # metal
      - 0.1 # power
      - 0.1 # light bots
      - 0.1 # heavy bots
      - 0.1 # opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0.1 # game length
      - 0.1 # opponent resources lichen
      - 0.1 # opponent resources factory

LuxAI_S2-v0-j1024env16-80m-lr30-opp-resources:
  &lux-j1024env16-80m-lr30-opp-resources
  <<: *lux-j1024env16-80m-lr20-opp-resources
  hyperparam_transitions_kwargs:
    <<: *lux-j1024env16-80m-lr30-emv-hyperparam-transitions

LuxAI_S2-v0-j1024env16-80m-lr30-opp-resources-rms:
  &lux-j1024env16-80m-lr30-opp-resources-rms
  <<: *lux-j1024env16-80m-lr30-opp-resources
  env_hyperparams: &lux-j1024env16-80m-lr30-opp-resources-rms-env
    <<: *lux-j1024env16-80m-lr20-opp-resources-env
    normalize_kwargs: &lux-j1024env16-80m-lr30-opp-resources-rms-env-norm-kwargs
      norm_obs: false
      norm_reward: true
      gamma_reward: 1
      clip_reward: 10
      exponential_moving_mean_var_reward: false

LuxAI_S2-v0-j1024env32-80m-lr20-opp-resources:
  &lux-j1024env32-80m-lr20-opp-resources
  <<: *lux-j1024env16-80m-lr20-opp-resources
  env_hyperparams: &lux-j1024env32-opp-resources-env
    <<: *lux-j1024env16-80m-lr20-opp-resources-env
    make_kwargs: &lux-j1024env32-opp-resources-env-make-kwargs
      <<: *lux-j1024env32-80m-a100-std-norm-retrain-env-overrides-make-kwargs
  eval_hyperparams: &lux-j1024env32-opp-resources-eval
    <<: *lux-j1024env32-80m-a100-std-norm-retrain-eval
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
      - learning_rate: !!float 2e-4
        ent_coef: 0.01
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.05 # 4M steps
      - 0
      - 0.45
      - 0.4
      - 0.1
      - 0
  algo_hyperparams: &lux-j1024env32-80m-lr20-opp-resources-algo
    <<: *lux-j1024env16-80m-lr20-opp-resources-algo
    batch_size: 1024

LuxAI_S2-v0-j1024env32-80m-lr20-opp-resources-rms:
  &lux-j1024env32-80m-lr20-opp-resources-rms
  <<: *lux-j1024env32-80m-lr20-opp-resources
  env_hyperparams: &lux-j1024env32-80m-lr20-opp-resources-rms-env
    <<: *lux-j1024env32-opp-resources-env
    normalize_kwargs:
      <<: *lux-j1024env16-80m-lr30-opp-resources-rms-env-norm-kwargs

LuxAI_S2-v0-j512env64-80m-lr20-opp-resources:
  &lux-j512env64-80m-lr20-opp-resources
  <<: *lux-j1024env32-80m-lr20-opp-resources
  env_hyperparams: &lux-j512env64-opp-resources-env
    <<: *lux-j1024env32-opp-resources-env
    n_envs: 512
    make_kwargs: &lux-j512env64-opp-resources-env-make-kwargs
      <<: *lux-j1024env32-80m-a100-std-norm-retrain-env-make-kwargs
      map_size: 64
      MIN_FACTORIES: 4
      MAX_FACTORIES: 10
      USES_COMPACT_SPAWNS_MASK: false
      MAX_N_UNITS: 256
      MAX_GLOBAL_ID: 512
    play_checkpoints_kwargs:
      n_envs_against_checkpoints: 128
  eval_hyperparams: &lux-j512env64-opp-resources-eval
    <<: *lux-j1024env32-80m-a100-std-norm-retrain-eval
    env_overrides: &lux-j512env64-opp-resources-eval-env-overrides
      <<: *lux-j1024env32-80m-a100-std-norm-retrain-env-overrides
      n_envs: 64
      make_kwargs: &lux-j512env64-opp-resources-eval-env-overrides-make-kwargs
        <<: *lux-j1024env32-80m-a100-std-norm-retrain-env-overrides-make-kwargs
        map_size: 64
        MIN_FACTORIES: 4
        MAX_FACTORIES: 10
        USES_COMPACT_SPAWNS_MASK: false
        MAX_N_UNITS: 256
        MAX_GLOBAL_ID: 512
  rollout_hyperparams: &lux-j512env64-80m-lr20-opp-resources-rollout
    <<: *lux-j512env64-close-ore-ice2-rollout
  algo_hyperparams: &lux-j512env64-80m-lr20-opp-resources-algo
    <<: *lux-j1024env32-80m-lr20-opp-resources-algo
    batch_size: 128

LuxAI_S2-v0-j512env64-80m-a100-lr20-finetune:
  &lux-j512env64-80m-a100-lr20-finetune
  <<: *lux-j512env64-80m-lr20-opp-resources
  policy_hyperparams: &lux-j512env64-80m-a100-lr20-finetune-policy
    <<: *lux-j1024env16-80m-lr20-opp-resources-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/jk8u688d
    load_run_path_best: true
  algo_hyperparams: &lux-j512env64-80m-a100-lr20-finetune-algo
    <<: *lux-j1024env16-80m-lr20-opp-resources-algo
    batch_size: 512
  hyperparam_transitions_kwargs:
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.001
      - learning_rate: !!float 2e-4
        ent_coef: 0.001
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.05 # 4M steps
      - 0
      - 0.45
      - 0.4
      - 0.1
      - 0

LuxAI_S2-v0-j512env64-80m-lr20-finetune: &lux-j512env64-80m-lr20-finetune
  <<: *lux-j512env64-80m-a100-lr20-finetune
  env_hyperparams: &lux-j512env64-80m-lr20-finetune-env
    <<: *lux-j512env64-opp-resources-env
    make_kwargs: &lux-j512env64-80m-lr20-finetune-env-make-kwargs
      <<: *lux-j512env64-opp-resources-env-make-kwargs
      min_water_to_lichen: 300
  eval_hyperparams: &lux-j512env64-80m-lr20-finetune-eval
    <<: *lux-j512env64-opp-resources-eval
    env_overrides: &lux-j512env64-80m-lr20-finetune-eval-env-overrides
      <<: *lux-j512env64-opp-resources-eval-env-overrides
      make_kwargs:
        &lux-j512env64-80m-lr20-finetune-eval-env-overrides-make-kwargs
        <<: *lux-j512env64-opp-resources-eval-env-overrides-make-kwargs
        min_water_to_lichen: 300
  algo_hyperparams: &lux-j512env64-80m-lr20-finetune-algo
    <<: *lux-j512env64-80m-a100-lr20-finetune-algo
    batch_size: 128

LuxAI_S2-v0-j512env64-80m-a100-lr10-finetune:
  &lux-j512env64-80m-a100-lr10-finetune
  <<: *lux-j512env64-80m-a100-lr20-finetune
  hyperparam_transitions_kwargs:
    &lux-j512env64-80m-a100-lr10-finetune-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.001
      - learning_rate: !!float 1e-4
        ent_coef: 0.001
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.05 # 4M steps
      - 0
      - 0.45
      - 0.4
      - 0.1
      - 0

LuxAI_S2-v0-j512env64-80m-lr10-finetune32: &lux-j512env64-80m-lr10-finetune32
  <<: *lux-j512env64-80m-a100-lr10-finetune
  env_hyperparams: &lux-j512env64-80m-lr10-finetune32-env
    <<: *lux-j512env64-opp-resources-env
    make_kwargs: &lux-j512env64-80m-lr10-finetune32-env-make-kwargs
      <<: *lux-j512env64-opp-resources-env-make-kwargs
      min_water_to_lichen: 300
  eval_hyperparams: &lux-j512env64-80m-lr10-finetune32-eval
    <<: *lux-j512env64-opp-resources-eval
    env_overrides: &lux-j512env64-80m-lr10-finetune32-eval-env-overrides
      <<: *lux-j512env64-opp-resources-eval-env-overrides
      make_kwargs:
        &lux-j512env64-80m-lr10-finetune32-eval-env-overrides-make-kwargs
        <<: *lux-j512env64-opp-resources-eval-env-overrides-make-kwargs
        min_water_to_lichen: 300
  policy_hyperparams: &lux-j512env64-80m-lr10-finetune32-policy
    <<: *lux-j512env64-80m-a100-lr20-finetune-policy
    load_path: downloaded_models/ppo-LuxAI_S2-v0-j1024env32-80m-a100-lr20-finetune-S1
  algo_hyperparams: &lux-j512env64-80m-lr10-finetune32-algo
    <<: *lux-j512env64-80m-a100-lr20-finetune-algo
    batch_size: 128

LuxAI_S2-v0-j512env64-80m-a100-lr5-finetune:
  &lux-j512env64-80m-a100-lr5-finetune
  <<: *lux-j512env64-80m-a100-lr10-finetune
  hyperparam_transitions_kwargs:
    &lux-j512env64-80m-a100-lr5-finetune-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.001
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.05 # 4M steps
      - 0
      - 0.45
      - 0.4
      - 0.1
      - 0

LuxAI_S2-v0-j1024env32-80m-a100-lr20-finetune:
  &lux-j1024env32-80m-a100-lr20-finetune
  <<: *lux-j1024env32-80m-lr20-opp-resources
  policy_hyperparams: &lux-j1024env32-80m-a100-lr20-finetune-policy
    <<: *lux-j512env64-80m-a100-lr20-finetune-policy
  algo_hyperparams: &lux-j1024env32-80m-a100-lr20-finetune-algo
    <<: *lux-j1024env32-80m-lr20-opp-resources-algo
    batch_size: 2048
  hyperparam_transitions_kwargs:
    &lux-j1024env32-80m-a100-lr20-finetune-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.001
      - learning_rate: !!float 2e-4
        ent_coef: 0.001
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.05 # 4M steps
      - 0
      - 0.45
      - 0.4
      - 0.1
      - 0

LuxAI_S2-v0-j1024env32-80m-lr10-finetune: &lux-j1024env32-80m-lr10-finetune
  <<: *lux-j1024env32-80m-a100-lr20-finetune
  algo_hyperparams: &lux-j1024env32-80m-lr10-finetune-algo
    <<: *lux-j1024env32-80m-a100-lr20-finetune-algo
    batch_size: 1024
  hyperparam_transitions_kwargs:
    &lux-j1024env32-80m-lr10-finetune-hyperparam-transitions
    <<: *lux-j512env64-80m-a100-lr10-finetune-hyperparam-transitions

LuxAI_S2-v0-j1024env32-80m-lr10-finetune-rms:
  &lux-j1024env32-80m-lr10-finetune-rms
  <<: *lux-j1024env32-80m-lr10-finetune
  env_hyperparams: &lux-j1024env32-80m-lr10-finetune-rms-env
    <<: *lux-j1024env32-80m-lr20-opp-resources-rms-env
  policy_hyperparams: &lux-j1024env32-80m-lr10-finetune-rms-policy
    <<: *lux-j1024env32-80m-a100-lr20-finetune-policy
    load_norm_rms_count_override: !!float 1e6
  hyperparam_transitions_kwargs:
    <<: *lux-j1024env32-80m-lr10-finetune-hyperparam-transitions

LuxAI_S2-v0-j1024env32-80m-lr5-finetune: &lux-j1024env32-80m-lr5-finetune
  <<: *lux-j1024env32-80m-lr10-finetune
  hyperparam_transitions_kwargs:
    &lux-j1024env32-80m-lr5-finetune-hyperparam-transitions
    <<: *lux-j512env64-80m-a100-lr5-finetune-hyperparam-transitions

LuxAI_S2-v0-j1024env16-80m-lr20-finetune: &lux-j1024env16-80m-lr20-finetune
  <<: *lux-j1024env16-80m-lr20-opp-resources
  policy_hyperparams: &lux-j1024env16-80m-lr20-finetune-policy
    <<: *lux-j1024env16-80m-lr20-opp-resources-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/jk8u688d
    load_run_path_best: true
  hyperparam_transitions_kwargs:
    <<: *lux-j1024env32-80m-a100-lr20-finetune-hyperparam-transitions

LuxAI_S2-v0-j1024env16-80m-lr20-2heavy: &lux-j1024env16-80m-lr20-2heavy
  <<: *lux-j1024env16-80m-lr20-finetune
  algo_hyperparams: &lux-j1024env16-80m-lr20-2heavy-algo
    <<: *lux-j1024env16-80m-lr20-opp-resources-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # ice
      - 0.1 # ore
      - 0.1 # water
      - 0.1 # metal
      - 0 # power
      - 0.1 # light bots
      - 0.2 # heavy bots
      - 0.1 # opponent kills
      - 0 # resources lichen
      - 0.1 # resources factory
      - 0 # game length
      - 0 # opponent resources lichen
      - 0 # opponent resources factory
  hyperparam_transitions_kwargs:
    &lux-j1024env16-80m-lr20-2heavy-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.001
      - learning_rate: !!float 2e-4
        ent_coef: 0.001
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
    durations:
      - 0
      - 0.1 # 8M steps
      - 0.3 # 24M steps
      - 0.6 # 48M steps
      - 0

LuxAI_S2-v0-j1024env16-80m-lr20-4heavy: &lux-j1024env16-80m-lr20-4heavy
  <<: *lux-j1024env16-80m-lr20-2heavy
  algo_hyperparams: &lux-j1024env16-80m-lr20-4heavy-algo
    <<: *lux-j1024env16-80m-lr20-2heavy-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # ice
      - 0.1 # ore
      - 0.1 # water
      - 0.1 # metal
      - 0 # power
      - 0.1 # light bots
      - 0.4 # heavy bots
      - 0.1 # opponent kills
      - 0 # resources lichen
      - 0.1 # resources factory
      - 0 # game length
      - 0 # opponent resources lichen
      - 0 # opponent resources factory

LuxAI_S2-v0-j1024env16-80m-lr2-2building: &lux-j1024env16-80m-lr20-2building
  <<: *lux-j1024env16-80m-lr20-2heavy
  algo_hyperparams: &lux-j1024env16-80m-lr20-2building-algo
    <<: *lux-j1024env16-80m-lr20-2heavy-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # ice
      - 0.2 # ore
      - 0.1 # water
      - 0.2 # metal
      - 0 # power
      - 0.2 # light bots
      - 0.2 # heavy bots
      - 0.2 # opponent kills
      - 0 # resources lichen
      - 0.1 # resources factory
      - 0 # game length
      - 0 # opponent resources lichen
      - 0 # opponent resources factory

LuxAI_S2-v0-j1024env16-80m-lr20-4mhk: &lux-j1024env16-80m-lr20-4mhk
  <<: *lux-j1024env16-80m-lr20-2heavy
  algo_hyperparams: &lux-j1024env16-80m-lr20-4mhk-algo
    <<: *lux-j1024env16-80m-lr20-2heavy-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # ice
      - 0.1 # ore
      - 0.1 # water
      - 0.4 # metal
      - 0 # power
      - 0.1 # light bots
      - 0.4 # heavy bots
      - 0.4 # opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0 # game length
      - 0 # opponent resources lichen
      - 0 # opponent resources factory

LuxAI_S2-v0-j1024env32-80m-lr20-2building: &lux-j1024env32-80m-lr20-2building
  <<: *lux-j1024env32-80m-lr10-finetune
  policy_hyperparams: &lux-j1024env32-80m-lr20-2building-policy
    <<: *lux-j1024env16-80m-lr20-finetune-policy
  algo_hyperparams: &lux-j1024env32-80m-lr20-2building-algo
    <<: *lux-j1024env16-80m-lr20-2building-algo
    batch_size: 1024
  hyperparam_transitions_kwargs:
    <<: *lux-j1024env16-80m-lr20-2heavy-hyperparam-transitions

LuxAI_S2-v0-j1024env32-80m-lr20-2heavy: &lux-j1024env32-80m-lr20-2heavy
  <<: *lux-j1024env32-80m-lr20-2building
  policy_hyperparams: &lux-j1024env32-80m-lr20-2heavy-policy
    <<: *lux-j1024env32-80m-lr20-2building-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/qw8efbmg
    load_run_path_best: true
  algo_hyperparams: &lux-j1024env32-80m-lr20-2heavy-algo
    <<: *lux-j1024env16-80m-lr20-2heavy-algo
    batch_size: 1024
  hyperparam_transitions_kwargs:
    &lux-j1024env32-80m-lr20-2heavy-hyperparam-transitions
    <<: *lux-j1024env16-80m-lr20-2heavy-hyperparam-transitions

LuxAI_S2-v0-j1024env32-80m-lr10-2building: &lux-j1024env32-80m-lr10-2building
  <<: *lux-j1024env32-80m-lr20-2heavy
  algo_hyperparams: &lux-j1024env32-80m-lr10-2building-algo
    <<: *lux-j1024env32-80m-lr20-2building-algo
  hyperparam_transitions_kwargs:
    &lux-j1024env32-80m-lr10-2building-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.001
      - learning_rate: !!float 1e-4
        ent_coef: 0.001
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
    durations:
      - 0
      - 0.1 # 8M steps
      - 0.3 # 24M steps
      - 0.6 # 48M steps
      - 0

LuxAI_S2-v0-j512env64-80m-lr10-2heavy: &lux-j512env64-80m-lr10-2heavy
  <<: *lux-j512env64-80m-a100-lr10-finetune
  policy_hyperparams: &lux-j512env64-80m-lr10-2heavy-policy
    <<: *lux-j1024env32-80m-lr20-2heavy-policy
  algo_hyperparams: &lux-j512env64-80m-lr10-2heavy-algo
    <<: *lux-j1024env32-80m-lr20-2heavy-algo
    batch_size: 128
  hyperparam_transitions_kwargs:
    &lux-j512env64-80m-lr10-2heavy-hyperparam-transitions
    <<: *lux-j1024env32-80m-lr10-2building-hyperparam-transitions

LuxAI_S2-v0-j512env64-80m-lr10-2building: &lux-j512env64-80m-lr10-2building
  <<: *lux-j512env64-80m-lr10-2heavy
  algo_hyperparams: &lux-j512env64-80m-lr10-2building-algo
    <<: *lux-j1024env32-80m-lr10-2building-algo
    batch_size: 128
  hyperparam_transitions_kwargs:
    &lux-j512env64-80m-lr10-2building-hyperparam-transitions
    <<: *lux-j1024env32-80m-lr10-2building-hyperparam-transitions

LuxAI_S2-v0-j512env64-80m-lr10-ft32-2building:
  &lux-j512env64-80m-lr10-ft32-2building
  <<: *lux-j512env64-80m-lr10-2building
  policy_hyperparams: &lux-j512env64-80m-lr10-ft32-2building-policy
    <<: *lux-j512env64-80m-lr10-2heavy-policy
    load_run_path: null
    load_path: downloaded_models/ppo-LuxAI_S2-v0-j1024env32-80m-lr20-2building-S1-best
  hyperparam_transitions_kwargs:
    &lux-j512env64-80m-lr10-ft32-2building-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
      - learning_rate: !!float 1e-4
        ent_coef: 0.001
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
    durations:
      - 0
      - 0.1 # 8M steps
      - 0.3 # 24M steps
      - 0.6 # 48M steps
      - 0

LuxAI_S2-v0-j512env64-80m-lr5-ft32-2building:
  &lux-j512env64-80m-lr5-ft32-2building
  <<: *lux-j512env64-80m-lr10-ft32-2building
  hyperparam_transitions_kwargs:
    &lux-j512env64-80m-lr5-ft32-2building-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
    durations:
      - 0
      - 0.1 # 8M steps
      - 0.3 # 24M steps
      - 0.6 # 48M steps
      - 0

LuxAI_S2-v0-j512env64-80m-lr5-ft32-2o3m4h: &lux-j512env64-80m-lr5-ft32-2o3m4h
  <<: *lux-j512env64-80m-lr5-ft32-2building
  algo_hyperparams: &lux-j512env64-80m-lr5-ft32-2o3m4h-algo
    <<: *lux-j512env64-80m-lr10-2building-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # ice
      - 0.2 # ore
      - 0.1 # water
      - 0.3 # metal
      - 0 # power
      - 0.1 # light bots
      - 0.4 # heavy bots
      - 0.1 # opponent kills
      - 0 # resources lichen
      - 0.1 # resources factory
      - 0 # game length
      - 0 # opponent resources lichen
      - 0 # opponent resources factory

LuxAI_S2-v0-j512env64-80m-a100-lr10-ft32-2building:
  &lux-j512env64-80m-a100-lr10-ft32-2building
  <<: *lux-j512env64-80m-lr10-ft32-2building
  algo_hyperparams: &lux-j512env64-80m-a100-lr10-ft32-2building-algo
    <<: *lux-j512env64-80m-lr10-2building-algo
    batch_size: 512

LuxAI_S2-v0-j512env64-80m-a100-lr5-ft32-2heavy:
  &lux-j512env64-80m-a100-lr5-ft32-2heavy
  <<: *lux-j512env64-80m-a100-lr10-ft32-2building
  algo_hyperparams: &lux-j512env64-80m-a100-lr5-ft32-2heavy-algo
    <<: *lux-j512env64-80m-lr10-2heavy-algo
    batch_size: 512
  hyperparam_transitions_kwargs:
    <<: *lux-j512env64-80m-lr5-ft32-2building-hyperparam-transitions

LuxAI_S2-v0-j1024env32-80m-lr10-2o3m4h: &lux-j1024env32-80m-lr10-2o3m4h
  <<: *lux-j1024env32-80m-lr10-2building
  policy_hyperparams: &lux-j1024env32-80m-lr10-2o3m4h-policy
    <<: *lux-j1024env32-80m-lr20-2heavy-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/eld8d3ct
    load_run_path_best: true
  algo_hyperparams: &lux-j1024env32-80m-lr10-2o3m4h-algo
    <<: *lux-j1024env32-80m-lr10-2building-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # ice
      - 0.2 # ore
      - 0.1 # water
      - 0.3 # metal
      - 0 # power
      - 0.1 # light bots
      - 0.4 # heavy bots
      - 0.1 # opponent kills
      - 0 # resources lichen
      - 0.1 # resources factory
      - 0 # game length
      - 0 # opponent resources lichen
      - 0 # opponent resources factory
  hyperparam_transitions_kwargs:
    &lux-j1024env32-80m-lr10-2o3m4h-hyperparam-transitions
    <<: *lux-j512env64-80m-lr10-ft32-2building-hyperparam-transitions

LuxAI_S2-v0-j1024env32-80m-lr5-2o3m4h: &lux-j1024env32-80m-lr5-2o3m4h
  <<: *lux-j1024env32-80m-lr10-2o3m4h
  hyperparam_transitions_kwargs:
    <<: *lux-j512env64-80m-lr5-ft32-2building-hyperparam-transitions

LuxAI_S2-v0-j1024env32-80m-lr10-rolling-reset:
  &lux-j1024env32-80m-lr10-rolling-reset
  <<: *lux-j1024env32-80m-lr10-2o3m4h
  rollout_hyperparams: &lux-j1024env32-80m-lr10-rolling-reset-rollout
    <<: *lux-ssqnet-j1024env16-r32-80m-rollout
    n_steps: 32
    num_envs_reset_every_rollout: 0
    rolling_num_envs_reset_every_rollout: 4
  hyperparam_transitions_kwargs:
    &lux-j1024env32-80m-lr10-rolling-reset-hyperparam-transitions
    interpolate_method: cosine
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 32
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 1e-4
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
        rolling_num_envs_reset_every_rollout: 4
    durations:
      - 0.0125 # reset 32 envs every rollout, 1M steps
      - 0
      - 0 # reset 4 envs every rollout
      - 0.0875 # lr 1e-7 -> 1e-4, 7M steps
      - 0.3 # lr 1e-4, 24M steps
      - 0.6 # lr 1e-4 -> 1e-7. 48M steps
      - 0

LuxAI_S2-v0-j1024env32-80m-lr20-r16-rr2: &lux-j1024env32-80m-lr20-r16-rr2
  <<: *lux-j1024env32-80m-lr10-rolling-reset
  rollout_hyperparams: &lux-j1024env32-80m-lr20-r16-rr2-rollout
    <<: *lux-j1024env32-80m-lr10-rolling-reset-rollout
    n_steps: 16
    rolling_num_envs_reset_every_rollout: 2
  hyperparam_transitions_kwargs:
    &lux-j1024env32-80m-lr20-r16-rr2-hyperparam-transitions
    <<: *lux-j1024env32-80m-lr10-rolling-reset-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 16
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 2
      - learning_rate: !!float 2e-4
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 2
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
        rolling_num_envs_reset_every_rollout: 2

LuxAI_S2-v0-j512env64-80m-lr20-r32-rr4: &lux-j512env64-80m-lr20-r32-rr4
  <<: *lux-j512env64-80m-lr5-ft32-2o3m4h
  policy_hyperparams: &lux-j512env64-80m-lr20-r32-rr4-policy
    <<: *lux-j512env64-80m-lr10-ft32-2building-policy
    load_run_path: null
    load_path: downloaded_models/ppo-LuxAI_S2-v0-j512env64-80m-lr5-ft32-2o3m4h-S1-best
  rollout_hyperparams: &lux-j512env64-80m-lr20-r32-rr4-rollout
    <<: *lux-j512env64-close-ore-ice2-rollout
    n_steps: 32
    num_envs_reset_every_rollout: 0
    rolling_num_envs_reset_every_rollout: 4
  hyperparam_transitions_kwargs:
    &lux-j512env64-80m-lr20-r32-rr4-hyperparam-transitions
    <<: *lux-j1024env32-80m-lr10-rolling-reset-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 32
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 2e-4
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
        rolling_num_envs_reset_every_rollout: 4

LuxAI_S2-v0-j512env64-80m-lr10-r32-rr4: &lux-j512env64-80m-lr10-r32-rr4
  <<: *lux-j512env64-80m-lr20-r32-rr4
  policy_hyperparams: &lux-j512env64-80m-lr10-r32-rr4-policy
    <<: *lux-j512env64-80m-lr20-r32-rr4-policy
    load_run_path: null
    load_path: downloaded_models/ppo-LuxAI_S2-v0-j512env64-80m-lr5-ft32-2o3m4h-S1-best
  hyperparam_transitions_kwargs:
    &lux-j512env64-80m-lr10-r32-rr4-hyperparam-transitions
    <<: *lux-j512env64-80m-lr20-r32-rr4-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 32
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 1e-4
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
        rolling_num_envs_reset_every_rollout: 4

LuxAI_S2-v0-j512env64-80m-lr20-r16-rr2: &lux-j512env64-80m-lr20-r16-rr2
  <<: *lux-j512env64-80m-lr20-r32-rr4
  rollout_hyperparams: &lux-j512env64-80m-lr20-r16-rr2-rollout
    <<: *lux-j512env64-80m-lr20-r32-rr4-rollout
    n_steps: 16
    rolling_num_envs_reset_every_rollout: 2
  hyperparam_transitions_kwargs:
    &lux-j512env64-80m-lr20-r16-rr2-hyperparam-transitions
    <<: *lux-j512env64-80m-lr20-r32-rr4-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 16
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 2
      - learning_rate: !!float 2e-4
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 2
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
        rolling_num_envs_reset_every_rollout: 2

LuxAI_S2-v0-j512env64-80m-lr20-r32-rr4-a100:
  &lux-j512env64-80m-lr20-r32-rr4-a100
  <<: *lux-j512env64-80m-lr20-r32-rr4
  algo_hyperparams: &lux-j512env64-80m-lr20-r32-rr4-a100-algo
    <<: *lux-j512env64-80m-lr5-ft32-2o3m4h-algo
    batch_size: 512

LuxAI_S2-v0-j512env64-80m-lr20-r16-rr2-a100:
  &lux-j512env64-80m-lr20-r16-rr2-a100
  <<: *lux-j512env64-80m-lr20-r16-rr2
  algo_hyperparams: &lux-j512env64-80m-lr20-r16-rr2-a100-algo
    <<: *lux-j512env64-80m-lr5-ft32-2o3m4h-algo
    batch_size: 512

LuxAI_S2-v0-j512env64-80m-lr10-r16-rr2-a100:
  &lux-j512env64-80m-lr10-r16-rr2-a100
  <<: *lux-j512env64-80m-lr20-r16-rr2-a100
  policy_hyperparams: &lux-j512env64-80m-lr10-r16-rr2-a100-policy
    <<: *lux-j512env64-80m-lr20-r32-rr4-policy
    load_run_path: null
    load_path: downloaded_models/ppo-LuxAI_S2-v0-j512env64-80m-lr5-ft32-2o3m4h-S1-best
  hyperparam_transitions_kwargs:
    &lux-j512env64-80m-lr10-r16-rr2-a100-hyperparam-transitions
    <<: *lux-j512env64-80m-lr20-r16-rr2-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 16
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 2
      - learning_rate: !!float 1e-4
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 2
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
        rolling_num_envs_reset_every_rollout: 2

LuxAI_S2-v0-j512env64-80m-lr5-r16-rr2-a100: &lux-j512env64-80m-lr5-r16-rr2-a100
  <<: *lux-j512env64-80m-lr10-r16-rr2-a100
  hyperparam_transitions_kwargs:
    &lux-j512env64-80m-lr5-r16-rr2-a100-hyperparam-transitions
    <<: *lux-j512env64-80m-lr10-r16-rr2-a100-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 16
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 2
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 2
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
        rolling_num_envs_reset_every_rollout: 2

LuxAI_S2-v0-j1024env32-80m-lr10-r16-rr2: &lux-j1024env32-80m-lr10-r16-rr2
  <<: *lux-j1024env32-80m-lr20-r16-rr2
  hyperparam_transitions_kwargs:
    &lux-j1024env32-80m-lr10-r16-rr2-hyperparam-transitions
    <<: *lux-j1024env32-80m-lr20-r16-rr2-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 16
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 2
      - learning_rate: !!float 1e-4
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 2
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
        rolling_num_envs_reset_every_rollout: 2

LuxAI_S2-v0-j1024env32-80m-lr10-r32-rr4: &lux-j1024env32-80m-lr10-r32-rr4
  <<: *lux-j1024env32-80m-lr10-r16-rr2
  policy_hyperparams: &lux-j1024env32-80m-lr10-r32-rr4-policy
    <<: *lux-j1024env32-80m-lr10-2o3m4h-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/1mr4mafh
    load_run_path_best: true
  rollout_hyperparams: &lux-j1024env32-80m-lr10-r32-rr4-rollout
    <<: *lux-j1024env32-80m-lr20-r16-rr2-rollout
    n_steps: 32
    rolling_num_envs_reset_every_rollout: 0
    random_num_envs_reset_every_rollout: 4
  hyperparam_transitions_kwargs:
    &lux-j1024env32-80m-lr10-r32-rr4-hyperparam-transitions
    <<: *lux-j1024env32-80m-lr10-r16-rr2-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 1e-4
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4

LuxAI_S2-v0-j512env64-80m-lr5-r64-rr4: &lux-j512env64-80m-lr5-r64-rr4
  <<: *lux-j512env64-80m-lr10-r32-rr4
  policy_hyperparams: &lux-j512env64-80m-lr5-r64-rr4-policy
    <<: *lux-j512env64-80m-lr10-r32-rr4-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/1mr4mafh
    load_run_path_best: true
    load_path: null
  rollout_hyperparams: &lux-j512env64-80m-lr5-r64-rr4-rollout
    <<: *lux-j512env64-80m-lr20-r32-rr4-rollout
    n_steps: 64
    rolling_num_envs_reset_every_rollout: 0
    random_num_envs_reset_every_rollout: 4
  hyperparam_transitions_kwargs:
    &lux-j512env64-80m-lr5-r64-rr4-hyperparam-transitions
    <<: *lux-j512env64-80m-lr10-r32-rr4-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 64
        random_num_envs_reset_every_rollout: 0
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4

LuxAI_S2-v0-j1024env64-80m-lr5-r32-rr4-a100:
  &lux-j1024env64-80m-lr5-r32-rr4-a100
  <<: *lux-j512env64-80m-lr5-r64-rr4
  env_hyperparams: &lux-j1024env64-a100-env
    <<: *lux-j512env64-opp-resources-env
    n_envs: 1024
    make_kwargs: &lux-j1024env64-a100-env-make-kwargs
      <<: *lux-j512env64-opp-resources-env-make-kwargs
    play_checkpoints_kwargs:
      n_envs_against_checkpoints: 256
  eval_hyperparams: &lux-j1024env64-a100-eval
    <<: *lux-j512env64-opp-resources-eval
    env_overrides: &lux-j1024env64-a100-eval-env-overrides
      <<: *lux-j512env64-opp-resources-eval-env-overrides
      n_envs: 128
      make_kwargs: &lux-j1024env64-a100-eval-env-overrides-make-kwargs
        <<: *lux-j512env64-opp-resources-eval-env-overrides-make-kwargs
  rollout_hyperparams: &lux-j1024env64-80m-lr5-r32-rr4-a100-rollout
    <<: *lux-j512env64-80m-lr5-r64-rr4-rollout
    n_steps: 32
  hyperparam_transitions_kwargs:
    &lux-j1024env64-80m-lr5-r32-rr4-a100-hyperparam-transitions
    <<: *lux-j512env64-80m-lr5-r64-rr4-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
  algo_hyperparams: &lux-j1024env64-80m-lr5-r32-rr4-a100-algo
    <<: *lux-j512env64-80m-lr20-r32-rr4-a100-algo

LuxAI_S2-v0-j1024env64-80m-lr10-r32-rr4-a100:
  &lux-j1024env64-80m-lr10-r32-rr4-a100
  <<: *lux-j1024env64-80m-lr5-r32-rr4-a100
  hyperparam_transitions_kwargs:
    &lux-j1024env64-80m-lr10-r32-rr4-a100-hyperparam-transitions
    <<: *lux-j1024env64-80m-lr5-r32-rr4-a100-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 1e-4
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4

LuxAI_S2-v0-j1024env64-80m-lr2-r32-rr4-a100:
  &lux-j1024env64-80m-lr2-r32-rr4-a100
  <<: *lux-j1024env64-80m-lr10-r32-rr4-a100
  hyperparam_transitions_kwargs:
    &lux-j1024env64-80m-lr2-r32-rr4-a100-hyperparam-transitions
    <<: *lux-j1024env64-80m-lr10-r32-rr4-a100-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
      - learning_rate: !!float 1e-7
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 2e-5
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4

LuxAI_S2-v0-j1024env32-80m-lr5-r32-rr4: &lux-j1024env32-80m-lr5-r32-rr4
  <<: *lux-j1024env32-80m-lr10-r32-rr4
  hyperparam_transitions_kwargs:
    &lux-j1024env32-80m-lr5-r32-rr4-hyperparam-transitions
    <<: *lux-j1024env32-80m-lr10-r32-rr4-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 5e-5
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4

LuxAI_S2-v0-j1024env32-80m-lr2-r32-rr4: &lux-j1024env32-80m-lr2-r32-rr4
  <<: *lux-j1024env32-80m-lr5-r32-rr4
  hyperparam_transitions_kwargs:
    &lux-j1024env32-80m-lr2-r32-rr4-hyperparam-transitions
    <<: *lux-j1024env32-80m-lr5-r32-rr4-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 2e-5
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4

LuxAI_S2-v0-j1024env64-80m-lr1-r32-rr4-a100:
  &lux-j1024env64-80m-lr1-r32-rr4-a100
  <<: *lux-j1024env64-80m-lr2-r32-rr4-a100
  hyperparam_transitions_kwargs:
    &lux-j1024env64-80m-lr1-r32-rr4-a100-hyperparam-transitions
    <<: *lux-j1024env64-80m-lr2-r32-rr4-a100-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
      - learning_rate: !!float 1e-7
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 1e-5
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4

LuxAI_S2-v0-j1024env64-80m-lr05-r32-rr4-a100:
  &lux-j1024env64-80m-lr05-r32-rr4-a100
  <<: *lux-j1024env64-80m-lr1-r32-rr4-a100
  hyperparam_transitions_kwargs:
    &lux-j1024env64-80m-lr05-r32-rr4-a100-hyperparam-transitions
    <<: *lux-j1024env64-80m-lr1-r32-rr4-a100-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
      - learning_rate: !!float 1e-7
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 5e-6
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 1e-7
        ent_coef: 0.00001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4

LuxAI_S2-v0-j1024env16-80m-lr20-r32-rr4: &lux-j1024env16-80m-lr20-r32-rr4
  <<: *lux-j1024env64-80m-lr05-r32-rr4-a100
  env_hyperparams: &lux-j1024env16-env
    <<: *lux-j1024env16-80m-lr20-opp-resources-env
  eval_hyperparams: &lux-j1024env16-eval
    <<: *lux-j1024env16-power-diggers-eval
  policy_hyperparams: &lux-j1024env16-80m-lr20-r32-rr4-policy
    <<: *lux-j512env64-80m-lr5-r64-rr4-policy
    load_run_path: null
  algo_hyperparams: &lux-j1024env16-80m-lr20-r32-rr4-algo
    <<: *lux-j1024env64-80m-lr5-r32-rr4-a100-algo
    batch_size: 4096
  hyperparam_transitions_kwargs:
    &lux-j1024env16-80m-lr20-r32-rr4-hyperparam-transitions
    <<: *lux-j1024env64-80m-lr05-r32-rr4-a100-hyperparam-transitions
    phases:
      - learning_rate: !!float 1e-7
        ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
      - learning_rate: !!float 2e-4
        ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - learning_rate: !!float 1e-6
        ent_coef: 0.0001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
    durations:
      - 0.0125 # reset 32 envs every rollout, 1M steps
      - 0
      - 0.1 # reset 4 envs every rollout, 16M steps
      - 0.8875 # lr 2e-4 -> 1e-6, 63M steps
      - 0

LuxAI_S2-v0-j1024env16-80m-lr20-clip-vf: &lux-j1024env16-80m-lr20-clip-vf
  <<: *lux-j1024env16-80m-lr20-r32-rr4
  algo_hyperparams: &lux-j1024env16-80m-lr20-clip-vf-algo
    <<: *lux-j1024env16-80m-lr20-r32-rr4-algo
    clip_range_vf: 0.2

LuxAI_S2-v0-j1024env16-80m-lr-by-kl: &lux-j1024env16-80m-lr-by-kl
  <<: *lux-j1024env16-80m-lr20-r32-rr4
  algo_hyperparams: &lux-j1024env16-80m-lr-by-kl-algo
    <<: *lux-j1024env16-80m-lr20-r32-rr4-algo
    learning_rate: !!float 1e-6
  lr_by_kl_kwargs: &lux-j1024env16-80m-lr-by-kl-lr-by-kl-kwargs
    target_kl: 0.01
  hyperparam_transitions_kwargs:
    &lux-j1024env16-80m-lr-by-kl-hyperparam-transitions
    <<: *lux-j1024env16-80m-lr20-r32-rr4-hyperparam-transitions
    phases:
      - ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
      - ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
      - ent_coef: 0.0001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
    durations:
      - 0.0125 # reset 32 envs every rollout, 1M steps
      - 0
      - 0.4875 # reset 4 envs every rollout, 39M steps
      - 0.5 # ent_coef 0.001 -> 0.0001, 40M steps
      - 0

LuxAI_S2-v0-j1024env16-80m-lr20-huber: &lux-j1024env16-80m-lr20-huber
  <<: *lux-j1024env16-80m-lr20-r32-rr4
  algo_hyperparams: &lux-j1024env16-80m-lr20-huber-algo
    <<: *lux-j1024env16-80m-lr20-r32-rr4-algo
    vf_loss_fn: huber_loss

LuxAI_S2-v0-j1024env16-80m-lr-by-kl-huber-clipvf05:
  &lux-j1024env16-80m-lr-by-kl-huber-clipvf05
  <<: *lux-j1024env16-80m-lr-by-kl
  algo_hyperparams: &lux-j1024env16-80m-lr-by-kl-huber-clipvf05-algo
    <<: *lux-j1024env16-80m-lr-by-kl-algo
    vf_loss_fn: huber_loss
    clip_range_vf: 0.5
  lr_by_kl_kwargs: &lux-j1024env16-80m-lr-by-kl-huber-clipvf05-lr-by-kl-kwargs
    <<: *lux-j1024env16-80m-lr-by-kl-lr-by-kl-kwargs
    max_increase_fraction: 1.05

LuxAI_S2-v0-j1024env16-80m-lr-by-kl-huber: &lux-j1024env16-80m-lr-by-kl-huber
  <<: *lux-j1024env16-80m-lr-by-kl-huber-clipvf05
  algo_hyperparams: &lux-j1024env16-80m-lr-by-kl-huber-algo
    <<: *lux-j1024env16-80m-lr-by-kl-huber-clipvf05-algo
    clip_range_vf: null

LuxAI_S2-v0-j1024env16-80m-decay-lrkl: &lux-j1024env16-80m-decay-lrkl
  <<: *lux-j1024env16-80m-lr-by-kl-huber
  hyperparam_transitions_kwargs:
    &lux-j1024env16-80m-decay-lrkl-hyperparam-transitions
    <<: *lux-j1024env16-80m-lr-by-kl-hyperparam-transitions
    phases:
      - ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
        target_kl: 0.01
      - ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
        target_kl: 0.01
      - ent_coef: 0.0001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
        target_kl: 0.001
    durations:
      - 0.0125 # reset 32 envs every rollout, 1M steps
      - 0
      - 0.7875 # reset 4 envs every rollout, 63M steps
      - 0.2 # ent_coef 0.001 -> 0.0001, target_kl 0.01 -> 0.001, 16M steps
      - 0

LuxAI_S2-v0-j1024env16-80m-decay-lrkl-a100: &lux-j1024env16-80m-decay-lrkl-a100
  <<: *lux-j1024env16-80m-decay-lrkl
  algo_hyperparams: &lux-j1024env16-80m-decay-lrkl-a100-algo
    <<: *lux-j1024env16-80m-lr-by-kl-huber-algo
    batch_size: 8192

LuxAI_S2-v0-j1024env32-80m-decay-lrkl-a100: &lux-j1024env32-80m-decay-lrkl-a100
  <<: *lux-j1024env16-80m-decay-lrkl-a100
  env_hyperparams: &lux-j1024env32-80m-decay-lrkl-a100-env
    <<: *lux-j1024env32-opp-resources-env
  eval_hyperparams: &lux-j1024env32-80m-decay-lrkl-a100-eval
    <<: *lux-j1024env32-opp-resources-eval
  algo_hyperparams: &lux-j1024env32-80m-decay-lrkl-a100-algo
    <<: *lux-j1024env16-80m-decay-lrkl-a100-algo
    batch_size: 2048

LuxAI_S2-v0-j1024env16-80m-sacus: &lux-j1024env16-80m-sacus
  <<: *lux-j1024env16-80m-decay-lrkl
  policy_hyperparams: &lux-j1024env16-80m-sacus-policy
    <<: *lux-j1024env16-80m-lr20-r32-rr4-policy
    actor_head_style: sacus

LuxAI_S2-v0-j1024env16-80m-sacus-avg-max-pool:
  &lux-j1024env16-80m-sacus-avg-max-pool
  <<: *lux-j1024env16-80m-sacus
  device_hyperparams: &lux-j1024env16-80m-sacus-avg-max-pool-device
    <<: *lux-short-squnet-cuda-opt-device
    use_deterministic_algorithms: false
  policy_hyperparams: &lux-j1024env16-80m-sacus-avg-max-pool-policy
    <<: *lux-j1024env16-80m-sacus-policy
    critic_avg_max_pool: true

LuxAI_S2-v0-j1024env16-80m-vf-weights: &lux-j1024env16-80m-vf-weights
  <<: *lux-j1024env16-80m-sacus-avg-max-pool
  algo_hyperparams: &lux-j1024env16-80m-vf-weights-algo
    <<: *lux-j1024env16-80m-lr-by-kl-huber-algo
    vf_coef: 0.2
    vf_weights:
      - 1 # WinLoss
      - 0.2 # ice
      - 0.2 # ore
      - 0.2 # water
      - 0.2 # metal
      - 0.2 # power
      - 0.2 # light bots
      - 0.2 # heavy bots
      - 0.2 # opponent kills
      - 0.2 # resources lichen
      - 0.2 # resources factory
      - 0.2 # game length
      - 0.2 # opponent resources lichen
      - 0.2 # opponent resources factory

LuxAI_S2-v0-j1024env16-80m-squnet-vf-weights:
  &lux-j1024env16-80m-squnet-vf-weights
  <<: *lux-j1024env16-80m-vf-weights
  policy_hyperparams: &lux-j1024env16-80m-squnet-vf-weights-policy
    <<: *lux-j1024env16-80m-lr20-r32-rr4-policy

LuxAI_S2-v0-j1024env32-80m-vf-weights-a100: &lux-j1024env32-80m-vf-weights-a100
  <<: *lux-j1024env16-80m-vf-weights
  env_hyperparams: &lux-j1024env32-80m-vf-weights-a100-env
    <<: *lux-j1024env32-80m-decay-lrkl-a100-env
  eval_hyperparams: &lux-j1024env32-80m-vf-weights-a100-eval
    <<: *lux-j1024env32-80m-decay-lrkl-a100-eval
  algo_hyperparams: &lux-j1024env32-80m-vf-weights-a100-algo
    <<: *lux-j1024env16-80m-vf-weights-algo
    batch_size: 2048

LuxAI_S2-v0-j1024env16-80m-vfc003: &lux-j1024env16-80m-vfc003
  <<: *lux-j1024env16-80m-vf-weights
  algo_hyperparams: &lux-j1024env16-80m-vfc003-algo
    <<: *lux-j1024env16-80m-vf-weights-algo
    vf_coef: 0.03
    vf_weights:
      - 1 # WinLoss
      - 0.5 # ice
      - 0.5 # ore
      - 0.5 # water
      - 0.5 # metal
      - 0.5 # power
      - 0.5 # light bots
      - 0.5 # heavy bots
      - 0.5 # opponent kills
      - 0.5 # resources lichen
      - 0.5 # resources factory
      - 0.5 # game length
      - 0.5 # opponent resources lichen
      - 0.5 # opponent resources factory

LuxAI_S2-v0-j1024env16-80m-vfw01: &lux-j1024env16-80m-vfw01
  <<: *lux-j1024env16-80m-vf-weights
  algo_hyperparams: &lux-j1024env16-80m-vfw01-algo
    <<: *lux-j1024env16-80m-vf-weights-algo
    vf_coef: 0.1
    vf_weights:
      - 1 # WinLoss
      - 0.1 # ice
      - 0.1 # ore
      - 0.1 # water
      - 0.1 # metal
      - 0.1 # power
      - 0.1 # light bots
      - 0.1 # heavy bots
      - 0.1 # opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0.1 # game length
      - 0.1 # opponent resources lichen
      - 0.1 # opponent resources factory

LuxAI_S2-v0-j1024env32-80m-vfw01-a100: &lux-j1024env32-80m-vfw01-a100
  <<: *lux-j1024env32-80m-vf-weights-a100
  algo_hyperparams: &lux-j1024env32-80m-vfw01-a100-algo
    <<: *lux-j1024env32-80m-vf-weights-a100-algo
    vf_coef: 0.1
    vf_weights:
      - 1 # WinLoss
      - 0.1 # ice
      - 0.1 # ore
      - 0.1 # water
      - 0.1 # metal
      - 0.1 # power
      - 0.1 # light bots
      - 0.1 # heavy bots
      - 0.1 # opponent kills
      - 0.1 # resources lichen
      - 0.1 # resources factory
      - 0.1 # game length
      - 0.1 # opponent resources lichen
      - 0.1 # opponent resources factory

LuxAI_S2-v0-j1024env16-80m-vfc003-vlthresh: &lux-j1024env16-80m-vfc003-vlthresh
  <<: *lux-j1024env16-80m-vfc003
  lr_by_kl_kwargs: &lux-j1024env16-80m-vfc003-vlthresh-lr-by-kl-kwargs
    <<: *lux-j1024env16-80m-lr-by-kl-huber-clipvf05-lr-by-kl-kwargs
    v_loss_threshold: 1.2

LuxAI_S2-v0-j1024env32-80m-vfc003-vlthresh-a100:
  &lux-j1024env32-80m-vfc003-vlthresh-a100
  <<: *lux-j1024env32-80m-vf-weights-a100
  lr_by_kl_kwargs: &lux-j1024env32-80m-vfc003-vlthresh-a100-lr-by-kl-kwargs
    <<: *lux-j1024env16-80m-vfc003-vlthresh-lr-by-kl-kwargs
  algo_hyperparams: &lux-j1024env32-80m-vfc003-vlthresh-a100-algo
    <<: *lux-j1024env32-80m-vf-weights-a100-algo
    vf_coef: 0.03
    vf_weights:
      - 1 # WinLoss
      - 0.5 # ice
      - 0.5 # ore
      - 0.5 # water
      - 0.5 # metal
      - 0.5 # power
      - 0.5 # light bots
      - 0.5 # heavy bots
      - 0.5 # opponent kills
      - 0.5 # resources lichen
      - 0.5 # resources factory
      - 0.5 # game length
      - 0.5 # opponent resources lichen
      - 0.5 # opponent resources factory

LuxAI_S2-v0-j1024env32-80m-vfw01-vlthresh-a100:
  &lux-j1024env32-80m-vfw01-vlthresh-a100
  <<: *lux-j1024env32-80m-vfc003-vlthresh-a100
  algo_hyperparams: &lux-j1024env32-80m-vfw01-vlthresh-a100-algo
    <<: *lux-j1024env32-80m-vfw01-a100-algo

LuxAI_S2-v0-j1024env16-80m-vfc006-vlthresh: &lux-j1024env16-80m-vfc006-vlthresh
  <<: *lux-j1024env16-80m-vfc003-vlthresh
  algo_hyperparams: &lux-j1024env16-80m-vfc006-vlthresh-algo
    <<: *lux-j1024env16-80m-vfc003-algo
    vf_coef: 0.06
  lr_by_kl_kwargs: &lux-j1024env16-80m-vfc006-vlthresh-lr-by-kl-kwargs
    <<: *lux-j1024env16-80m-vfc003-vlthresh-lr-by-kl-kwargs
    moving_window_size: 3
    min_decrease_fraction: 0.9
    max_increase_fraction: 1.05
    v_loss_threshold: 1.5
    v_loss_fast_moving_window_size: 5
    v_loss_slow_moving_window_size: 25

LuxAI_S2-v0-j1024env16-80m-vfc012-vlthresh: &lux-j1024env16-80m-vfc012-vlthresh
  <<: *lux-j1024env16-80m-vfc006-vlthresh
  algo_hyperparams: &lux-j1024env16-80m-vfc012-vlthresh-algo
    <<: *lux-j1024env16-80m-vfc006-vlthresh-algo
    vf_coef: 0.12

LuxAI_S2-v0-j1024env16-80m-vfc024-vlthresh: &lux-j1024env16-80m-vfc024-vlthresh
  <<: *lux-j1024env16-80m-vfc012-vlthresh
  algo_hyperparams: &lux-j1024env16-80m-vfc024-vlthresh-algo
    <<: *lux-j1024env16-80m-vfc012-vlthresh-algo
    vf_coef: 0.24

LuxAI_S2-v0-j1024env16-80m-vfc012-squnet: &lux-j1024env16-80m-vfc012-squnet
  <<: *lux-j1024env16-80m-vfc012-vlthresh
  policy_hyperparams: &lux-j1024env16-80m-vfc012-squnet-policy
    <<: *lux-j1024env16-80m-squnet-vf-weights-policy

LuxAI_S2-v0-j1024env16-80m-vfc024-squnet: &lux-j1024env16-80m-vfc024-squnet
  <<: *lux-j1024env16-80m-vfc012-squnet
  algo_hyperparams: &lux-j1024env16-80m-vfc024-squnet-algo
    <<: *lux-j1024env16-80m-vfc024-vlthresh-algo

LuxAI_S2-v0-j1024env32-80m-vfc012-a100: &lux-j1024env32-80m-vfc012-a100
  <<: *lux-j1024env32-80m-vfc003-vlthresh-a100
  algo_hyperparams: &lux-j1024env32-80m-vfc012-a100-algo
    <<: *lux-j1024env32-80m-vfc003-vlthresh-a100-algo
    vf_coef: 0.12
  lr_by_kl_kwargs: &lux-j1024env32-80m-vfc012-a100-lr-by-kl-kwargs
    <<: *lux-j1024env16-80m-vfc006-vlthresh-lr-by-kl-kwargs

LuxAI_S2-v0-j1024env32-80m-vfc024-a100: &lux-j1024env32-80m-vfc024-a100
  <<: *lux-j1024env32-80m-vfc012-a100
  algo_hyperparams: &lux-j1024env32-80m-vfc024-a100-algo
    <<: *lux-j1024env32-80m-vfc012-a100-algo
    vf_coef: 0.24

LuxAI_S2-v0-j1024env32-80m-vfc024-squnet-a100:
  &lux-j1024env32-80m-vfc024-squnet-a100
  <<: *lux-j1024env32-80m-vfc024-a100
  policy_hyperparams: &lux-j1024env32-80m-vfc024-squnet-a100-policy
    <<: *lux-j1024env16-80m-vfc012-squnet-policy

LuxAI_S2-v0-j1024env32-80m-vfc024-squnet-slow-a100:
  &lux-j1024env32-80m-vfc024-squnet-slow-a100
  <<: *lux-j1024env32-80m-vfc024-squnet-a100
  algo_hyperparams: &lux-j1024env32-80m-vfc024-squnet-slow-a100-algo
    <<: *lux-j1024env32-80m-vfc024-a100-algo
    learning_rate: !!float 1e-4
  lr_by_kl_kwargs: &lux-j1024env32-80m-vfc024-squnet-slow-a100-lr-by-kl-kwargs
    <<: *lux-j1024env32-80m-vfc012-a100-lr-by-kl-kwargs
    max_increase_fraction: 1.02
    moving_window_size: 5
  hyperparam_transitions_kwargs:
    &lux-j1024env32-80m-vfc024-squnet-slow-a100-hyperparam-transitions
    <<: *lux-j1024env16-80m-decay-lrkl-hyperparam-transitions
    phases:
      - ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
        target_kl: 0.01
      - ent_coef: 0.005
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
        target_kl: 0.01
      - ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
        target_kl: 0.001
    durations:
      - 0.0125 # reset 32 envs every rollout, 1M steps
      - 0
      - 0.7875 # reset 4 envs every rollout, 63M steps
      - 0.2 # ent_coef 0.005 -> 0.001, target_kl 0.01 -> 0.001, 16M steps
      - 0

LuxAI_S2-v0-j1024env32-80m-vfc012-squnet-slow-a100:
  &lux-j1024env32-80m-vfc012-squnet-slow-a100
  <<: *lux-j1024env32-80m-vfc024-squnet-slow-a100
  algo_hyperparams: &lux-j1024env32-80m-vfc012-squnet-slow-a100-algo
    <<: *lux-j1024env32-80m-vfc024-squnet-slow-a100-algo
    vf_coef: 0.12

LuxAI_S2-v0-j1024env32-80m-vfc048-squnet-slow-a100:
  &lux-j1024env32-80m-vfc048-squnet-slow-a100
  <<: *lux-j1024env32-80m-vfc012-squnet-slow-a100
  algo_hyperparams: &lux-j1024env32-80m-vfc048-squnet-slow-a100-algo
    <<: *lux-j1024env32-80m-vfc024-squnet-slow-a100-algo
    vf_coef: 0.48

LuxAI_S2-v0-j1024env32-80m-vfc006-squnet-slow-a100:
  &lux-j1024env32-80m-vfc006-squnet-slow-a100
  <<: *lux-j1024env32-80m-vfc024-squnet-slow-a100
  algo_hyperparams: &lux-j1024env32-80m-vfc006-squnet-slow-a100-algo
    <<: *lux-j1024env32-80m-vfc024-squnet-slow-a100-algo
    vf_coef: 0.06

LuxAI_S2-v0-j1024env32-80m-vfc003-squnet-slow-a100:
  &lux-j1024env32-80m-vfc003-squnet-slow-a100
  <<: *lux-j1024env32-80m-vfc006-squnet-slow-a100
  algo_hyperparams: &lux-j1024env32-80m-vfc003-squnet-slow-a100-algo
    <<: *lux-j1024env32-80m-vfc006-squnet-slow-a100-algo
    vf_coef: 0.03

LuxAI_S2-v0-j1024env16-80m-vfc024-squnet-slow:
  &lux-j1024env16-80m-vfc024-squnet-slow
  <<: *lux-j1024env16-80m-vfc024-squnet
  algo_hyperparams: &lux-j1024env16-80m-vfc024-squnet-slow-algo
    <<: *lux-j1024env16-80m-vfc024-squnet-algo
    learning_rate: !!float 2e-4
    vf_coef: 0.24
  lr_by_kl_kwargs: &lux-j1024env16-80m-vfc024-squnet-slow-lr-by-kl-kwargs
    <<: *lux-j1024env16-80m-vfc006-vlthresh-lr-by-kl-kwargs
    max_increase_fraction: 1.02
    moving_window_size: 5
  hyperparam_transitions_kwargs:
    &lux-j1024env16-80m-vfc024-squnet-slow-hyperparam-transitions
    <<: *lux-j1024env16-80m-decay-lrkl-hyperparam-transitions
    phases:
      - ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
        target_kl: 0.01
      - ent_coef: 0.005
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
        target_kl: 0.01
      - ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
        target_kl: 0.001
    durations:
      - 0.0125 # reset 32 envs every rollout, 1M steps
      - 0
      - 0.7875 # reset 4 envs every rollout, 63M steps
      - 0.2 # ent_coef 0.005 -> 0.001, target_kl 0.01 -> 0.001, 16M steps
      - 0

LuxAI_S2-v0-j1024env16-80m-vfc012-squnet-slow:
  &lux-j1024env16-80m-vfc012-squnet-slow
  <<: *lux-j1024env16-80m-vfc024-squnet-slow
  algo_hyperparams: &lux-j1024env16-80m-vfc012-squnet-slow-algo
    <<: *lux-j1024env16-80m-vfc024-squnet-slow-algo
    vf_coef: 0.12

LuxAI_S2-v0-j1024env16-80m-vfc048-squnet-slow:
  &lux-j1024env16-80m-vfc048-squnet-slow
  <<: *lux-j1024env16-80m-vfc024-squnet-slow
  algo_hyperparams: &lux-j1024env16-80m-vfc048-squnet-slow-algo
    <<: *lux-j1024env16-80m-vfc024-squnet-slow-algo
    vf_coef: 0.48

LuxAI_S2-v0-j1024env16-80m-vfc024-squnet-grad-norm-stop:
  &lux-j1024env16-80m-vfc024-squnet-grad-norm-stop
  <<: *lux-j1024env16-80m-vfc024-squnet-slow
  lr_by_kl_kwargs:
    &lux-j1024env16-80m-vfc024-squnet-grad-norm-stop-lr-by-kl-kwargs
    <<: *lux-j1024env16-80m-vfc024-squnet-slow-lr-by-kl-kwargs
    no_increase_on_max_grad_norm: true
    v_loss_threshold: null

LuxAI_S2-v0-j1024env32-80m-vfc006-squnet-grad-norm-stop-a100:
  &lux-j1024env32-80m-vfc006-squnet-grad-norm-stop-a100
  <<: *lux-j1024env32-80m-vfc006-squnet-slow-a100
  lr_by_kl_kwargs:
    &lux-j1024env32-80m-vfc006-squnet-grad-norm-stop-a100-lr-by-kl-kwargs
    <<: *lux-j1024env32-80m-vfc024-squnet-slow-a100-lr-by-kl-kwargs
    no_increase_on_max_grad_norm: true
    v_loss_threshold: null
  algo_hyperparams: &lux-j1024env32-80m-vfc006-squnet-grad-norm-stop-a100-algo
    <<: *lux-j1024env32-80m-vfc006-squnet-slow-a100-algo
    max_grad_norm: 1.0

LuxAI_S2-v0-j1024env16-80m-vfc012-squnet-grad-norm-stop:
  &lux-j1024env16-80m-vfc012-squnet-grad-norm-stop
  <<: *lux-j1024env16-80m-vfc024-squnet-grad-norm-stop
  algo_hyperparams: &lux-j1024env16-80m-vfc012-squnet-grad-norm-stop-algo
    <<: *lux-j1024env16-80m-vfc024-squnet-slow-algo
    vf_coef: 0.12

LuxAI_S2-v0-j1024env16-80m-vfc048-squnet-grad-norm-stop:
  &lux-j1024env16-80m-vfc048-squnet-grad-norm-stop
  <<: *lux-j1024env16-80m-vfc012-squnet-grad-norm-stop
  algo_hyperparams: &lux-j1024env16-80m-vfc048-squnet-grad-norm-stop-algo
    <<: *lux-j1024env16-80m-vfc012-squnet-grad-norm-stop-algo
    vf_coef: 0.48

LuxAI_S2-v0-j1024env32-80m-vfc003-squnet-grad-norm-stop-a100:
  &lux-j1024env32-80m-vfc003-squnet-grad-norm-stop-a100
  <<: *lux-j1024env32-80m-vfc006-squnet-grad-norm-stop-a100
  algo_hyperparams: &lux-j1024env32-80m-vfc003-squnet-grad-norm-stop-a100-algo
    <<: *lux-j1024env32-80m-vfc006-squnet-grad-norm-stop-a100-algo
    vf_coef: 0.03

LuxAI_S2-v0-j1024env16-80m-vfc012-clip-reward-1:
  &lux-j1024env16-80m-vfc012-clip-reward-1
  <<: *lux-j1024env16-80m-vfc012-squnet-grad-norm-stop
  env_hyperparams: &lux-j1024env16-clip-reward-1-env
    <<: *lux-j1024env16-env
    normalize_kwargs: &lux-j1024env16-clip-reward-1-normalize-kwargs
      <<: *lux-j1024env16-emv-env-normalize-kwargs
      clip_reward: 1
  lr_by_kl_kwargs: &lux-j1024env16-80m-vfc012-clip-reward-1-lr-by-kl-kwargs
    <<: *lux-j1024env16-80m-vfc024-squnet-grad-norm-stop-lr-by-kl-kwargs
    no_increase_on_max_grad_norm: true

LuxAI_S2-v0-j1024env16-80m-vfc024-clip-reward-1:
  &lux-j1024env16-80m-vfc024-clip-reward-1
  <<: *lux-j1024env16-80m-vfc012-clip-reward-1
  algo_hyperparams: &lux-j1024env16-80m-vfc024-clip-reward-1-algo
    <<: *lux-j1024env16-80m-vfc012-squnet-grad-norm-stop-algo
    vf_coef: 0.24

LuxAI_S2-v0-j1024env16-80m-vfc024-batch-norm:
  &lux-j1024env16-80m-vfc024-batch-norm
  <<: *lux-j1024env16-80m-vfc024-clip-reward-1
  policy_hyperparams: &lux-j1024env16-80m-vfc024-batch-norm-policy
    <<: *lux-j1024env16-80m-vfc012-squnet-policy
    normalization: batch

LuxAI_S2-v0-j1024env32-80m-vfc003-batch-norm-a100:
  &lux-j1024env32-80m-vfc003-batch-norm-a100
  <<: *lux-j1024env32-80m-vfc003-squnet-grad-norm-stop-a100
  policy_hyperparams: &lux-j1024env32-80m-vfc003-batch-norm-a100-policy
    <<: *lux-j1024env32-80m-vfc024-squnet-a100-policy
    normalization: batch

LuxAI_S2-v0-j1024env32-80m-vfc006-batch-norm-a100:
  &lux-j1024env32-80m-vfc006-batch-norm-a100
  <<: *lux-j1024env32-80m-vfc003-batch-norm-a100
  algo_hyperparams: &lux-j1024env32-80m-vfc006-batch-norm-a100-algo
    <<: *lux-j1024env32-80m-vfc003-squnet-grad-norm-stop-a100-algo
    vf_coef: 0.06

LuxAI_S2-v0-j1024env16-80m-vfc024-bn-max-gn-2:
  &lux-j1024env16-80m-vfc024-bn-max-gn-2
  <<: *lux-j1024env16-80m-vfc024-batch-norm
  algo_hyperparams: &lux-j1024env16-80m-vfc024-bn-max-gn-2-algo
    <<: *lux-j1024env16-80m-vfc024-clip-reward-1-algo
    max_grad_norm: 2.0
  lr_by_kl_kwargs: &lux-j1024env16-80m-vfc024-bn-max-gn-2-lr-by-kl-kwargs
    <<: *lux-j1024env16-80m-vfc012-clip-reward-1-lr-by-kl-kwargs
    no_increase_on_max_grad_norm: true
  hyperparam_transitions_kwargs:
    &lux-j1024env16-80m-vfc024-bn-max-gn-2-hyperparam-transitions
    <<: *lux-j1024env16-80m-vfc024-squnet-slow-hyperparam-transitions
    phases:
      - ent_coef: 0.01
        rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
        target_kl: 0.01
      - ent_coef: 0.005
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
        target_kl: 0.01
    durations:
      - 0.0125 # reset 32 envs every rollout, 1M steps
      - 0
      - 0.9875 # reset 4 envs every rollout, 79M steps

LuxAI_S2-v0-j1024env16-80m-vfc024-bn-max-gn-4:
  &lux-j1024env16-80m-vfc024-bn-max-gn-4
  <<: *lux-j1024env16-80m-vfc024-bn-max-gn-2
  algo_hyperparams: &lux-j1024env16-80m-vfc024-bn-max-gn-4-algo
    <<: *lux-j1024env16-80m-vfc024-bn-max-gn-2-algo
    max_grad_norm: 4.0
  lr_by_kl_kwargs: &lux-j1024env16-80m-vfc024-bn-max-gn-4-lr-by-kl-kwargs
    <<: *lux-j1024env16-80m-vfc024-bn-max-gn-2-lr-by-kl-kwargs
    no_increase_on_max_grad_norm: true

LuxAI_S2-v0-j1024env16-80m-vfc024-bn-max-gn-8:
  &lux-j1024env16-80m-vfc024-bn-max-gn-8
  <<: *lux-j1024env16-80m-vfc024-bn-max-gn-2
  algo_hyperparams: &lux-j1024env16-80m-vfc024-bn-max-gn-8-algo
    <<: *lux-j1024env16-80m-vfc024-bn-max-gn-2-algo
    max_grad_norm: 8.0
  lr_by_kl_kwargs: &lux-j1024env16-80m-vfc024-bn-max-gn-8-lr-by-kl-kwargs
    <<: *lux-j1024env16-80m-vfc024-bn-max-gn-2-lr-by-kl-kwargs
    no_increase_on_max_grad_norm: true

LuxAI_S2-v0-j1024env32-80m-vfc006-batch-norm-max-gn-4-a100:
  &lux-j1024env32-80m-vfc006-batch-norm-max-gn-4-a100
  <<: *lux-j1024env32-80m-vfc006-batch-norm-a100
  algo_hyperparams: &lux-j1024env32-80m-vfc006-batch-norm-max-gn-4-a100-algo
    <<: *lux-j1024env32-80m-vfc006-batch-norm-a100-algo
    max_grad_norm: 4.0
  lr_by_kl_kwargs:
    &lux-j1024env32-80m-vfc006-batch-norm-max-gn-4-a100-lr-by-kl-kwargs
    <<: *lux-j1024env32-80m-vfc006-squnet-grad-norm-stop-a100-lr-by-kl-kwargs
    no_increase_on_max_grad_norm: true
  hyperparam_transitions_kwargs:
    &lux-j1024env32-80m-vfc006-batch-norm-max-gn-4-a100-hyperparam-transitions
    <<: *lux-j1024env16-80m-vfc024-bn-max-gn-2-hyperparam-transitions

LuxAI_S2-v0-j1024env16-80m-vfc024-ln-max-gn-2:
  &lux-j1024env16-80m-vfc024-ln-max-gn-2
  <<: *lux-j1024env16-80m-vfc024-bn-max-gn-2
  policy_hyperparams: &lux-j1024env16-80m-vfc024-ln-max-gn-2-policy
    <<: *lux-j1024env16-80m-vfc024-batch-norm-policy
    normalization: layer
  algo_hyperparams: &lux-j1024env16-80m-vfc024-ln-max-gn-2-algo
    <<: *lux-j1024env16-80m-vfc024-bn-max-gn-2-algo
    batch_size: 2048

LuxAI_S2-v0-j1024env16-80m-vfc024-ln-max-gn-4:
  &lux-j1024env16-80m-vfc024-ln-max-gn-4
  <<: *lux-j1024env16-80m-vfc024-ln-max-gn-2
  algo_hyperparams: &lux-j1024env16-80m-vfc024-ln-max-gn-4-algo
    <<: *lux-j1024env16-80m-vfc024-ln-max-gn-2-algo
    max_grad_norm: 4.0

LuxAI_S2-v0-j1024env16-80m-vfc012-ln-max-gn-2:
  &lux-j1024env16-80m-vfc012-ln-max-gn-2
  <<: *lux-j1024env16-80m-vfc024-ln-max-gn-2
  algo_hyperparams: &lux-j1024env16-80m-vfc012-ln-max-gn-2-algo
    <<: *lux-j1024env16-80m-vfc024-ln-max-gn-2-algo
    vf_coef: 0.12

LuxAI_S2-v0-j1024env32-80m-vfc006-ln-max-gn-2-a100:
  &lux-j1024env32-80m-vfc006-ln-max-gn-2-a100
  <<: *lux-j1024env32-80m-vfc006-batch-norm-max-gn-4-a100
  policy_hyperparams: &lux-j1024env32-80m-vfc006-ln-max-gn-2-a100-policy
    <<: *lux-j1024env32-80m-vfc003-batch-norm-a100-policy
    normalization: layer
  algo_hyperparams: &lux-j1024env32-80m-vfc006-ln-max-gn-2-a100-algo
    <<: *lux-j1024env32-80m-vfc006-batch-norm-max-gn-4-a100-algo
    max_grad_norm: 2.0
    batch_size: 1024

LuxAI_S2-v0-j1024env32-80m-vfc003-ln-max-gn-2-a100:
  &lux-j1024env32-80m-vfc003-ln-max-gn-2-a100
  <<: *lux-j1024env32-80m-vfc006-ln-max-gn-2-a100
  algo_hyperparams: &lux-j1024env32-80m-vfc003-ln-max-gn-2-a100-algo
    <<: *lux-j1024env32-80m-vfc006-ln-max-gn-2-a100-algo
    vf_coef: 0.03

LuxAI_S2-v0-j1024env32-80m-vfc003-ln-max-gn-1-a100:
  &lux-j1024env32-80m-vfc003-ln-max-gn-1-a100
  <<: *lux-j1024env32-80m-vfc003-ln-max-gn-2-a100
  algo_hyperparams: &lux-j1024env32-80m-vfc003-ln-max-gn-1-a100-algo
    <<: *lux-j1024env32-80m-vfc003-ln-max-gn-2-a100-algo
    max_grad_norm: 1.0
  lr_by_kl_kwargs: &lux-j1024env32-80m-vfc003-ln-max-gn-1-a100-lr-by-kl-kwargs
    <<: *lux-j1024env32-80m-vfc006-batch-norm-max-gn-4-a100-lr-by-kl-kwargs
    min_lr: !!float 5e-5
    max_lr: !!float 1e-2

LuxAI_S2-v0-j1024env16-80m-vfc024-ln-max-gn-1:
  &lux-j1024env16-80m-vfc024-ln-max-gn-1
  <<: *lux-j1024env16-80m-vfc024-ln-max-gn-2
  algo_hyperparams: &lux-j1024env16-80m-vfc024-ln-max-gn-1-algo
    <<: *lux-j1024env16-80m-vfc024-ln-max-gn-2-algo
    max_grad_norm: 1.0

LuxAI_S2-v0-j1024env32-80m-vfc006-ln-max-gn-4-a100:
  &lux-j1024env32-80m-vfc006-ln-max-gn-4-a100
  <<: *lux-j1024env32-80m-vfc006-ln-max-gn-2-a100
  algo_hyperparams: &lux-j1024env32-80m-vfc006-ln-max-gn-4-a100-algo
    <<: *lux-j1024env32-80m-vfc006-ln-max-gn-2-a100-algo
    max_grad_norm: 4.0

LuxAI_S2-v0-j1024env16-80m-vfc024-ln-max-gn-05:
  &lux-j1024env16-80m-vfc024-ln-max-gn-05
  <<: *lux-j1024env16-80m-vfc024-ln-max-gn-1
  algo_hyperparams: &lux-j1024env16-80m-vfc024-ln-max-gn-05-algo
    <<: *lux-j1024env16-80m-vfc024-ln-max-gn-1-algo
    max_grad_norm: 0.5

LuxAI_S2-v0-j1024env16-80m-vfc024-ln-mgn-2-base-rewards:
  &lux-j1024env16-80m-vfc024-ln-mgn-2-base-rewards
  <<: *lux-j1024env16-80m-vfc024-ln-max-gn-2
  algo_hyperparams: &lux-j1024env16-80m-vfc024-ln-mgn-2-base-rewards-algo
    <<: *lux-j1024env16-80m-vfc024-ln-max-gn-2-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # ice
      - 0.1 # ore
      - 0.1 # water
      - 0.1 # metal
      - 0 # power
      - 0.1 # light bots
      - 0.1 # heavy bots
      - 0.1 # opponent kills
      - 0 # resources lichen
      - 0.1 # resources factory
      - 0 # game length
      - 0 # opponent resources lichen
      - 0 # opponent resources factory
  lr_by_kl_kwargs:
    &lux-j1024env16-80m-vfc024-ln-mgn-2-base-rewards-lr-by-kl-kwargs
    <<: *lux-j1024env16-80m-vfc024-bn-max-gn-8-lr-by-kl-kwargs
    min_lr: !!float 5e-5
    max_lr: !!float 1e-2

LuxAI_S2-v0-j1024env16-80m-vfc012-ln-mgn-2-base-rewards:
  &lux-j1024env16-80m-vfc012-ln-mgn-2-base-rewards
  <<: *lux-j1024env16-80m-vfc024-ln-mgn-2-base-rewards
  algo_hyperparams: &lux-j1024env16-80m-vfc012-ln-mgn-2-base-rewards-algo
    <<: *lux-j1024env16-80m-vfc024-ln-mgn-2-base-rewards-algo
    vf_coef: 0.12

LuxAI_S2-v0-j1024env32-80m-vfc006-mgn4-fine-tune-a100:
  &lux-j1024env32-80m-vfc006-mgn4-fine-tune-a100
  <<: *lux-j1024env32-80m-vfc006-ln-max-gn-4-a100
  policy_hyperparams: &lux-j1024env32-80m-vfc006-mgn4-fine-tune-a100-policy
    <<: *lux-j1024env32-80m-vfc006-ln-max-gn-2-a100-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/2t5tcjes
    load_run_path_best: true
  lr_by_kl_kwargs:
    &lux-j1024env32-80m-vfc006-mgn4-fine-tune-a100-lr-by-kl-kwargs
    <<: *lux-j1024env32-80m-vfc006-batch-norm-max-gn-4-a100-lr-by-kl-kwargs
    min_lr: !!float 5e-5
    max_lr: !!float 1e-2

LuxAI_S2-v0-j1024env32-80m-vfc006-mgn4-base-rewards-a100:
  &lux-j1024env32-80m-vfc006-mgn4-base-rewards-a100
  <<: *lux-j1024env32-80m-vfc006-ln-max-gn-4-a100
  algo_hyperparams: &lux-j1024env32-80m-vfc006-mgn4-base-rewards-a100-algo
    <<: *lux-j1024env32-80m-vfc006-ln-max-gn-4-a100-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # ice
      - 0.1 # ore
      - 0.1 # water
      - 0.1 # metal
      - 0 # power
      - 0.1 # light bots
      - 0.1 # heavy bots
      - 0.1 # opponent kills
      - 0 # resources lichen
      - 0.1 # resources factory
      - 0 # game length
      - 0 # opponent resources lichen
      - 0 # opponent resources factory
  lr_by_kl_kwargs:
    &lux-j1024env32-80m-vfc006-mgn4-base-rewards-a100-lr-by-kl-kwargs
    <<: *lux-j1024env32-80m-vfc006-batch-norm-max-gn-4-a100-lr-by-kl-kwargs
    min_lr: !!float 5e-5
    max_lr: !!float 1e-2

LuxAI_S2-v0-j1024env16-80m-vfc024-ln-mgn-2-baserew-finetune:
  &lux-j1024env16-80m-vfc024-ln-mgn-2-baserew-finetune
  <<: *lux-j1024env16-80m-vfc024-ln-mgn-2-base-rewards
  policy_hyperparams:
    &lux-j1024env16-80m-vfc024-ln-mgn-2-baserew-finetune-policy
    <<: *lux-j1024env16-80m-vfc024-ln-max-gn-2-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/ahjfwkjh
    load_run_path_best: true

LuxAI_S2-v0-j1024env16-80m-vfc024-ln-mgn-2-2o2m2hrew-finetune:
  &lux-j1024env16-80m-vfc024-ln-mgn-2-2o2m2hrew-finetune
  <<: *lux-j1024env16-80m-vfc024-ln-mgn-2-baserew-finetune
  algo_hyperparams: &lux-j1024env16-80m-vfc024-ln-mgn-2-2o2m2hrew-finetune-algo
    <<: *lux-j1024env16-80m-vfc024-ln-mgn-2-base-rewards-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # ice
      - 0.2 # ore
      - 0.1 # water
      - 0.2 # metal
      - 0 # power
      - 0.1 # light bots
      - 0.2 # heavy bots
      - 0.1 # opponent kills
      - 0 # resources lichen
      - 0.1 # resources factory
      - 0 # game length
      - 0 # opponent resources lichen
      - 0 # opponent resources factory

LuxAI_S2-v0-j1024env16-80m-vfc024-ln-mgn-1-base-rewards:
  &lux-j1024env16-80m-vfc024-ln-mgn-1-base-rewards
  <<: *lux-j1024env16-80m-vfc024-ln-mgn-2-base-rewards
  algo_hyperparams: &lux-j1024env16-80m-vfc024-ln-mgn-1-base-rewards-algo
    <<: *lux-j1024env16-80m-vfc024-ln-mgn-2-base-rewards-algo
    max_grad_norm: 1.0

LuxAI_S2-v0-j1024env16-80m-vfc024-ln-mgn-2-2o3m4h-finetune:
  &lux-j1024env16-80m-vfc024-ln-mgn-2-2o3m4h-finetune
  <<: *lux-j1024env16-80m-vfc024-ln-mgn-2-2o2m2hrew-finetune
  policy_hyperparams: &lux-j1024env16-80m-vfc024-ln-mgn-2-2o3m4h-finetune-policy
    <<: *lux-j1024env16-80m-vfc024-ln-mgn-2-baserew-finetune-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/c9hwzt0s
  algo_hyperparams: &lux-j1024env16-80m-vfc024-ln-mgn-2-2o3m4h-finetune-algo
    <<: *lux-j1024env16-80m-vfc024-ln-mgn-2-2o2m2hrew-finetune-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # ice
      - 0.2 # ore
      - 0.1 # water
      - 0.3 # metal
      - 0 # power
      - 0.1 # light bots
      - 0.4 # heavy bots
      - 0.1 # opponent kills
      - 0 # resources lichen
      - 0.1 # resources factory
      - 0 # game length
      - 0 # opponent resources lichen
      - 0 # opponent resources factory

LuxAI_S2-v0-j1024env32-80m-vfc006-ln-mgn4-baserew-finetune:
  &lux-j1024env32-80m-vfc006-ln-mgn4-baserew-finetune
  <<: *lux-j1024env32-80m-vfc006-mgn4-base-rewards-a100
  policy_hyperparams: &lux-j1024env32-80m-vfc006-ln-mgn4-baserew-finetune-policy
    <<: *lux-j1024env32-80m-vfc006-mgn4-fine-tune-a100-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/jwph3d0u
    load_run_path_best: true
  algo_hyperparams: &lux-j1024env32-80m-vfc006-ln-mgn4-baserew-finetune-algo
    <<: *lux-j1024env32-80m-vfc006-mgn4-base-rewards-a100-algo
    batch_size: 512

LuxAI_S2-v0-j1024env32-80m-vfc006-ln-mgn4-2o2m2h-finetune:
  &lux-j1024env32-80m-vfc006-ln-mgn4-2o2m2h-finetune
  <<: *lux-j1024env32-80m-vfc006-ln-mgn4-baserew-finetune
  policy_hyperparams: &lux-j1024env32-80m-vfc006-ln-mgn4-2o2m2h-finetune-policy
    <<: *lux-j1024env32-80m-vfc006-ln-mgn4-baserew-finetune-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/c9hwzt0s
    load_run_path_best: true
  algo_hyperparams: &lux-j1024env32-80m-vfc006-ln-mgn4-2o2m2h-finetune-algo
    <<: *lux-j1024env32-80m-vfc006-ln-mgn4-baserew-finetune-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # ice
      - 0.2 # ore
      - 0.1 # water
      - 0.2 # metal
      - 0 # power
      - 0.1 # light bots
      - 0.2 # heavy bots
      - 0.1 # opponent kills
      - 0 # resources lichen
      - 0.1 # resources factory
      - 0 # game length
      - 0 # opponent resources lichen
      - 0 # opponent resources factory

LuxAI_S2-v0-j1024env32-80m-vfc006-mgn4-finetune2-a100:
  &lux-j1024env32-80m-vfc006-mgn4-finetune2-a100
  <<: *lux-j1024env32-80m-vfc006-mgn4-fine-tune-a100
  policy_hyperparams: &lux-j1024env32-80m-vfc006-mgn4-finetune2-a100-policy
    <<: *lux-j1024env32-80m-vfc006-mgn4-fine-tune-a100-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/khqt7rtw
    load_run_path_best: true

LuxAI_S2-v0-j1024env32-80m-vfc006-mgn4-kl05-ft-a100:
  &lux-j1024env32-80m-vfc006-mgn4-kl05-ft-a100
  <<: *lux-j1024env32-80m-vfc006-mgn4-finetune2-a100
  hyperparam_transitions_kwargs:
    &lux-j1024env32-80m-vfc006-mgn4-kl05-ft-a100-hyperparam-transitions
    <<: *lux-j1024env16-80m-vfc024-bn-max-gn-2-hyperparam-transitions
    phases:
      - ent_coef: 0.005
        rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
        target_kl: 0.01
      - ent_coef: 0.005
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
        target_kl: 0.01
      - ent_coef: 0.005
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
        target_kl: 0.005
    durations:
      - 0.0125 # reset 32 envs every rollout, 1M steps
      - 0
      - 0
      - 0.9875 # reset 4 envs every rollout, kl 0.01 -> 0.005, 79M steps
      - 0

LuxAI_S2-v0-j1024env32-80m-vfc006-mgn4-kl05-ent1-ft-a100:
  &lux-j1024env32-80m-vfc006-mgn4-kl05-ent1-ft-a100
  <<: *lux-j1024env32-80m-vfc006-mgn4-kl05-ft-a100
  hyperparam_transitions_kwargs:
    &lux-j1024env32-80m-vfc006-mgn4-kl05-ent1-ft-a100-hyparam-transitions
    <<: *lux-j1024env32-80m-vfc006-mgn4-kl05-ft-a100-hyperparam-transitions
    phases:
      - ent_coef: 0.005
        rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
        target_kl: 0.01
      - ent_coef: 0.005
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
        target_kl: 0.01
      - ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
        target_kl: 0.005
    durations:
      - 0.0125 # reset 32 envs every rollout, 1M steps
      - 0
      - 0
      - 0.9875 # kl 0.01 -> 0.005, ent 0.005 -> 0.001, 79M steps
      - 0

LuxAI_S2-v0-j1024env64-80m-vfc006-ln-mgn4-2o3m4h-a100:
  &lux-j1024env64-80m-vfc006-ln-mgn4-2o3m4h-a100
  <<: *lux-j1024env32-80m-vfc006-ln-max-gn-4-a100
  env_hyperparams:
    <<: *lux-j1024env64-a100-env
  eval_hyperparams:
    <<: *lux-j1024env64-a100-eval
  algo_hyperparams: &lux-j1024env64-80m-vfc006-ln-mgn4-2o3m4h-a100-algo
    <<: *lux-j1024env32-80m-vfc006-ln-max-gn-4-a100-algo
    batch_size: 128
  lr_by_kl_kwargs:
    &lux-j1024env64-80m-vfc006-ln-mgn4-2o3m4h-a100-lr-by-kl-kwargs
    <<: *lux-j1024env32-80m-vfc006-mgn4-fine-tune-a100-lr-by-kl-kwargs
    min_lr: !!float 5e-5
    max_lr: !!float 1e-2

LuxAI_S2-v0-j1024env64-80m-vfc006-ln-mgn2-baserew-a100:
  &lux-j1024env64-80m-vfc006-ln-mgn2-baserew-a100
  <<: *lux-j1024env64-80m-vfc006-ln-mgn4-2o3m4h-a100
  algo_hyperparams: &lux-j1024env64-80m-vfc006-ln-mgn2-baserew-a100-algo
    <<: *lux-j1024env64-80m-vfc006-ln-mgn4-2o3m4h-a100-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # ice
      - 0.1 # ore
      - 0.1 # water
      - 0.1 # metal
      - 0 # power
      - 0.1 # light bots
      - 0.1 # heavy bots
      - 0.1 # opponent kills
      - 0 # resources lichen
      - 0.1 # resources factory
      - 0 # game length
      - 0 # opponent resources lichen
      - 0 # opponent resources factory

LuxAI_S2-v0-j1024env64-80m-vfc006-ln-mgn4-2o3m4h-ft-a100:
  &lux-j1024env64-80m-vfc006-ln-mgn4-2o3m4h-ft-a100
  <<: *lux-j1024env64-80m-vfc006-ln-mgn4-2o3m4h-a100
  policy_hyperparams: &lux-j1024env64-80m-vfc006-ln-mgn4-2o3m4h-ft-a100-policy
    <<: *lux-j1024env32-80m-vfc006-mgn4-finetune2-a100-policy

LuxAI_S2-v0-j1024env16-80m-vfc024-mgn2-kl05-ent1-2o2m2h-ft2:
  &lux-j1024env16-80m-vfc024-mgn2-kl05-ent1-2o2m2h-ft2
  <<: *lux-j1024env16-80m-vfc024-ln-mgn-2-2o2m2hrew-finetune
  policy_hyperparams:
    &lux-j1024env16-80m-vfc024-mgn2-kl05-ent1-2o2m2h-ft2-policy
    <<: *lux-j1024env16-80m-vfc024-ln-mgn-2-baserew-finetune-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/c9hwzt0s
    load_run_path_best: true
  hyperparam_transitions_kwargs:
    &lux-j1024env16-80m-vfc024-mgn2-kl05-ent1-2o2m2h-ft2-hyperparam-transitions
    <<: *lux-j1024env32-80m-vfc006-mgn4-kl05-ent1-ft-a100-hyparam-transitions

LuxAI_S2-v0-j1024env32-80m-vfc006-mgn1-ft2: &lux-j1024env32-80m-vfc006-mgn1-ft2
  <<: *lux-j1024env32-80m-vfc006-mgn4-finetune2-a100
  algo_hyperparams: &lux-j1024env32-80m-vfc006-mgn1-ft2-algo
    <<: *lux-j1024env32-80m-vfc006-ln-max-gn-4-a100-algo
    max_grad_norm: 1.0
    batch_size: 512

LuxAI_S2-v0-j1024env32-80m-vfc006-mgn05-ft2:
  &lux-j1024env32-80m-vfc006-mgn05-ft2
  <<: *lux-j1024env32-80m-vfc006-mgn1-ft2
  algo_hyperparams: &lux-j1024env32-80m-vfc006-mgn05-ft2-algo
    <<: *lux-j1024env32-80m-vfc006-mgn1-ft2-algo
    max_grad_norm: 0.5

LuxAI_S2-v0-j1024env32-80m-vfc006-mgn05-kl01-ent1-baserew-ft:
  &lux-j1024env32-80m-vfc006-mgn05-kl01-ent1-baserew-ft
  <<: *lux-j1024env32-80m-vfc006-mgn05-ft2
  policy_hyperparams:
    &lux-j1024env32-80m-vfc006-mgn05-kl01-ent1-baserew-ft-policy
    <<: *lux-j1024env32-80m-vfc006-mgn4-finetune2-a100-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/ulld3hur
    load_run_path_best: true
  algo_hyperparams: &lux-j1024env32-80m-vfc006-mgn05-kl01-ent1-baserew-ft-algo
    <<: *lux-j1024env32-80m-vfc006-mgn05-ft2-algo
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # ice
      - 0.1 # ore
      - 0.1 # water
      - 0.1 # metal
      - 0 # power
      - 0.1 # light bots
      - 0.1 # heavy bots
      - 0.1 # opponent kills
      - 0 # resources lichen
      - 0.1 # resources factory
      - 0 # game length
      - 0 # opponent resources lichen
      - 0 # opponent resources factory
  hyperparam_transitions_kwargs:
    &lux-j1024env32-80m-vfc006-mgn05-kl01-ent1-baserew-ft-hyperparam-transitions
    <<: *lux-j1024env16-80m-vfc024-mgn2-kl05-ent1-2o2m2h-ft2-hyperparam-transitions
    phases:
      - ent_coef: 0.005
        rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
        target_kl: 0.01
      - ent_coef: 0.005
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
        target_kl: 0.01
      - ent_coef: 0.001
        rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
        target_kl: 0.001
    durations:
      - 0.0125 # reset 32 envs every rollout, 1M steps
      - 0
      - 0
      - 0.9875 # kl 0.01 -> 0.001, ent 0.005 -> 0.001, 79M steps
      - 0

LuxAI_S2-v0-j1024env32-80m-vfc006-mgn05-kl01-ent1-m2o3h4-ft2-a100:
  &lux-j1024env32-80m-vfc006-mgn05-kl01-ent1-m2o3h4-ft2-a100
  <<: *lux-j1024env32-80m-vfc006-mgn05-kl01-ent1-baserew-ft
  policy_hyperparams:
    &lux-j1024env32-80m-vfc006-mgn05-kl01-ent1-m2o3h4-ft2-a100-policy
    <<: *lux-j1024env32-80m-vfc006-mgn05-kl01-ent1-baserew-ft-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/khqt7rtw
    load_run_path_best: true
  algo_hyperparams:
    &lux-j1024env32-80m-vfc006-mgn05-kl01-ent1-m2o3h4-ft2-a100-algo
    <<: *lux-j1024env32-80m-vfc006-mgn05-kl01-ent1-baserew-ft-algo
    batch_size: 1024
    multi_reward_weights:
      - 1 # WinLoss
      - 0.1 # ice
      - 0.2 # ore
      - 0.1 # water
      - 0.3 # metal
      - 0 # power
      - 0.1 # light bots
      - 0.4 # heavy bots
      - 0.1 # opponent kills
      - 0 # resources lichen
      - 0.1 # resources factory
      - 0 # game length
      - 0 # opponent resources lichen
      - 0 # opponent resources factory

LuxAI_S2-v0-j1024env16-80m-vfc024-brn-mgn2-2o3m4h:
  &lux-j1024env16-80m-vfc024-brn-mgn2-2o3m4h
  <<: *lux-j1024env16-80m-vfc024-ln-max-gn-2
  policy_hyperparams: &lux-j1024env16-80m-vfc024-brn-mgn2-2o3m4h-policy
    <<: *lux-j1024env16-80m-vfc024-ln-max-gn-2-policy
    normalization: batch_renorm
  algo_hyperparams: &lux-j1024env16-80m-vfc024-brn-mgn2-2o3m4h-algo
    <<: *lux-j1024env16-80m-vfc024-ln-max-gn-2-algo
    batch_size: 2048
  lr_by_kl_kwargs: &lux-j1024env16-80m-vfc024-brn-mgn2-2o3m4h-lr-by-kl-kwargs
    <<: *lux-j1024env16-80m-vfc024-ln-mgn-2-base-rewards-lr-by-kl-kwargs

LuxAI_S2-v0-j1024env32-80m-vfc006-brn-mgn4-baserew-a100:
  &lux-j1024env32-80m-vfc006-brn-mgn4-baserew-a100
  <<: *lux-j1024env32-80m-vfc006-mgn4-base-rewards-a100
  policy_hyperparams: &lux-j1024env32-80m-vfc006-brn-mgn4-baserew-a100-policy
    <<: *lux-j1024env32-80m-vfc006-ln-max-gn-2-a100-policy
    normalization: batch_renorm
  algo_hyperparams: &lux-j1024env32-80m-vfc006-brn-mgn4-baserew-a100-algo
    <<: *lux-j1024env32-80m-vfc006-mgn4-base-rewards-a100-algo
    batch_size: 1024

LuxAI_S2-v0-j1024env32-80m-vfc006-ln-mgn4-2o3m4h-ft-teacher-loss-a100:
  &lux-j1024env32-80m-vfc006-ln-mgn4-2o3m4h-ft-teacher-loss-a100
  <<: *lux-j1024env32-80m-vfc006-mgn4-finetune2-a100
  algo_hyperparams:
    &lux-j1024env32-80m-vfc006-ln-mgn4-2o3m4h-ft-teacher-loss-a100-algo
    <<: *lux-j1024env32-80m-vfc006-ln-max-gn-4-a100-algo
    ent_coef: 0.05
    teacher_kl_loss_coef: 0.001
  hyperparam_transitions_kwargs:
    &lux-j1024env32-80m-vfc006-ln-mgn4-2o3m4h-ft-teacher-loss-a100-hyperparam-transitions
    <<: *lux-j1024env32-80m-vfc006-batch-norm-max-gn-4-a100-hyperparam-transitions
    phases:
      - rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
        teacher_kl_loss_coef: 0.001
      - rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
        teacher_kl_loss_coef: 0.001
      - rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
        teacher_kl_loss_coef: 0
    durations:
      - 0.0125 # reset 32 envs every rollout, 1M steps
      - 0
      - 0
      - 0.9875 # reset 4 envs every rollout, teacher_kl_loss 1 -> 0, 79M steps
      - 0

LuxAI_S2-v0-j1024env16-80m-vfc024-ln-mgn2-2o2m2h-ft-teacher5:
  &lux-j1024env16-80m-vfc024-ln-mgn2-2o2m2h-ft-teacher5
  <<: *lux-j1024env16-80m-vfc024-ln-mgn-2-2o2m2hrew-finetune
  policy_hyperparams:
    &lux-j1024env16-80m-vfc024-ln-mgn2-2o2m2h-ft-teacher5-policy
    <<: *lux-j1024env16-80m-vfc024-ln-mgn-2-baserew-finetune-policy
    load_run_path: sgoodfriend/rl-algo-impls-lux-nips1/c9hwzt0s
    load_run_path_best: true
  algo_hyperparams: &lux-j1024env16-80m-vfc024-ln-mgn2-2o2m2h-ft-teacher5-algo
    <<: *lux-j1024env16-80m-vfc024-ln-mgn-2-2o2m2hrew-finetune-algo
    ent_coef: 0.05
    teacher_kl_loss_coef: !!float 5e-3
  lr_by_kl_kwargs:
    &lux-j1024env16-80m-vfc024-ln-mgn2-2o2m2h-ft-teacher5-lr-by-kl-kwargs
    <<: *lux-j1024env16-80m-vfc024-ln-mgn-2-base-rewards-lr-by-kl-kwargs
    min_lr: !!float 5e-5
    max_lr: !!float 1e-3
  hyperparam_transitions_kwargs:
    &lux-j1024env16-80m-vfc024-ln-mgn2-2o2m2h-ft-teacher5-hyperparam-transitions
    <<: *lux-j1024env32-80m-vfc006-ln-mgn4-2o3m4h-ft-teacher-loss-a100-hyperparam-transitions
    phases:
      - rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
        teacher_kl_loss_coef: !!float 5e-3
      - rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
        teacher_kl_loss_coef: !!float 5e-3
      - rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
        teacher_kl_loss_coef: 0
    durations:
      - 0.0125 # reset 32 envs every rollout, 1M steps
      - 0
      - 0
      - 0.9875 # reset 4 envs every rollout, teacher_kl_loss 5e-3 -> 0, 79M steps
      - 0

LuxAI_S2-v0-j1024env16-80m-vfc024-ln-mgn2-2o2m2h-ft-teacher05:
  &lux-j1024env16-80m-vfc024-ln-mgn2-2o2m2h-ft-teacher05
  <<: *lux-j1024env16-80m-vfc024-ln-mgn2-2o2m2h-ft-teacher5
  algo_hyperparams: &lux-j1024env16-80m-vfc024-ln-mgn2-2o2m2h-ft-teacher05-algo
    <<: *lux-j1024env16-80m-vfc024-ln-mgn2-2o2m2h-ft-teacher5-algo
    teacher_kl_loss_coef: !!float 5e-4
  hyperparam_transitions_kwargs:
    &lux-j1024env16-80m-vfc024-ln-mgn2-2o2m2h-ft-teacher05-hyperparam-transitions
    <<: *lux-j1024env16-80m-vfc024-ln-mgn2-2o2m2h-ft-teacher5-hyperparam-transitions
    phases:
      - rolling_num_envs_reset_every_rollout: 32
        random_num_envs_reset_every_rollout: 0
        teacher_kl_loss_coef: !!float 5e-4
      - rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
        teacher_kl_loss_coef: !!float 5e-4
      - rolling_num_envs_reset_every_rollout: 0
        random_num_envs_reset_every_rollout: 4
        teacher_kl_loss_coef: 0
    durations:
      - 0.0125 # reset 32 envs every rollout, 1M steps
      - 0
      - 0
      - 0.9875 # reset 4 envs every rollout, teacher_kl_loss 5e-4 -> 0, 79M steps
      - 0

LuxAI_S2-agent: &lux-agent
  <<: *lux-j1024env64-80m-vfc006-ln-mgn4-2o3m4h-ft-a100
  device: cpu
  policy_hyperparams:
    <<: *lux-j1024env64-80m-vfc006-ln-mgn4-2o3m4h-ft-a100-policy
    load_run_path: null
    load_path: lux_models/ppo-LuxAI_S2-v0-j1024env32-80m-vfc006-mgn4-fine-tune-a100-S1-best
  eval_hyperparams:
    <<: *lux-j1024env64-a100-eval
    env_overrides:
      <<: *lux-j1024env64-a100-eval-env-overrides
      n_envs: 1
      vec_env_class: agent
      play_checkpoints_kwargs: null

LuxAI_S2-v0-debug:
  <<: *lux-j1024env16-80m-vfc024-ln-mgn2-2o2m2h-ft-teacher05
  n_timesteps: !!float 10e6
  device: mps
  env_hyperparams:
    <<: *lux-j1024env16-clip-reward-1-env
    # <<: *lux-j1024env32-opp-resources-env
    # <<: *lux-j1024env64-a100-env
    # <<: *lux-j512env64-opp-resources-env
    n_envs: 64
    play_checkpoints_kwargs:
      n_envs_against_checkpoints: 8
    make_kwargs:
      <<: *lux-j1024env16-power-diggers-env-make-kwargs
      # <<: *lux-j1024env32-opp-resources-env-make-kwargs
      # <<: *lux-j1024env64-a100-env-make-kwargs
      # <<: *lux-j512env64-opp-resources-env-make-kwargs
      verbose: 3
      verify: true
    # vec_env_class: sync
  eval_hyperparams:
    <<: *lux-j1024env16-eval
    # <<: *lux-j1024env32-opp-resources-eval
    # <<: *lux-j1024env64-a100-eval
    # <<: *lux-j512env64-opp-resources-eval
    env_overrides:
      <<: *lux-j1024env16-power-diggers-eval-env-overrides
      # <<: *lux-j1024env32-80m-a100-std-norm-retrain-env-overrides
      # <<: *lux-j1024env64-a100-eval-env-overrides
      # <<: *lux-j512env64-opp-resources-eval-env-overrides
      n_envs: 8
      # vec_env_class: sync
      make_kwargs:
        <<: *lux-j1024env16-power-diggers-eval-env-overrides-make-kwargs
        # <<: *lux-j1024env32-80m-a100-std-norm-retrain-env-overrides-make-kwargs
        # <<: *lux-j1024env64-a100-eval-env-overrides-make-kwargs
        # <<: *lux-j512env64-opp-resources-eval-env-overrides-make-kwargs
        verbose: 3
        verify: true
